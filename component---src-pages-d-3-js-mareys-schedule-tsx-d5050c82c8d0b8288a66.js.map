{"version":3,"sources":["webpack://demos/./src/demos/mareys-schedule/mareys-schedule.module.css","webpack://demos/./src/demos/mareys-schedule/mareys-schedule.ts","webpack://demos/./src/pages/d3js/mareys-schedule.tsx","webpack://demos/./node_modules/lodash/_baseEach.js","webpack://demos/./node_modules/lodash/_baseFor.js","webpack://demos/./node_modules/lodash/_baseForOwn.js","webpack://demos/./node_modules/lodash/_castFunction.js","webpack://demos/./node_modules/lodash/_createBaseEach.js","webpack://demos/./node_modules/lodash/_createBaseFor.js","webpack://demos/./node_modules/lodash/each.js","webpack://demos/./node_modules/lodash/forEach.js","webpack://demos/./node_modules/lodash/identity.js","webpack://demos/./node_modules/lodash/last.js"],"names":["axis","trainTypeToStyle","B","L","N","fetchData","tsv","ROOT_PATH","data","stations","trains","map","train","trainIndex","key","test","stopFragments","split","push","distance","name","zone","direction","index","number","stops","station","time","parseTime","filter","type","getTrainTitle","trainData","last","getFormatTime","timeParse","timeStr","timeDate","formatTime","getHours","setDate","getDate","margin","height","renderChart","rootElId","rootEl","document","getElementById","classList","add","width","getBoundingClientRect","redraw","timeRange","x","scaleTime","domain","range","y","scaleLinear","xAxisTop","axisTop","ticks","tickFormat","xAxisBottom","axisBottom","svg","select","text","append","attr","style","filterBlackOpacity","extent","selectAll","enter","d","styles","call","on","_e","line","lineD3","date","hours","ampm","minutes","getMinutes","toString","formatAMPM","refresh","limits","times","each","limit","wholeMinutes","fragment","Math","floor","finalTime","refreshOnHourChange","id","deviation","slope","feMerge","slider","$","change","pageContext","links","main","scripts","className","baseForOwn","baseEach","createBaseEach","module","exports","baseFor","createBaseFor","keys","object","iteratee","identity","value","isArrayLike","eachFunc","fromRight","collection","length","iterable","Object","keysFunc","props","arrayEach","castFunction","isArray","array","undefined"],"mappings":"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","file":"component---src-pages-d-3-js-mareys-schedule-tsx-d5050c82c8d0b8288a66.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport var mareysScheduleChart = \"mareys-schedule-module--mareysScheduleChart--3lJCF\";\nexport var axis = \"mareys-schedule-module--axis--1fY92\";\nexport var chartTitle = \"mareys-schedule-module--chartTitle--xA3nT\";\nexport var station = \"mareys-schedule-module--station--2Lwu0\";\nexport var train = \"mareys-schedule-module--train--2F17o\";\nexport var tN = \"mareys-schedule-module--tN--1jtuN\";\nexport var tL = \"mareys-schedule-module--tL--3NtZj\";\nexport var tB = \"mareys-schedule-module--tB--2FnG5\";","import {\n  Selection,\n  axisBottom,\n  axisTop,\n  extent,\n  line as lineD3,\n  scaleLinear,\n  scaleTime,\n  select,\n  timeParse,\n  tsv,\n} from \"d3\"\n\nimport each from \"lodash/each\"\nimport last from \"lodash/last\"\n\nimport * as styles from \"./mareys-schedule.module.css\"\n\ntype TrainType = \"B\" | \"L\" | \"N\"\n\ntype RawDataItem = {\n  [stop: string]: string\n  direction: string\n  number: string\n  type: TrainType\n}\n\ntype Station = {\n  distance: number\n  key: string\n  name: string\n  zone: number\n}\n\ntype Stop = {\n  station: Station\n  time: Date | null\n  trainIndex: number\n}\n\ntype Train = {\n  direction: string\n  index: number\n  number: string\n  stops: Stop[]\n  type: TrainType\n}\n\ntype Data = {\n  stations: Station[]\n  trains: Train[]\n}\n\ntype Limits = [number, number]\ntype LimitsStr = [string, string]\n\ntype Redraw = (range: LimitsStr) => void\n\nconst trainTypeToStyle: { [key in TrainType]: string } = {\n  B: styles.tB,\n  L: styles.tL,\n  N: styles.tN,\n}\n\nconst fetchData = async (): Promise<Data> => {\n  const data = ((await tsv(\n    `${ROOT_PATH}data/d3js/mareys-schedule/data.tsv`\n  )) as unknown) as RawDataItem[]\n\n  const stations: Station[] = []\n\n  const trains: Train[] = data.map((train, trainIndex) => {\n    if (trainIndex === 0) {\n      for (const key in train) {\n        if (/^stop\\|/.test(key)) {\n          const stopFragments = key.split(\"|\")\n\n          stations.push({\n            distance: +stopFragments[2],\n            key,\n            name: stopFragments[1],\n            zone: +stopFragments[3],\n          })\n        }\n      }\n    }\n\n    return {\n      direction: train.direction,\n      index: trainIndex,\n      number: train.number,\n      stops: stations\n        .map((station) => ({\n          station,\n          time: parseTime(train[station.key]),\n          trainIndex,\n        }))\n        .filter((station) => station.time !== null),\n      type: train.type,\n    }\n  })\n\n  return {\n    stations,\n    trains,\n  }\n}\n\nconst getTrainTitle = (trainData: Train) => {\n  if (trainData.direction === \"S\") {\n    return `${trainData.stops[0].station.name} -> ${\n      last(trainData.stops)!.station.name\n    }`\n  }\n\n  return `${last(trainData.stops)!.station.name} -> ${\n    trainData.stops[0].station.name\n  }`\n}\n\nconst refreshOnHourChange = ({\n  limits,\n  redraw,\n}: {\n  limits: Limits\n  redraw: Redraw\n}) => {\n  const times: string[] = []\n\n  each(limits, (limit) => {\n    const wholeMinutes = (limit / 100) * 1200\n\n    let fragment = \"AM\"\n    let hours = Math.floor(wholeMinutes / 60)\n    let minutes = Math.floor(wholeMinutes % 60)\n\n    if (minutes > 30) {\n      minutes = minutes - 30\n      hours = hours + 1\n    } else {\n      minutes = minutes + 30\n    }\n\n    hours = hours + 4\n\n    if (hours > 23) {\n      if (hours === 24) {\n        hours = hours - 12\n      } else {\n        hours = hours - 24\n      }\n    } else if (hours > 11) {\n      fragment = \"PM\"\n\n      if (hours !== 12) {\n        hours = hours - 12\n      }\n    }\n\n    const minutesStr = minutes < 10 ? `0${minutes}` : minutes.toString()\n\n    const finalTime = `${hours}:${minutesStr}${fragment}`\n\n    return times.push(finalTime)\n  })\n\n  redraw(times as LimitsStr)\n}\n\nconst getFormatTime = () => timeParse(\"%I:%M%p\")\n\nconst parseTime = (timeStr: string) => {\n  const formatTime = getFormatTime()\n  const timeDate = formatTime(timeStr)\n\n  if (timeDate !== null && timeDate.getHours() < 3) {\n    timeDate.setDate(timeDate.getDate() + 1)\n  }\n\n  return timeDate\n}\n\nconst formatAMPM = function (date: Date) {\n  let hours = date.getHours()\n  const ampm = hours >= 12 ? \"PM\" : \"AM\"\n\n  hours = hours % 12\n  hours = hours ? hours : 12\n\n  const minutes = date.getMinutes()\n  const minutesStr = minutes < 10 ? `0${minutes}` : minutes.toString()\n\n  return `${hours}:${minutesStr} ${ampm}`\n}\n\nconst margin = {\n  bottom: 50,\n  left: 120,\n  right: 50,\n  top: 80,\n}\n\nconst height = 600 - margin.top - margin.bottom\n\nconst renderChart = ({ data, rootElId }: { data: Data; rootElId: string }) => {\n  const { stations, trains } = data\n  const rootEl = document.getElementById(rootElId) as HTMLElement\n\n  rootEl.classList.add(styles.mareysScheduleChart)\n\n  const width =\n    rootEl.getBoundingClientRect().width - margin.left - margin.right\n\n  const redraw: Redraw = (timeRange) => {\n    const x = scaleTime()\n      .domain([parseTime(timeRange[0])!, parseTime(timeRange[1])!])\n      .range([0, width])\n    const y = scaleLinear().range([0, height])\n    const formatTime = getFormatTime()\n    const xAxisTop = axisTop(x)\n      .ticks(8)\n      .tickFormat(formatTime as any)\n    const xAxisBottom = axisBottom(x)\n      .ticks(8)\n      .tickFormat(formatTime as any)\n\n    const svg = select(`#${rootElId}`)\n      .text(\"\")\n      .append(\"svg\")\n      .attr(\"height\", height + margin.top + margin.bottom)\n      .attr(\"width\", width + margin.left + margin.right)\n      .append(\"g\")\n      .attr(\"transform\", `translate(${margin.left},${margin.top})`)\n\n    svg\n      .append(\"text\")\n      .attr(\"class\", styles.chartTitle)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"transform\", `translate(${width / 2},-40)`)\n      .text(\"E.J. Marey’s graphical train schedule (4:30AM - 1:30AM)\")\n      .style(\"font-weight\", \"bold\")\n\n    filterBlackOpacity(\"trains\", svg, 2, 0.2)\n\n    svg\n      .append(\"defs\")\n      .append(\"clipPath\")\n      .attr(\"id\", \"clip\")\n      .append(\"rect\")\n      .attr(\"y\", -margin.top)\n      .attr(\"width\", width)\n      .attr(\"height\", height + margin.top + margin.bottom)\n\n    y.domain(extent(stations, (station) => station.distance) as Limits)\n\n    const station = svg\n      .append(\"g\")\n      .attr(\"class\", styles.station)\n      .selectAll(\"g\")\n      .data(stations)\n      .enter()\n      .append(\"g\")\n      .attr(\"transform\", (d) => `translate(0,${y(d.distance)})`)\n\n    station\n      .append(\"text\")\n      .attr(\"x\", -6)\n      .attr(\"dy\", \".35em\")\n      .text((d) => d.name)\n    station.append(\"line\").attr(\"x2\", width)\n    svg.append(\"g\").attr(\"class\", `x top ${styles.axis}`).call(xAxisTop)\n    svg\n      .append(\"g\")\n      .attr(\"class\", `x bottom ${styles.axis}`)\n      .attr(\"transform\", `translate(0,${height})`)\n      .call(xAxisBottom)\n\n    const mouseover = function (_e: unknown, d: Train) {\n      select(`.train-${d.index}`).select(\"path\").style(\"stroke-width\", \"5px\")\n    }\n\n    const mouseleave = function (_e: unknown, d: Train) {\n      select(`.train-${d.index}`).select(\"path\").style(\"stroke-width\", \"2.5px\")\n    }\n\n    const train = svg\n      .append(\"g\")\n      .attr(\"class\", styles.train)\n      .attr(\"clip-path\", \"url(#clip)\")\n      .selectAll(\"g\")\n      .data(trains.filter((d) => /[NLB]/.test(d.type)))\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", (d) => `${trainTypeToStyle[d.type]} train-${d.index}`)\n      .on(\"mouseover\", mouseover)\n      .on(\"mouseleave\", mouseleave)\n\n    const line = lineD3<Stop>()\n      .x((d) => x(d.time!))\n      .y((d) => y(d.station.distance))\n\n    train\n      .append(\"path\")\n      .attr(\"d\", (d) => line(d.stops))\n      .append(\"title\")\n      .text((d) => getTrainTitle(d))\n\n    train\n      .selectAll(\"circle\")\n      .data((d) => d.stops)\n      .enter()\n      .append(\"circle\")\n      .attr(\n        \"transform\",\n        (d) => `translate(${x(d.time!)},${y(d.station.distance)})`\n      )\n      .style(\"filter\", \"url(#drop-shadow-trains)\")\n      .attr(\"r\", \"5px\")\n      .append(\"title\")\n      .text(\n        (d) =>\n          `${getTrainTitle(trains[d.trainIndex])}\\n${\n            d.station.name\n          } at ${formatAMPM(d.time!)}`\n      )\n  }\n\n  return {\n    refresh: (limits: [number, number]) => {\n      refreshOnHourChange({\n        limits,\n        redraw,\n      })\n    },\n  }\n}\n\nconst main = async () => {\n  const rootElId = \"chart\"\n\n  const data = await fetchData()\n\n  const { refresh } = renderChart({\n    data,\n    rootElId,\n  })\n\n  const slider: any = $(\".slider\")\n\n  slider.slider({\n    change: () => {\n      const limits: Limits = slider.slider(\"values\")\n\n      refresh(limits)\n    },\n    range: true,\n  })\n\n  slider.slider(\"values\", [10, 50])\n}\n\nconst filterBlackOpacity = (\n  id: string,\n  svg: Selection<SVGGElement, unknown, HTMLElement, unknown>,\n  deviation: number,\n  slope: number\n) => {\n  const defs = svg.append(\"defs\")\n  const filter = defs\n    .append(\"filter\")\n    .attr(\"height\", \"500%\")\n    .attr(\"id\", `drop-shadow-${id}`)\n    .attr(\"width\", \"500%\")\n    .attr(\"x\", \"-200%\")\n    .attr(\"y\", \"-200%\")\n\n  filter\n    .append(\"feGaussianBlur\")\n    .attr(\"in\", \"SourceAlpha\")\n    .attr(\"stdDeviation\", deviation)\n\n  filter.append(\"feOffset\").attr(\"dx\", 1).attr(\"dy\", 1)\n  filter\n    .append(\"feComponentTransfer\")\n    .append(\"feFuncA\")\n    .attr(\"slope\", slope)\n    .attr(\"type\", \"linear\")\n\n  const feMerge = filter.append(\"feMerge\")\n\n  feMerge.append(\"feMergeNode\")\n\n  feMerge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\")\n}\n\nexport default main\n","import React from \"react\"\n\nimport { DemoPageProps } from \"@/common\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/mareys-schedule/mareys-schedule\"\n\nconst MareysSchedule = ({ pageContext }: DemoPageProps) => (\n  <Demo\n    links={[\"/vendors/jquery-ui/themes/base/jquery-ui.min.css\"]}\n    main={main}\n    pageContext={pageContext}\n    scripts={[\"/vendors/jquery-ui/jquery-ui.min.js\"]}\n  >\n    <div>\n      <div className=\"slider\" />\n    </div>\n    <div id=\"chart\" />\n  </Demo>\n)\n\nexport default MareysSchedule\n","var baseForOwn = require('./_baseForOwn'),\n    createBaseEach = require('./_createBaseEach');\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nmodule.exports = baseEach;\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","var isArrayLike = require('./isArrayLike');\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nmodule.exports = createBaseEach;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","module.exports = require('./forEach');\n","var arrayEach = require('./_arrayEach'),\n    baseEach = require('./_baseEach'),\n    castFunction = require('./_castFunction'),\n    isArray = require('./isArray');\n\n/**\n * Iterates over elements of `collection` and invokes `iteratee` for each element.\n * The iteratee is invoked with three arguments: (value, index|key, collection).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n * property are iterated like arrays. To avoid this behavior use `_.forIn`\n * or `_.forOwn` for object iteration.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @alias each\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n * @see _.forEachRight\n * @example\n *\n * _.forEach([1, 2], function(value) {\n *   console.log(value);\n * });\n * // => Logs `1` then `2`.\n *\n * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forEach(collection, iteratee) {\n  var func = isArray(collection) ? arrayEach : baseEach;\n  return func(collection, castFunction(iteratee));\n}\n\nmodule.exports = forEach;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","/**\n * Gets the last element of `array`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to query.\n * @returns {*} Returns the last element of `array`.\n * @example\n *\n * _.last([1, 2, 3]);\n * // => 3\n */\nfunction last(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? array[length - 1] : undefined;\n}\n\nmodule.exports = last;\n"],"sourceRoot":""}