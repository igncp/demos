(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[907],{2137:function(t,e,n){"use strict";function r(t,e,n,r,o,i,a){try{var s=t[i](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,o)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var a=t.apply(e,n);function s(t){r(a,o,i,s,u,"next",t)}function u(t){r(a,o,i,s,u,"throw",t)}s(void 0)}))}}n.d(e,{Z:function(){return o}})},9646:function(t,e,n){"use strict";var r;n.d(e,{Z:function(){return m}});var o=new Uint8Array(16);function i(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(o)}var a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var s=function(t){return"string"==typeof t&&a.test(t)},u=[],c=0;c<256;++c)u.push((c+256).toString(16).substr(1));var l,d,f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(u[t[e+0]]+u[t[e+1]]+u[t[e+2]]+u[t[e+3]]+"-"+u[t[e+4]]+u[t[e+5]]+"-"+u[t[e+6]]+u[t[e+7]]+"-"+u[t[e+8]]+u[t[e+9]]+"-"+u[t[e+10]]+u[t[e+11]]+u[t[e+12]]+u[t[e+13]]+u[t[e+14]]+u[t[e+15]]).toLowerCase();if(!s(n))throw TypeError("Stringified UUID is invalid");return n},p=0,g=0;var m=function(t,e,n){var r=e&&n||0,o=e||new Array(16),a=(t=t||{}).node||l,s=void 0!==t.clockseq?t.clockseq:d;if(null==a||null==s){var u=t.random||(t.rng||i)();null==a&&(a=l=[1|u[0],u[1],u[2],u[3],u[4],u[5]]),null==s&&(s=d=16383&(u[6]<<8|u[7]))}var c=void 0!==t.msecs?t.msecs:Date.now(),m=void 0!==t.nsecs?t.nsecs:g+1,v=c-p+(m-g)/1e4;if(v<0&&void 0===t.clockseq&&(s=s+1&16383),(v<0||c>p)&&void 0===t.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=c,g=m,d=s;var h=(1e4*(268435455&(c+=122192928e5))+m)%4294967296;o[r++]=h>>>24&255,o[r++]=h>>>16&255,o[r++]=h>>>8&255,o[r++]=255&h;var y=c/4294967296*1e4&268435455;o[r++]=y>>>8&255,o[r++]=255&y,o[r++]=y>>>24&15|16,o[r++]=y>>>16&255,o[r++]=s>>>8|128,o[r++]=255&s;for(var x=0;x<6;++x)o[r+x]=a[x];return e||f(o)}},6126:function(t,e,n){"use strict";n.d(e,{p:function(){return r},H:function(){return o}});var r="storybook",o={SCRIPT:"/vendors/jquery-ui/jquery-ui.min.js",STYLE:"/vendors/jquery-ui/themes/base/jquery-ui.min.css"}},5250:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return T}});var r,o,i=n(7294),a=n(6126),s=n(4275),u=n(2137),c=n(7757),l=n.n(c),d=n(7723),f=n(9646),p="expenses-chord-module--chordGroup--2xhSq",g="expenses-chord-module--groupText--2wIqW",m="expenses-chord-module--ribbon--28nns",v=800;!function(t){t.Source="source",t.Target="target"}(r||(r={})),function(t){t.Arrow="arrow",t.Common="common"}(o||(o={}));var h=1e3,y=500,x=d.XeF,A=function(t){t.style("opacity",.7).on("mouseenter",(function(){(0,d.Ys)(this).style("opacity",1)})).on("mouseleave",(function(){(0,d.Ys)(this).style("opacity",.7)}))},C=function(t){(0,d.Ys)(this).transition().duration(y).attr("transform",t.transform)},b=function(t){var e=t.rootElId,n={lastFocused:null},i=t.chordGroupsIds,a=(0,d.PKp)(i,d.K2I),s=document.getElementById(e).getBoundingClientRect().width,u=.5*Math.min(s,v)-20,c=u+20,l=function(t){return t.radius(u-.5).padAngle(1/u)},y=l((0,d.tQZ)()),b=l((0,d.N22)()),w=(0,d.sPX)().extent([[0,0],[s/2,400]]).on("end",C),I=(0,d.Ys)("#"+e).attr("class","expenses-chord-module--chartWrapper--1V-_7").append("svg").attr("width",s).attr("height",850).append("g").attr("transform","translate("+s/2+", 425)").append("g").call(w).on("dblclick.zoom",null);I.append("rect").attr("fill","#fff").attr("width",s).attr("height",v).attr("transform","translate(-"+s/2+", -425)");var R=(0,f.Z)(),k=(0,d.rKe)().padAngle(12/u).sortSubgroups(d.$1i).sortChords(d.$1i);I.append("path").attr("fill","none").attr("id",R).attr("d",(0,d.Nb1)()({endAngle:2*Math.PI,innerRadius:0,outerRadius:c,startAngle:0}));var L=(0,d.Nb1)().innerRadius(u).outerRadius(c),T=I.append("g"),E=I.append("g").attr("font-family","sans-serif").attr("font-size",10),D=function(t){return t.source.index+"_"+t.target.index},F=function(){var e=t.getRibbonType()===o.Common?b:y,s=t.getChordMatrix(),u=k(s),l=T.selectAll("."+m).data().reduce((function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],o=e[1];return r[D(o)]=o,r}),{}),f=function(e){return a(t.getRibbonGroupIdColor(i[e.source.index],i[e.target.index]))},v=T.selectAll("."+m).data(u,(function(t){return D(t)})).join((function(t){var n=t.append("path").attr("class",m).attr("fill",f);return A(n),n.transition().duration(h).attrTween("d",(function(t){var n={endAngle:0,startAngle:0},r={endAngle:0,startAngle:0},o=(0,d.sXR)(n,t.source),i=(0,d.sXR)(r,t.target);return function(t){var n={source:o(t),target:i(t)};return e(n)}}))}),(function(t){return t.transition().duration(h).attr("fill",f).attrTween("d",(function(t){var n=l[D(t)];if(!n)return function(){return e(t)};var r=(0,d.sXR)(n.source,t.source),o=(0,d.sXR)(n.target,t.target);return function(t){var n={source:r(t),target:o(t)};return e(n)}})),t}));v.attr("title",(function(e){return t.getChordTitle(e.source.index,e.target.index,e.source.value,e.target.value)})).on("click",(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var o=e[1],a=(0,d.Ys)(this),s=i[o.source.index]+"_"+i[o.target.index];n.lastFocused===s?(v.attr("display","block"),n.lastFocused=null):(v.attr("display","none"),a.attr("display","block"),n.lastFocused=s)})),$("."+m).tooltip({track:!0});var C=function(e){return e.endAngle-e.startAngle<.07?"":t.getChordGroupTitle(i[e.index])},w=E.selectAll("."+p).data();E.selectAll("."+p).data(u.groups,(function(t){return t.index})).join((function(e){var o=e.append("g").attr("class",p).attr("title",(function(e){return t.getChordGroupTitle(i[e.index])}));return A(o),o.append("path").attr("class","group-path").transition().duration(h).ease(x).attrTween("d",(function(t){var e=(0,d.sXR)(Object.assign({},t,{endAngle:0,startAngle:0}),t);return function(t){return L(e(t))}})).attr("fill",(function(t){return a(i[t.index])})).attr("stroke","#fff"),o.append("text").attr("dy",-3).append("textPath").attr("xlink:href","#"+R).attr("class",g).text(C).transition().duration(h).ease(x).attr("startOffset",(function(t){return t.startAngle*c})),o.on("click",(function(){for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];var s=o[1],u=i[s.index],c=T.selectAll("."+m);if(n.lastFocused===u)return c.attr("display",(function(){return"block"})),void(n.lastFocused=null);n.lastFocused=u,t.getDisplayTypeOnGroupClick(u)!==r.Source?c.attr("display",(function(t){return t.target.index===s.index?"block":"none"})):c.attr("display",(function(t){return t.source.index===s.index?"block":"none"}))})),$("."+p).tooltip({track:!0}),o}),(function(t){return t.select(".group-path").transition().duration(h).attrTween("d",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],o=e[1],i=w[o],a=(0,d.sXR)(i,r);return function(t){return L(a(t))}})),t.select("."+g).text(C).transition().duration(h).attr("startOffset",(function(t){return t.startAngle*c})),t}),(function(t){return t.remove()})).attr("class",p)};return F(),{renderItems:F}},w=function(){function t(t){var e=Object.keys(t).sort();this.countries=e,this.regions=Object.keys(t[e[0]]).sort(),this.expensesData=t,this.names=e.concat(this.regions)}t.fetchAndCreate=function(){var e=(0,u.Z)(l().mark((function e(){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.AVB)("/demos/data/d3js/expenses-chord/data.json");case 2:return n=e.sent,e.abrupt("return",new t(n));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();var e=t.prototype;return e.getRelationsMatrix=function(e){var n=e.countryFilter,r=e.regionFilter,o=e.timeIndexFilter,i=this.expensesData,a=this.names;return a.map((function(e){return i[e]&&[t.ALL_ID,e].includes(n)?a.map((function(n){var a=i[e][n];return a&&[t.ALL_ID,n].includes(r)?a[o].value:0})):a.map((function(){return 0}))}))},e.getTimeFramesNumber=function(){var t=this.countries,e=this.expensesData,n=this.regions;return e[t[0]][n[0]].length-1},e.getCountriesList=function(){return this.countries.slice()},e.getRegionsList=function(){return this.regions.slice()},e.getAllNames=function(){return this.names.slice()},t}();w.ALL_ID="All";var I="chart",R=function(t){var e=t.expenses,n=t.state,i=e.getAllNames();return{chordGroupsIds:i,getChordGroupTitle:function(t){return t},getChordMatrix:function(){return e.getRelationsMatrix({countryFilter:n.selectedCountry,regionFilter:n.selectedRegion,timeIndexFilter:n.timeIndex})},getChordTitle:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],o=e[1],a=e[2];return'People from "'+i[r]+'" spend into "'+i[o]+'": '+a},getDisplayTypeOnGroupClick:function(t){return e.getCountriesList().includes(t)?r.Source:r.Target},getRibbonGroupIdColor:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var o=e[0],i=e[1];return n.selectedRegion===w.ALL_ID?i:o},getRibbonType:function(){return n.selectedCountry!==w.ALL_ID&&n.selectedRegion!==w.ALL_ID?o.Common:o.Arrow},rootElId:I}},k=function(t){var e=t.expenses,n=t.renderItems,r=t.state;$("#slider-time").slider({change:function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];var i=e[1].value;3!==i&&(r.timeIndex=i,n())},max:e.getTimeFramesNumber(),min:0});var o=function(t){var e=t.id,n=t.onChange,r=t.selectOptions,o=document.getElementById(e);[w.ALL_ID].concat(r).forEach((function(t){var e=document.createElement("option");e.setAttribute("value",t),e.innerText=t,o.appendChild(e)})),o.addEventListener("change",(function(){n(o.value)}))};o({id:"countries-select",onChange:function(t){r.selectedCountry=t,n()},selectOptions:e.getCountriesList()}),o({id:"regions-select",onChange:function(t){r.selectedRegion=t,n()},selectOptions:e.getRegionsList()})},L=function(){var t=(0,u.Z)(l().mark((function t(){var e,n,r,o,i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.fetchAndCreate();case 2:e=t.sent,n={selectedCountry:w.ALL_ID,selectedRegion:w.ALL_ID,timeIndex:0},r=R({expenses:e,state:n}),o=b(r),i=o.renderItems,k({expenses:e,renderItems:i,state:n});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),T=function(t){var e=t.pageContext;return i.createElement(s.Z,{links:[a.H.STYLE],main:L,pageContext:e,scripts:[a.H.SCRIPT]},i.createElement("div",null,"Time Item:"),i.createElement("div",{className:"expenses-chord-module--sliderTime--1AAv8",id:"slider-time"}),i.createElement("p",null,i.createElement("span",null,"Countries:"),i.createElement("select",{className:"expenses-chord-module--countriesSelect--bu3tz",id:"countries-select"}),i.createElement("span",null,"Regions:"),i.createElement("select",{id:"regions-select"})),i.createElement("div",{id:I}))}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-expenses-chord-tsx-e7354a892a64609de93a.js.map