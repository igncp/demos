(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[921],{2242:function(t,e,n){"use strict";function r(t){return t}function a(t,e){return"string"==typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return o(t,e)}))}:o(t,e)}function o(t,e){var n=e.id,a=e.bbox,o=null==e.properties?{}:e.properties,i=function(t,e){var n=function(t){if(null==t)return r;var e,n,a=t.scale[0],o=t.scale[1],i=t.translate[0],s=t.translate[1];return function(t,r){r||(e=n=0);var d=2,u=t.length,l=new Array(u);for(l[0]=(e+=t[0])*a+i,l[1]=(n+=t[1])*o+s;d<u;)l[d]=t[d],++d;return l}}(t.transform),a=t.arcs;function o(t,e){e.length&&e.pop();for(var r=a[t<0?~t:t],o=0,i=r.length;o<i;++o)e.push(n(r[o],o));t<0&&function(t,e){for(var n,r=t.length,a=r-e;a<--r;)n=t[a],t[a++]=t[r],t[r]=n}(e,i)}function i(t){return n(t)}function s(t){for(var e=[],n=0,r=t.length;n<r;++n)o(t[n],e);return e.length<2&&e.push(e[0]),e}function d(t){for(var e=s(t);e.length<4;)e.push(e[0]);return e}function u(t){return t.map(d)}function l(t){var e,n=t.type;switch(n){case"GeometryCollection":return{type:n,geometries:t.geometries.map(l)};case"Point":e=i(t.coordinates);break;case"MultiPoint":e=t.coordinates.map(i);break;case"LineString":e=s(t.arcs);break;case"MultiLineString":e=t.arcs.map(s);break;case"Polygon":e=u(t.arcs);break;case"MultiPolygon":e=t.arcs.map(u);break;default:return null}return{type:n,coordinates:e}}return l(e)}(t,e);return null==n&&null==a?{type:"Feature",properties:o,geometry:i}:null==a?{type:"Feature",id:n,properties:o,geometry:i}:{type:"Feature",id:n,bbox:a,properties:o,geometry:i}}n.d(e,{Z:function(){return a}})},3727:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return v}});var r=n(7294),a=n(4275),o=n(8634),i=n(2656),s=n.n(i),d=n(5221),u=n(2242),l="chart",c="update-colors",h=1500,p=[d.BT8,d.T0$,d.sY$,d.Vaf,d._BJ],f=function(){function t(t){var e=this;this.state={colorFnIndex:0,draggedX:0,draggedY:0,lastZoomId:null},this.setZoom=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n[1],o=e.dimensions,i=o.height,s=o.width,d=e.getCountriesSel();if(!a||e.state.lastZoomId===a.id)return e.state.lastZoomId=null,void d.transition().duration(h).attr("transform","translate("+s/2+","+i/2+")scale(1)translate("+-s/2+","+-i/2+")");e.state.lastZoomId=a.id;var u=e.projectionPath.centroid(a),l=u[0],c=u[1];d.transition().duration(h).attr("transform","translate("+s/2+","+i/2+")scale(8)translate("+-l+","+-c+")")},this.handleWindowResize=function(){e.render()},this.config=t;var n=this.config.rootElId,r=(0,d.Ys)("#"+n).append("svg"),a=r.append("g"),o=a.append("rect").attr("class","background").style("fill","#daedff"),i=a.append("g");!function(t){var e=t.deviation,n=t.slope,r=t.svg.append("defs").append("filter").attr("id","drop-shadow");r.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",e),r.append("feOffset").attr("dx",1).attr("dy",1),r.append("feComponentTransfer").append("feFuncA").attr("slope",n).attr("type","linear");var a=r.append("feMerge");a.append("feMergeNode"),a.append("feMergeNode").attr("in","SourceGraphic")}({deviation:2,slope:.5,svg:r}),r.append("g").append("filter").attr("height","300%").attr("x","-100%").attr("y","-100%").attr("id","blur").attr("width","300%").append("feGaussianBlur").attr("stdDeviation","5 5"),this.elements={backgroundSel:o,contentSel:i,svgDragSel:a,svgSel:r},this.render(),this.setupDrag(),window.addEventListener("resize",this.handleWindowResize)}var e=t.prototype;return e.teardown=function(){window.removeEventListener("resize",this.handleWindowResize)},e.updateColors=function(){this.state.colorFnIndex+=1,this.state.colorFnIndex>=p.length&&(this.state.colorFnIndex=0),this.render()},e.setDimensions=function(){var t=this.config.rootElId,e=document.getElementById(t).getBoundingClientRect().width;this.dimensions={height:500,width:e}},e.render=function(){var t=this,e=this.config.world,n=this.elements,r=n.backgroundSel,a=n.svgSel;this.setDimensions();var o=this.dimensions,i=o.height,s=o.width,l=(0,d.mw4)().center([0,45.4]).scale(Math.max(150*s/750,140)).translate([s/2,i/2]);this.projectionPath=(0,d.l49)().projection(l);var c=(0,u.Z)(e,e.objects.countries).features;this.bounds=function(t){var e=t.featuresData,n=t.projectionPath;return e.reduce((function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var a=e[0],o=e[1],i=n.bounds(o);return a[0][0]=Math.min(a[0][0],i[0][0]),a[0][1]=Math.min(a[0][1],i[0][1]),a[1][0]=Math.max(a[1][0],i[1][0]),a[1][1]=Math.max(a[1][1],i[1][1]),a}),[[1/0,1/0],[-1/0,-1/0]])}({featuresData:c,projectionPath:this.projectionPath});var h=(0,d.BYU)().domain([0,c.length-1]).range([0,1]);a.attr("width",s).attr("height",i);var f=1e5;r.on("click",this.setZoom).attr("height",f).attr("width",f).attr("transform","translate("+Math.min(0,(f-s)/-2)+", "+Math.min(0,(f-i)/-2)+")");var g=this.getCountriesSel().data(c);g.exit().remove(),g.enter().append("path").attr("class",(function(t){return"country "+t.id})).style("stroke","#fff").style("stroke-width","1px").attr("filter","url(#drop-shadow)");var m=this.getCountriesSel().attr("d",this.projectionPath).style("fill",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=n[1];return p[t.state.colorFnIndex](h(a))})).on("mouseenter",(function(){m.attr("filter","url(#blur)"),(0,d.Ys)(this).attr("filter","url(#drop-shadow)").style("stroke-width","2px")})).on("mouseleave",(function(){m.attr("filter","url(#drop-shadow)").style("stroke-width","1px")})).on("click",this.setZoom);this.updateDrag()},e.getCountriesSel=function(){return this.elements.contentSel.selectAll(".country")},e.updateDrag=function(){var t=this.bounds,e=this.dimensions,n=e.height,r=e.width,a=this.elements.svgDragSel;!function(t){var e=t.bounds,n=t.dragPoint,r=t.height,a=t.width;-1*n.draggedX<e[0][0]?n.draggedX=-1*e[0][0]:-1*n.draggedX>e[1][0]-a&&(n.draggedX=-1*(e[1][0]-a)),-1*n.draggedY<e[0][1]?n.draggedY=-1*e[0][1]:-1*n.draggedY>e[1][1]-r&&(n.draggedY=-1*(e[1][1]-r))}({bounds:t,dragPoint:this.state,height:n,width:r}),a.attr("transform","translate("+this.state.draggedX+","+this.state.draggedY+")")},e.setupDrag=function(){var t=this,e=this.elements.svgSel,n=function(e){t.state.draggedX+=e.dx,t.state.draggedY+=e.dy,t.updateDrag()},r=(0,d.ohM)().on("drag",n);e.style("cursor","move").call(r).on("drag",n)},t}(),g=function(){var t=(0,o.Z)(s().mark((function t(){var e,n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,d.AVB)("/demos/data/d3js/world-map/world.json");case 2:n=t.sent,r=new f({rootElId:l,world:n}),null===(e=document.getElementById(c))||void 0===e||e.addEventListener("click",(function(){r.updateColors()}));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),m=g,v=function(t){var e=t.pageContext;return r.createElement(a.Z,{main:m,pageContext:e},r.createElement("form",{style:{marginBottom:20}},r.createElement("button",{className:"btn btn-info",id:c,type:"button"},"Update colors")),r.createElement("div",{id:l}))}},2656:function(t,e,n){t.exports=n(3076)},8634:function(t,e,n){"use strict";function r(t,e,n,r,a,o,i){try{var s=t[o](i),d=s.value}catch(u){return void n(u)}s.done?e(d):Promise.resolve(d).then(r,a)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(a,o){var i=t.apply(e,n);function s(t){r(i,a,o,s,d,"next",t)}function d(t){r(i,a,o,s,d,"throw",t)}s(void 0)}))}}n.d(e,{Z:function(){return a}})}}]);
//# sourceMappingURL=component---src-pages-d-3-js-world-map-tsx-e1fa618c0d3a6a72d06f.js.map