"use strict";(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[305],{474:function(t,e,n){n.r(e),n.d(e,{default:function(){return T}});var r=n(7294),o=n(4275),i=n(8634),a=n(2656),l=n.n(a),s=n(5221),c=n(2149),u="multiline-voronoi-module--axis--73b38",p="multiline-voronoi-module--lineHover--07a40",d="multiline-voronoi-module--formVoronoi--b33e2",m=300,f=function(){function t(t){var e=this;this.handleResize=function(){e.render()},this.config=t;var n=(0,s.Ys)("#"+this.config.rootElId).append("svg"),r=n.append("g"),o=r.append("g").attr("class",u+" axis--x"),i=r.append("g").attr("class",u+" axis--y");r.append("text").attr("x",20).attr("dy",".32em").style("font-weight","bold").text(this.config.chartTitle),function(t){var e=t.append("defs").append("filter").attr("id","drop-shadow");e.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",1),e.append("feOffset").attr("dx",1).attr("dy",1),e.append("feComponentTransfer").append("feFuncA").attr("slope","1").attr("type","linear");var n=e.append("feMerge");n.append("feMergeNode"),n.append("feMergeNode").attr("in","SourceGraphic")}(r);var a=r.append("g").attr("class","multiline-voronoi-module--lines--3e92b"),l=r.append("circle").attr("r",3.5),c=r.append("g").attr("class","multiline-voronoi-module--voronoi--c0339"),p=function(t){var e=t.append("g").attr("class","multiline-voronoi-module--tooltip--f507c").attr("transform","translate(-100,-100)");return e.append("rect").attr("transform","translate(-150,-50)").attr("fill","white").attr("height",50).attr("width",m).attr("rx",5).attr("ry",5).style("filter","url(#drop-shadow)").style("opacity","0.65").style("pointer-events","none").style("cursor","default"),e.append("text").attr("class","text1").attr("y",-30),e.append("text").attr("class","text2").attr("y",-10),e}(r);this.elements={circle:l,linesWrapper:a,svg:n,svgG:r,tooltip:p,voronoiGroup:c,xAxis:o,yAxis:i},this.state={clickToggle:!1,usedLines:this.config.lines},this.render(),window.addEventListener("resize",this.handleResize)}t.getMargin=function(t){var e={bottom:70,left:80,right:70,top:60};return t<530?Object.assign({},e,{left:35,right:5}):e};var e=t.prototype;return e.setVoronoi=function(t){this.elements.voronoiGroup.classed("multiline-voronoi-module--voronoiShow--cb86f",t)},e.render=function(){var e=this,n=this.config,r=n.lines,o=n.rootElId,i=n.times,a=this.elements,l=(0,s.PKp)(s.i4X),u=document.getElementById(o);u.classList.add("multiline-voronoi-module--multilineVoronoiChart--706ac");var d=u.getBoundingClientRect().width,m=t.getMargin(d),f=u.getBoundingClientRect().width-m.left-m.right,g=f<530,h=500-m.top-m.bottom,v=(0,s.Xf)().range([0,f]),y=(0,s.BYU)().range([h,0]),x=function(t){return v(e.config.getPointXValue(t))},w=function(t){return y(e.config.getPointYValue(t))},b={};a.svg.attr("width",f+m.left+m.right).attr("height",h+m.top+m.bottom),a.svgG.attr("transform","translate("+m.left+","+m.top+")"),v.domain((0,s.Wem)(i)),y.domain([0,(0,s.Fp7)(r,(function(t){return(0,s.Fp7)(e.config.getLinePoints(t),e.config.getPointYValue)}))]).nice(),a.xAxis.attr("transform","translate(0,"+h+")").call((0,s.LLu)(v).ticks(g?2:void 0)),a.yAxis.call((0,s.y4O)(y).ticks(10,"%"));var P=(0,s.jvg)().x(x).y(w),k=this.config,A=this.state.usedLines,L=a.linesWrapper.selectAll("path").data(A);L.enter().append("path").style("filter","url(#drop-shadow)"),L.exit().remove(),a.linesWrapper.selectAll("path").attr("d",(function(t){var e=k.getLineId(t);b[e]=this;var n=k.getLinePoints(t);return P(n)})).style("stroke",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[1];return l(r.toString())}));var I=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var i=n[1];e.state.clickToggle=!e.state.clickToggle,e.state.usedLines=e.state.clickToggle?[r.find((function(t){return k.getLineId(t)===k.getLineIdFromPoint(i)}))]:r,a.tooltip.on("mouseover",null).on("click",null),e.render()},E=A.reduce((function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],o=e[1],i=k.getLinePoints(o);return i.forEach((function(t){r.push(t)})),r}),[]),F=c.Z.from(E,x,w).voronoi([-m.left,-m.top,f+m.right,h+m.bottom]),C=this.elements.voronoiGroup.selectAll("path").data(E,(function(t){return k.getLineIdFromPoint(t)+"-"+k.getPointXValue(t)}));C.enter().append("path"),C.exit().remove(),this.elements.voronoiGroup.selectAll("path").attr("d",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[1];return F.renderCell(r)})).on("mouseover",(function t(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=n[1],i=k.getLineIdFromPoint(o),l=b[i];(0,s.Ys)(l).classed(p,!0),l.parentNode.appendChild(l);var c=x(o),u=w(o),d=Math.min(f-150,Math.max(150,c)),m=u;a.tooltip.attr("transform","translate("+d+","+m+")").on("mouseover",(function(){t(null,o)})).on("click",(function(){I(null,o)})),a.circle.attr("transform","translate("+c+","+u+")"),a.tooltip.select(".text1").text(k.getTooltipPart1(o)),a.tooltip.select(".text2").text(k.getTooltipPart2(o))})).on("mouseout",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[1],o=k.getLineIdFromPoint(r),i=b[o];return(0,s.Ys)(i).classed(p,!1),a.tooltip.attr("transform","translate(-100,-100)")})).on("click",I)},t}(),g="chart",h="show-voronoi",v=["January","February","March","April","May","June","July","August","September","October","November","December"],y="%Y-%m",x=function(){var t=(0,i.Z)(l().mark((function t(){var e,n,r,o,i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(0,s.i$Z)(y),n=(0,s.Z1g)(y),t.next=4,(0,s.pvA)("/demos/data/d3js/multiline-voronoi/data.tsv");case 4:return r=t.sent,o=Object.keys(r[0]).map((function(t){return n(t)})).filter(Number),i=r.map((function(t){var n=t.name.replace(/(msa|necta div|met necta|met div)$/i,"").trim();return{metrics:o.map((function(r){var o=e(r),i=t[o],a=Number(i)/100;return{cityName:n,date:r,employmentRate:a}})),name:n}})),t.abrupt("return",{cities:i,months:o});case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),w=function(t){return t.name},b=function(t){return t.metrics},P=function(t){return t.employmentRate},k=function(t){return t.cityName.trim()+": "},A=function(t){var e=v[t.date.getMonth()]+" of "+t.date.getFullYear();return" "+(100*t.employmentRate).toFixed(2)+"% - "+e},L=function(t){return t.cityName},I=function(t){return t.date},E=function(t){var e=t.cities,n=t.months;return{chartTitle:"US Unemployment Rate",getLineId:w,getLineIdFromPoint:L,getLinePoints:b,getPointXValue:I,getPointYValue:P,getTooltipPart1:k,getTooltipPart2:A,lines:e,rootElId:g,times:n}},F=function(){var t=(0,i.Z)(l().mark((function t(){var e,n,r,o,i,a;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:e=t.sent,n=e.cities,r=e.months,o=E({cities:n,months:r}),i=new f(o),a=document.getElementById(d),document.getElementById(g).appendChild(a),(0,s.Ys)("#show-voronoi").property("disabled",!1).on("change",(function(t){i.setVoronoi(t.target.checked||!1)}));case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),C=F,T=function(t){var e=t.pageContext;return r.createElement(o.Z,{main:C,pageContext:e},r.createElement("form",{id:d},r.createElement("input",{id:h,type:"checkbox"})," ",r.createElement("label",{htmlFor:h},"Show Voronoi lines")),r.createElement("div",{id:g}))}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-multiline-voronoi-tsx-02c45fc5eaea6f8ac6c5.js.map