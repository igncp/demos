(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[495],{6117:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return i}});var r=n(7294),a=n(7538),s=function(){var t=!1,e=[],n={bottom:50,left:120,right:50,top:80},r=$("#chart").innerWidth()-n.left-n.right,a=600-n.top-n.bottom,s=d3.time.format("%I:%M%p"),i=function(t){var e=s.parse(t);return null!==e&&e.getHours()<3&&e.setDate(e.getDate()+1),e},o=$(".slider");return o.slider({change:function(){var u=[];return _.each(o.slider("values"),(function(t){var e=t/100*1200,n="AM",r=Math.floor(e/60),a=Math.floor(e%60);a>30?(a-=30,r+=1):a+=30,(r+=4)>23?r-=24===r?12:24:r>11&&(n="PM",12!==r&&(r-=12)),a<10&&(a="0"+String(a));var s=String(r)+":"+a+n;return u.push(s)})),function(o){var u=d3.time.scale().domain([i(o[0]),i(o[1])]).range([0,r]),l=d3.scale.linear().range([0,a]),c=d3.svg.axis().scale(u).ticks(8).tickFormat(s),d=d3utils.svg("#chart",r,a,n);d3utils.middleTitle(d,r,"E.J. Mareyâ€™s graphical train schedule  (4:30AM - 1:30AM)",-40),d3utils.filterBlackOpacity("trains",d,2,.2),d.append("defs").append("clipPath").attr("id","clip").append("rect").attr("y",-n.top).attr("width",r).attr("height",a+n.top+n.bottom),l.domain(d3.extent(e,(function(t){return t.distance})));var p=d.append("g").attr("class","station").selectAll("g").data(e).enter().append("g").attr("transform",(function(t){return"translate(0,"+l(t.distance)+")"}));p.append("text").attr("x",-6).attr("dy",".35em").text((function(t){return t.name})),p.append("line").attr("x2",r),d.append("g").attr("class","x top axis").call(c.orient("top")),d.append("g").attr("class","x bottom axis").attr("transform","translate(0,"+a+")").call(c.orient("bottom"));var m=d.append("g").attr("class","train").attr("clip-path","url(#clip)").selectAll("g").data(t.filter((function(t){return/[NLB]/.test(t.type)}))).enter().append("g").attr("class",(function(t){return t.type+" train-"+t.index})).on("mouseover",(function(t){return d3.select(".train-"+t.index).select("path").style({"stroke-width":"5px"})})).on("mouseleave",(function(t){return d3.select(".train-"+t.index).select("path").style({"stroke-width":"2.5px"})})),f=d3.svg.line().x((function(t){return u(t.time)})).y((function(t){return l(t.station.distance)})),h=function(t){return"S"===t.direction?t.stops[0].station.name+" -> "+_.last(t.stops).station.name:_.last(t.stops).station.name+" -> "+t.stops[0].station.name};m.append("path").attr("d",(function(t){return f(t.stops)})).append("title").text((function(t){return h(t)})),m.selectAll("circle").data((function(t){return t.stops})).enter().append("circle").attr("transform",(function(t){return"translate("+u(t.time)+","+l(t.station.distance)+")"})).style({filter:"url(#drop-shadow-trains)"}).attr("r","5px").append("title").text((function(e){return h(t[e.train_index])+"\n"+e.station.name+" at "+(s=(r=(n=e.time).getHours())>=12?"PM":"AM",(r=(r%=12)||12)+":"+(a=(a=n.getMinutes())<10?"0"+a:a)+" "+s);var n,r,a,s}))}(u)},range:!0}),d3.tsv("/data/d3js/mareys-schedule/data.tsv",(function(t,n){var r=null;if(!n)for(var a in t)/^stop\|/.test(a)&&(r=a.split("|"),e.push({distance:+r[2],key:a,name:r[1],zone:+r[3]}));return{direction:t.direction,number:t.number,stops:e.map((function(e){return{station:e,time:i(t[e.key])}})).filter((function(t){return null!==t.time})),type:t.type}}),(function(e,n){return t=n,_.each(t,(function(t,e){return t.index=e,_.each(t.stops,(function(t){t.train_index=e}))})),o.slider("values",[10,50])}))},i=function(t){var e=t.pageContext.demoInfo;return r.createElement(a.Z,{demoInfo:e,links:["/vendors/jquery-ui/themes/base/theme.css","/vendors/jquery-ui/themes/base/slider.css"],main:s,scripts:["/vendors/d3/d3.min.js","/vendors/jquery-ui/jquery-ui.min.js","/vendors/jquery-ui/ui/slider.js","/js/d3js-utils.js"]},r.createElement("div",null,r.createElement("div",{className:"slider"})),r.createElement("div",{className:"mareys-schedule-chart",id:"chart"}))}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-mareys-schedule-js-e11371ef444708a66ff4.js.map