{"version":3,"sources":["webpack://demos/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://demos/./src/demos/timeline/timeline.ts","webpack://demos/./src/pages/d3js/timeline.tsx"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","margin","height","parseDate","dateString","date","d3","format","year","isNaN","Number","replace","Date","setUTCFullYear","toYear","getUTCFullYear","toString","Math","abs","Timeline","rootElId","rootEl","document","getElementById","classList","add","outerWidth","getBoundingClientRect","width","bandY","bandNum","dataContent","components","bands","svg","text","append","attr","style","filterBlackOpacity","on","chart","data","timelineItems","today","tracks","items","compareAscending","item1","item2","result","start","end","compareDescending","forEach","item","getTime","instant","sortOrder","timeOrder","sort","track","i","_i","_ref","length","calculateTracks","nTracks","minDate","d","maxDate","xAxis","bandName","band","axis","xScale","tickSize","tickFormat","y","h","redraw","call","parts","push","createTooltip","$","tooltip","sizeFactor","id","x","w","trackOffset","trackHeight","min","itemHeight","instantWidth","domain","range","yScale","yearsScale","g","selectAll","enter","label","intervals","instants","addActions","actions","action","select","maxLetters","substr","part","labels","labelTop","labelDefs","_min","max","bandLabels","brush","targetNames","selectionScale","e","newDomain","selection","component","deviation","slope","filter","feMerge","ROOT_PATH","dataset","demoInfo","pageContext","links","main","scripts"],"mappings":"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","file":"component---src-pages-d-3-js-timeline-tsx-b45b0f4e5925a482ec40.js","sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import * as d3 from \"d3\"\n\nimport \"./timeline.styl\"\n\ntype DataItem = {\n  end: Date\n  instant: boolean\n  label: string\n  start: Date\n  track: number\n}\n\nconst fetchData = () =>\n  (d3.csv(`${ROOT_PATH}data/d3js/timeline/data.csv`) as unknown) as DataItem[]\n\nconst margin = {\n  bottom: 0,\n  left: 20,\n  right: 20,\n  top: 60,\n}\n\nconst outerHeight = 700\nconst height = outerHeight - margin.top - margin.bottom\nconst bandGap = 25\n\nconst parseDate = function (dateString: string) {\n  const format = d3.timeParse(\"%Y-%m-%d\")\n\n  let date = format(dateString)\n\n  if (date !== null) {\n    return date\n  }\n\n  const year = isNaN(Number(dateString))\n    ? -dateString.replace(/[^0-9]/g, \"\")\n    : +dateString\n\n  if (year < 0 || year > 99) {\n    date = new Date(year, 6, 1)\n  } else if (year === 0) {\n    date = new Date(-1, 6, 1)\n  } else {\n    date = new Date(year, 6, 1)\n    date.setUTCFullYear(year)\n  }\n\n  return date\n}\n\nconst toYear = (date: Date) => {\n  const bcString = \" BC\"\n  const year = date.getUTCFullYear()\n\n  if (year >= 0) {\n    return year.toString()\n  }\n\n  return bcString + Math.abs(year)\n}\n\nclass Timeline {\n  private chart: any\n  private bandY: number\n  private bandNum: number\n  private dataContent: any\n  private components: any\n  private bands: any\n  private width: number\n\n  public constructor({ rootElId }: { rootElId: string }) {\n    const rootEl = document.getElementById(rootElId) as HTMLElement\n\n    rootEl.classList.add(\"timeline-chart\")\n\n    const outerWidth = rootEl.getBoundingClientRect().width\n\n    this.width = outerWidth - margin.left - margin.right\n\n    this.bandY = 0\n    this.bandNum = 0\n\n    this.dataContent = {}\n    this.components = []\n    this.bands = {}\n\n    const svg = d3\n      .select(`#${rootElId}`)\n      .text(\"\")\n      .append(\"svg\")\n      .attr(\"height\", outerHeight + margin.top + margin.bottom)\n      .attr(\"width\", outerWidth + margin.left + margin.right)\n      .append(\"g\")\n      .attr(\"transform\", `translate(${margin.left},${margin.top})`)\n\n    svg\n      .append(\"text\")\n      .attr(\"class\", \"chart-title\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"transform\", `translate(${outerWidth / 2},-20)`)\n      .text(\"Philosophers through History\")\n      .style(\"font-weight\", \"bold\")\n\n    filterBlackOpacity(\"intervals\", svg, 1, 0.2)\n\n    svg\n      .append(\"clipPath\")\n      .attr(\"id\", \"chart-area\")\n      .append(\"rect\")\n      .attr(\"width\", this.width)\n      .attr(\"height\", height)\n\n    svg.on(\"mouseup\", () =>\n      d3\n        .selectAll(\".interval rect\")\n        .style(\"filter\", \"url(#drop-shadow-intervals)\")\n    )\n\n    this.chart = svg\n      .append(\"g\")\n      .attr(\"class\", \"chart\")\n      .attr(\"clip-path\", \"url(#chart-area)\")\n  }\n\n  public data(timelineItems: DataItem[]) {\n    const today = new Date()\n\n    const tracks: any = []\n    const yearMillis = 31622400000\n    const instantOffset = 100 * yearMillis\n\n    this.dataContent.items = timelineItems\n\n    const compareAscending = function (item1: any, item2: any) {\n      let result = item1.start - item2.start\n\n      if (result < 0) {\n        return -1\n      }\n\n      if (result > 0) {\n        return 1\n      }\n\n      result = item2.end - item1.end\n\n      if (result < 0) {\n        return -1\n      }\n\n      if (result > 0) {\n        return 1\n      }\n\n      return 0\n    }\n\n    const compareDescending = function (item1: any, item2: any) {\n      let result = item1.start - item2.start\n\n      if (result < 0) {\n        return 1\n      }\n\n      if (result > 0) {\n        return -1\n      }\n\n      result = item2.end - item1.end\n\n      if (result < 0) {\n        return 1\n      }\n\n      if (result > 0) {\n        return -1\n      }\n\n      return 0\n    }\n\n    const calculateTracks = (items: any, sortOrder: any, timeOrder: any) => {\n      sortOrder = sortOrder || \"descending\"\n      timeOrder = timeOrder || \"backward\"\n\n      const sortBackward = () =>\n        items.forEach((item: any) => {\n          let track = 0\n\n          for (\n            let i = 0, _i = 0, _ref = tracks.length;\n            0 <= _ref ? _i < _ref : _i > _ref;\n            i = 0 <= _ref ? ++_i : --_i\n          ) {\n            if (item.end < tracks[i]) {\n              break\n            }\n\n            track++\n          }\n\n          item.track = track\n\n          tracks[track] = item.start\n        })\n\n      const sortForward = function () {\n        return items.forEach((item: any) => {\n          let track = 0\n\n          for (\n            let i = 0, _i = 0, _ref = tracks.length;\n            0 <= _ref ? _i < _ref : _i > _ref;\n            i = 0 <= _ref ? ++_i : --_i\n          ) {\n            if (item.start > tracks[i]) {\n              break\n            }\n\n            track++\n          }\n\n          item.track = track\n\n          tracks[track] = item.end\n        })\n      }\n\n      if (sortOrder === \"ascending\") {\n        this.dataContent.items.sort(compareAscending)\n      } else {\n        this.dataContent.items.sort(compareDescending)\n      }\n\n      if (timeOrder === \"forward\") {\n        return sortForward()\n      }\n\n      return sortBackward()\n    }\n\n    this.dataContent.items.forEach((item: any) => {\n      item.start = parseDate(item.start)\n\n      if (item.end === \"\") {\n        item.end = new Date(item.start.getTime() + instantOffset)\n        item.instant = true\n      } else {\n        item.end = parseDate(item.end)\n        item.instant = false\n      }\n\n      if (item.end > today) {\n        item.end = today\n      }\n    })\n\n    calculateTracks(this.dataContent.items, \"descending\", \"backward\")\n\n    this.dataContent.nTracks = tracks.length\n    this.dataContent.minDate = d3.min(\n      this.dataContent.items,\n      (d: any) => d.start\n    )\n    this.dataContent.maxDate = d3.max(this.dataContent.items, (d: any) => d.end)\n\n    return this\n  }\n\n  public xAxis(bandName: any) {\n    const band = this.bands[bandName]\n\n    const axis = (d3 as any)\n      .axisBottom(band.xScale)\n      .tickSize(6, 0)\n      .tickFormat((d: any) => toYear(d))\n\n    const xAxis: any = this.chart\n      .append(\"g\")\n      .attr(\"class\", \"axis\")\n      .attr(\"transform\", `translate(0,${band.y + band.h})`)\n\n    xAxis.redraw = function () {\n      return xAxis.call(axis)\n    }\n\n    band.parts.push(xAxis)\n    this.components.push(xAxis)\n\n    return this\n  }\n\n  public createTooltip() {\n    $(\".part.instant, .part.interval\").tooltip({\n      track: true,\n    })\n\n    return this\n  }\n\n  public band(bandName: any, sizeFactor: any) {\n    const band: any = {}\n\n    band.id = `band${this.bandNum}`\n    band.x = 0\n    band.y = this.bandY\n    band.w = this.width\n    band.h = height * (sizeFactor || 1)\n    band.trackOffset = 0\n    band.trackHeight = Math.min(\n      (band.h - band.trackOffset) / this.dataContent.nTracks,\n      20\n    )\n    band.itemHeight = band.trackHeight * 0.7\n    band.parts = []\n    band.instantWidth = 100\n    band.xScale = d3\n      .scaleTime()\n      .domain([this.dataContent.minDate, this.dataContent.maxDate])\n      .range([0, band.w])\n\n    band.yScale = (track: any) => band.trackOffset + track * band.trackHeight\n\n    band.yearsScale =\n      this.dataContent.maxDate.getUTCFullYear() -\n      this.dataContent.minDate.getUTCFullYear()\n    band.g = this.chart\n      .append(\"g\")\n      .attr(\"id\", band.id)\n      .attr(\"transform\", `translate(0,${band.y})`)\n    band.g\n      .append(\"rect\")\n      .attr(\"class\", \"band\")\n      .attr(\"width\", band.w)\n      .attr(\"height\", band.h)\n\n    const items = band.g\n      .selectAll(\"g\")\n      .data(this.dataContent.items)\n      .enter()\n      .append(\"svg\")\n      .attr(\"y\", (d: DataItem) => band.yScale(d.track))\n      .attr(\"height\", band.itemHeight)\n      .attr(\"title\", (d: DataItem) => {\n        if (d.instant) {\n          return `${d.label}: ${toYear(d.start)}`\n        }\n\n        return `${d.label}: ${toYear(d.start)} - ${toYear(d.end)}`\n      })\n      .attr(\"class\", (d: DataItem) => {\n        if (d.instant) {\n          return \"part instant\"\n        }\n\n        return \"part interval\"\n      })\n\n    const intervals = d3.select(`#band${this.bandNum}`).selectAll(\".interval\")\n\n    intervals\n      .append(\"rect\")\n      .attr(\"height\", \"80%\")\n      .attr(\"width\", \"80%\")\n      .attr(\"x\", \"1px\")\n      .attr(\"y\", \".5px\")\n      .style(\"filter\", \"url(#drop-shadow-intervals)\")\n\n    intervals\n      .append(\"text\")\n      .attr(\"class\", \"intervalLabel\")\n      .attr(\"x\", 3)\n      .attr(\"y\", 9.5)\n\n    const instants = d3.select(`#band${this.bandNum}`).selectAll(\".instant\")\n\n    instants\n      .append(\"circle\")\n      .attr(\"cx\", band.itemHeight / 2)\n      .attr(\"cy\", band.itemHeight / 2)\n      .attr(\"r\", 5)\n    instants\n      .append(\"text\")\n      .attr(\"class\", \"instantLabel\")\n      .attr(\"x\", 15)\n      .attr(\"y\", 10)\n\n    band.addActions = function (actions: any) {\n      return actions.forEach((action: any) => items.on(action[0], action[1]))\n    }\n\n    band.redraw = function () {\n      items\n        .attr(\"x\", (d: any) => band.xScale(d.start))\n        .attr(\"width\", (d: any) => band.xScale(d.end) - band.xScale(d.start))\n        .select(\"text\")\n        .text((d: any) => {\n          const scale = band.xScale(d.end) - band.xScale(d.start)\n          const maxLetters = scale / 9\n\n          if (d.label.length > maxLetters) {\n            return `${d.label.substr(0, maxLetters - 1)}..`\n          }\n\n          return d.label\n        })\n\n      return band.parts.forEach((part: any) => part.redraw())\n    }\n\n    this.bands[bandName] = band\n    this.components.push(band)\n    this.bandY += band.h + bandGap\n    this.bandNum += 1\n\n    return this\n  }\n\n  public labels(bandName: any) {\n    const band = this.bands[bandName]\n    const labelWidth = 46\n    const labelHeight = 20\n    const labelTop = band.y + band.h - 10\n    const yText = 15\n    const labelDefs = [\n      [\n        \"start\",\n        \"bandMinMaxLabel\",\n        0,\n        4,\n        function (min: any) {\n          return toYear(min)\n        },\n        \"Start of the selected interval\",\n        band.x + 30,\n        labelTop,\n      ],\n      [\n        \"end\",\n        \"bandMinMaxLabel\",\n        band.w - labelWidth,\n        band.w - 4,\n        function (_min: any, max: any) {\n          return toYear(max)\n        },\n        \"End of the selected interval\",\n        band.x + band.w - 152,\n        labelTop,\n      ],\n      [\n        \"middle\",\n        \"bandMidLabel\",\n        (band.w - labelWidth) / 2,\n        band.w / 2,\n        function (min: any, max: any) {\n          const result = max.getUTCFullYear() - min.getUTCFullYear()\n\n          return result\n        },\n        \"Length of the selected interval\",\n        band.x + band.w / 2 - 75,\n        labelTop,\n      ],\n    ]\n    const bandLabels = this.chart\n      .append(\"g\")\n      .attr(\"id\", `${bandName}Labels`)\n      .attr(\"transform\", `translate(0,${band.y + band.h + 1})`)\n      .selectAll(`#${bandName}Labels`)\n      .data(labelDefs)\n      .enter()\n      .append(\"g\")\n\n    bandLabels\n      .append(\"rect\")\n      .attr(\"class\", \"bandLabel\")\n      .attr(\"x\", (d: any) => d[2])\n      .attr(\"width\", labelWidth)\n      .attr(\"height\", labelHeight)\n      .style(\"opacity\", 1)\n\n    const labels: any = bandLabels\n      .append(\"text\")\n      .attr(\"class\", (d: any) => d[1])\n      .attr(\"id\", (d: any) => d[0])\n      .attr(\"x\", (d: any) => d[3])\n      .attr(\"y\", yText)\n      .attr(\"text-anchor\", (d: any) => d[0])\n\n    labels.redraw = function () {\n      const min = band.xScale.domain()[0]\n      const max = band.xScale.domain()[1]\n\n      return labels.text((d: any) => d[4](min, max))\n    }\n\n    band.parts.push(labels)\n    this.components.push(labels)\n\n    return this\n  }\n\n  public brush(bandName: any, targetNames: any) {\n    const band = this.bands[bandName]\n    const brush = d3.brushX()\n\n    const selectionScale = d3\n      .scaleTime()\n      .domain([0, 1000])\n      .range([\n        this.dataContent.minDate.getTime(),\n        this.dataContent.maxDate.getTime(),\n      ])\n\n    brush.on(\"brush\", (e) => {\n      let newDomain = band.xScale.domain()\n\n      if (e.selection) {\n        newDomain = [\n          selectionScale(e.selection[0]),\n          selectionScale(e.selection[1]),\n        ]\n      }\n\n      d3.selectAll(\".interval rect\").style(\"filter\", \"none\")\n\n      targetNames.forEach((d: any) => {\n        this.bands[d].xScale.domain(newDomain)\n\n        this.bands[d].redraw()\n      })\n    })\n\n    const xBrush = band.g.append(\"svg\").attr(\"class\", \"x brush\").call(brush)\n\n    xBrush\n      .selectAll(\"rect\")\n      .attr(\"y\", 1)\n      .attr(\"height\", band.h - 1)\n\n    return this\n  }\n\n  public redraw() {\n    this.components.forEach((component: any) => component.redraw())\n\n    return this\n  }\n}\n\nconst filterBlackOpacity = (\n  id: string,\n  svg: d3.Selection<SVGGElement, unknown, HTMLElement, unknown>,\n  deviation: number,\n  slope: number\n) => {\n  const defs = svg.append(\"defs\")\n  const filter = defs\n    .append(\"filter\")\n    .attr(\"height\", \"500%\")\n    .attr(\"id\", `drop-shadow-${id}`)\n    .attr(\"width\", \"500%\")\n    .attr(\"x\", \"-200%\")\n    .attr(\"y\", \"-200%\")\n\n  filter\n    .append(\"feGaussianBlur\")\n    .attr(\"in\", \"SourceAlpha\")\n    .attr(\"stdDeviation\", deviation)\n\n  filter.append(\"feOffset\").attr(\"dx\", 1).attr(\"dy\", 1)\n  filter\n    .append(\"feComponentTransfer\")\n    .append(\"feFuncA\")\n    .attr(\"slope\", slope)\n    .attr(\"type\", \"linear\")\n\n  const feMerge = filter.append(\"feMerge\")\n\n  feMerge.append(\"feMergeNode\")\n\n  feMerge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\")\n}\n\nconst main = async () => {\n  const dataset = await fetchData()\n\n  new Timeline({ rootElId: \"chart\" })\n    .data(dataset)\n    .band(\"mainBand\", 0.82)\n    .band(\"naviBand\", 0.08)\n    .xAxis(\"mainBand\")\n    .xAxis(\"naviBand\")\n    .labels(\"mainBand\")\n    .labels(\"naviBand\")\n    .brush(\"naviBand\", [\"mainBand\"])\n    .redraw()\n    .createTooltip()\n}\n\nexport default main\n","import React from \"react\"\n\nimport { DemoPageProps } from \"@/common\"\n\nimport Demo from \"@/components/demo\"\n\n// @ts-ignore\nimport main from \"@/demos/timeline/timeline\"\n\nconst Timeline = ({ pageContext: { demoInfo } }: DemoPageProps) => (\n  <Demo\n    demoInfo={demoInfo}\n    links={[\"/vendors/jquery-ui/themes/base/jquery-ui.min.css\"]}\n    main={main}\n    scripts={[\"/vendors/jquery-ui/jquery-ui.min.js\"]}\n  >\n    <div id=\"chart\" />\n  </Demo>\n)\n\nexport default Timeline\n"],"sourceRoot":""}