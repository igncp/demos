(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[449],{8760:function(t,a,e){"use strict";e.r(a),e.d(a,{default:function(){return l}});var r=e(7294),n=e(7538),i=function(){d3.csv("/data/d3js/timeline/data.csv",(function(t){return function(){var t={bottom:0,left:20,right:20,top:60},a=$("#chart").innerWidth(),e=a-t.left-t.right,r=700-t.top-t.bottom,n=0,i=0,l={},s={},c=[],d={},u=d3utils.svg("#chart",a,700,t);d3utils.middleTitle(u,a,"Philosophers through History",-20),d3utils.filterBlackOpacity("intervals",u,1,.2),u.append("clipPath").attr("id","chart-area").append("rect").attr("width",e).attr("height",r),u.on("mouseup",(function(){return d3.selectAll(".interval rect").style({filter:"url(#drop-shadow-intervals)"})}));var o=u.append("g").attr("class","chart").attr("clip-path","url(#chart-area)"),f=function(t){var a=d3.time.format("%Y-%m-%d").parse(t);if(null!==a)return a;var e=null;return(e=isNaN(t)?-t.replace(/[^0-9]/g,""):+t)<0||e>99?a=new Date(e,6,1):0===e?a=new Date(-1,6,1):(a=new Date(e,6,1)).setUTCFullYear(("0000"+e).slice(-4)),a},h=function(t,a){a=a||" BC";var e=t.getUTCFullYear();return e>0?e.toString():"-"===a[0]?a+-e:-e+a};return l.data=function(t){var a=new Date,e=[];s.items=t;var r,n,i=function(t,a){var e=t.start-a.start;return e<0?-1:e>0?1:(e=a.end-t.end)<0?-1:e>0?1:0},c=function(t,a){var e=t.start-a.start;return e<0?1:e>0?-1:(e=a.end-t.end)<0?1:e>0?-1:0};return s.items.forEach((function(t){t.start=f(t.start),""===t.end?(t.end=new Date(t.start.getTime()+316224e7),t.instant=!0):(t.end=f(t.end),t.instant=!1),t.end>a&&(t.end=a)})),r=s.items,n=(n="backward")||"backward","ascending"===("descending"||"descending")?s.items.sort(i):s.items.sort(c),"forward"===n?r.forEach((function(t){for(var a=0,r=0,n=0,i=e.length;(0<=i?n<i:n>i)&&!(t.start>e[r]);r=0<=i?++n:--n)a++;t.track=a,e[a]=t.end})):r.forEach((function(t){for(var a=0,r=0,n=0,i=e.length;(0<=i?n<i:n>i)&&!(t.end<e[r]);r=0<=i?++n:--n)a++;t.track=a,e[a]=t.start})),s.nTracks=e.length,s.minDate=d3.min(s.items,(function(t){return t.start})),s.maxDate=d3.max(s.items,(function(t){return t.end})),l},l.tooltip={create:function(){return d3utils.tooltip(".part.instant, .part.interval",{followMouse:!0,leftOffst:80}),l}},l.band=function(t,a){var u={};u.id="band"+i,u.x=0,u.y=n,u.w=e,u.h=r*(a||1),u.trackOffset=0,u.trackHeight=Math.min((u.h-u.trackOffset)/s.nTracks,20),u.itemHeight=.7*u.trackHeight,u.parts=[],u.instantWidth=100,u.xScale=d3.time.scale().domain([s.minDate,s.maxDate]).range([0,u.w]),u.yScale=function(t){return u.trackOffset+t*u.trackHeight},u.yearsScale=s.maxDate.getUTCFullYear()-s.minDate.getUTCFullYear(),u.g=o.append("g").attr("id",u.id).attr("transform","translate(0,"+u.y+")"),u.g.append("rect").attr("class","band").attr("width",u.w).attr("height",u.h);var f=u.g.selectAll("g").data(s.items).enter().append("svg").attr("y",(function(t){return u.yScale(t.track)})).attr("height",u.itemHeight).attr("data-title",(function(t){return t.instant?t.label+": "+h(t.start):t.label+": "+h(t.start)+" - "+h(t.end)})).attr("class",(function(t){return t.instant?"part instant":"part interval"})),p=d3.select("#band"+i).selectAll(".interval");p.append("rect").attr({height:"80%",width:"80%",x:"1px",y:".5px"}).style({filter:"url(#drop-shadow-intervals)"}),p.append("text").attr("class","intervalLabel").attr("x",3).attr("y",9.5);var m=d3.select("#band"+i).selectAll(".instant");return m.append("circle").attr("cx",u.itemHeight/2).attr("cy",u.itemHeight/2).attr("r",5),m.append("text").attr("class","instantLabel").attr("x",15).attr("y",10),u.addActions=function(t){return t.forEach((function(t){return f.on(t[0],t[1])}))},u.redraw=function(){return f.attr("x",(function(t){return u.xScale(t.start)})).attr("width",(function(t){return u.xScale(t.end)-u.xScale(t.start)})).select("text").text((function(t){var a=(u.xScale(t.end)-u.xScale(t.start))/9;return t.label.length>a?t.label.substr(0,a-1)+"..":t.label})),u.parts.forEach((function(t){return t.redraw()}))},d[t]=u,c.push(u),n+=u.h+25,i+=1,l},l.labels=function(t){var a=d[t],e=a.y+a.h-10,r=[["start","bandMinMaxLabel",0,4,function(t){return h(t)},"Start of the selected interval",a.x+30,e],["end","bandMinMaxLabel",a.w-46,a.w-4,function(t,a){return h(a)},"End of the selected interval",a.x+a.w-152,e],["middle","bandMidLabel",(a.w-46)/2,a.w/2,function(t,a){return a.getUTCFullYear()-t.getUTCFullYear()},"Length of the selected interval",a.x+a.w/2-75,e]],n=o.append("g").attr("id",t+"Labels").attr("transform","translate(0,"+(a.y+a.h+1)+")").selectAll("#"+t+"Labels").data(r).enter().append("g");n.append("rect").attr("class","bandLabel").attr("x",(function(t){return t[2]})).attr("width",46).attr("height",20).style("opacity",1);var i=n.append("text").attr("class",(function(t){return t[1]})).attr("id",(function(t){return t[0]})).attr("x",(function(t){return t[3]})).attr("y",15).attr("text-anchor",(function(t){return t[0]}));return i.redraw=function(){var t=a.xScale.domain()[0],e=a.xScale.domain()[1];return i.text((function(a){return a[4](t,e)}))},a.parts.push(i),c.push(i),l},l.xAxis=function(t,a){var e=d[t],r=d3.svg.axis().scale(e.xScale).orient(a||"bottom").tickSize(6,0).tickFormat((function(t){return h(t)})),n=o.append("g").attr("class","axis").attr("transform","translate(0,"+(e.y+e.h)+")");return n.redraw=function(){return n.call(r)},e.parts.push(n),c.push(n),l},l.brush=function(t,a){var e=d[t],r=d3.svg.brush().x(e.xScale.range([0,e.w]));return r.on("brush",(function(){var t=r.empty()?e.xScale.domain():r.extent();d3.selectAll(".interval rect").style({filter:"none"}),a.forEach((function(a){d[a].xScale.domain(t),d[a].redraw()}))})),e.g.append("svg").attr("class","x brush").call(r).selectAll("rect").attr("y",1).attr("height",e.h-1),l},l.redraw=function(){return c.forEach((function(t){return t.redraw()}))},l}().data(t).band("mainBand",.82).band("naviBand",.08).xAxis("mainBand").xAxis("naviBand").labels("mainBand").labels("naviBand").brush("naviBand",["mainBand"]).tooltip.create().redraw()}))},l=function(t){var a=t.pageContext.demoInfo;return r.createElement(n.Z,{demoInfo:a,main:i,scripts:["/vendors/d3/d3.min.js","/js/d3js-utils.js"]},r.createElement("div",{className:"timeline-chart",id:"chart"}))}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-timeline-js-66cde10f82eb0414f0d0.js.map