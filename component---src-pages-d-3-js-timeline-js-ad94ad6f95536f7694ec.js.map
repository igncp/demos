{"version":3,"sources":["webpack://demos/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://demos/./src/demos/_utils/d3utils.js","webpack://demos/./src/demos/timeline/timeline.js","webpack://demos/./src/pages/d3js/timeline.js"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","d3utils","colorsScale","colors","extent","c","d3","scale","linear","domain","range","colorScale","length","p","filterBlackOpacity","id","svg","deviation","slope","filter","append","attr","height","width","x","y","in","stdDeviation","dx","dy","type","feMerge","filterColor","extra","result","in2","mode","middleTitle","text","top","class","transform","String","style","selector","margin","select","bottom","left","right","tooltip","customOpts","opts","merge","elementSelector","followElement","followMouse","leftOffst","tOpts","container","viewport","topOffst","$","hover","e","css","pageX","pageY","position","parseDate","dateString","date","time","format","parse","year","isNaN","replace","Date","setUTCFullYear","slice","toYear","bcString","getUTCFullYear","toString","renderChart","dataset","rootElId","outerWidth","document","getElementById","getBoundingClientRect","bandY","bandNum","timeline","data","components","bands","on","selectAll","chart","timelineItems","today","tracks","items","timeOrder","compareAscending","item1","item2","start","end","compareDescending","forEach","item","getTime","instant","sort","track","i","_i","_ref","nTracks","minDate","d3next","d","maxDate","create","band","bandName","sizeFactor","w","h","trackOffset","trackHeight","Math","min","itemHeight","parts","instantWidth","xScale","yScale","yearsScale","g","enter","label","intervals","instants","addActions","actions","action","redraw","maxLetters","substr","part","push","labels","labelTop","labelDefs","_min","max","bandLabels","xAxis","orientation","axis","orient","tickSize","tickFormat","call","brush","targetNames","empty","component","createTimeline","csv","ROOT_PATH","demoInfo","pageContext","main","scripts","className"],"mappings":"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","file":"component---src-pages-d-3-js-timeline-js-ad94ad6f95536f7694ec.js","sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import merge from \"lodash/merge\"\n\nconst d3utils = {\n  colorsScale(colors, extent) {\n    const c = d3.scale.linear().domain(extent).range([0, 1])\n    const colorScale = d3.scale\n      .linear()\n      .domain(d3.range(0, 1, 1.0 / colors.length))\n      .range(colors)\n\n    return function (p) {\n      return colorScale(c(p))\n    }\n  },\n  filterBlackOpacity(id, svg, deviation, slope) {\n    const defs = svg.append(\"defs\")\n    const filter = defs.append(\"filter\").attr({\n      height: \"500%\",\n      id: `drop-shadow-${id}`,\n      width: \"500%\",\n      x: \"-200%\",\n      y: \"-200%\",\n    })\n\n    filter.append(\"feGaussianBlur\").attr({\n      in: \"SourceAlpha\",\n      stdDeviation: deviation,\n    })\n    filter.append(\"feOffset\").attr({\n      dx: 1,\n      dy: 1,\n    })\n    filter.append(\"feComponentTransfer\").append(\"feFuncA\").attr({\n      slope,\n      type: \"linear\",\n    })\n\n    const feMerge = filter.append(\"feMerge\")\n\n    feMerge.append(\"feMergeNode\")\n\n    return feMerge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\")\n  },\n  filterColor(id, svg, deviation, slope, extra) {\n    if (extra == null) {\n      extra = false\n    }\n\n    const defs = svg.append(\"defs\")\n    const filter = defs.append(\"filter\").attr({\n      id: `drop-shadow-${id}`,\n    })\n\n    if (extra) {\n      filter.attr({\n        height: \"500%\",\n        width: \"500%\",\n        x: \"-200%\",\n        y: \"-200%\",\n      })\n    }\n\n    filter.append(\"feOffset\").attr({\n      dx: 0.5,\n      dy: 0.5,\n      in: \"SourceGraphic\",\n      result: \"offOut\",\n    })\n    filter.append(\"feGaussianBlur\").attr({\n      in: \"offOut\",\n      result: \"blurOut\",\n      stdDeviation: deviation,\n    })\n    filter.append(\"feBlend\").attr({\n      in: \"SourceGraphic\",\n      in2: \"blurOut\",\n      mode: \"normal\",\n    })\n\n    return filter.append(\"feComponentTransfer\").append(\"feFuncA\").attr({\n      slope,\n      type: \"linear\",\n    })\n  },\n  middleTitle(svg, width, text, top) {\n    if (top == null) {\n      top = -15\n    }\n\n    svg\n      .append(\"text\")\n      .attr({\n        class: \"chart-title\",\n        \"text-anchor\": \"middle\",\n        transform: `translate(${String(width / 2)},${top})`,\n      })\n      .text(text)\n      .style(\"font-weight\", \"bold\")\n  },\n  svg(selector, width, height, margin) {\n    return d3\n      .select(selector)\n      .text(\"\")\n      .append(\"svg\")\n      .attr({\n        height: height + margin.top + margin.bottom,\n        width: width + margin.left + margin.right,\n      })\n      .append(\"g\")\n      .attr({\n        transform: `translate(${margin.left},${margin.top})`,\n      })\n  },\n  tooltip(selector, customOpts) {\n    if (customOpts == null) {\n      customOpts = {}\n    }\n\n    const defaultOpts = {\n      elementSelector: \"\",\n      followElement: false,\n      followMouse: false,\n      leftOffst: 60,\n      tOpts: {\n        container: \"body\",\n        viewport: {\n          selector: \"#chart svg\",\n        },\n      },\n      topOffst: 40,\n    }\n\n    const opts = merge(defaultOpts, customOpts)\n\n    $(selector).tooltip(opts.tOpts)\n\n    if (opts.followMouse) {\n      $(selector).hover((e) =>\n        $(\".tooltip\").css({\n          left: `${String(e.pageX - opts.leftOffst)}px`,\n          top: `${String(e.pageY - opts.topOffst)}px`,\n        })\n      )\n    } else if (opts.followElement) {\n      $(selector).hover(() =>\n        $(\".tooltip\").css({\n          left: `${String(\n            $(opts.elementSelector).position().left - opts.leftOffst\n          )}px`,\n          top: `${String(\n            $(opts.elementSelector).position().top - opts.topOffst\n          )}px`,\n        })\n      )\n    }\n  },\n}\n\nexport default d3utils\n","import * as d3next from \"d3\"\nimport d3utils from \"@/demos/_utils/d3utils\"\n\nconst fetchData = () =>\n  new Promise((resolve) => {\n    d3.csv(`${ROOT_PATH}data/d3js/timeline/data.csv`, (dataset) =>\n      resolve(dataset)\n    )\n  })\n\nconst margin = {\n  bottom: 0,\n  left: 20,\n  right: 20,\n  top: 60,\n}\n\nconst outerHeight = 700\nconst height = outerHeight - margin.top - margin.bottom\nconst bandGap = 25\n\nconst parseDate = function (dateString) {\n  const format = d3.time.format(\"%Y-%m-%d\")\n\n  let date = format.parse(dateString)\n\n  if (date !== null) {\n    return date\n  }\n\n  const year = isNaN(dateString)\n    ? -dateString.replace(/[^0-9]/g, \"\")\n    : +dateString\n\n  if (year < 0 || year > 99) {\n    date = new Date(year, 6, 1)\n  } else if (year === 0) {\n    date = new Date(-1, 6, 1)\n  } else {\n    date = new Date(year, 6, 1)\n    date.setUTCFullYear(`0000${year}`.slice(-4))\n  }\n\n  return date\n}\n\nconst toYear = function (date, bcString) {\n  bcString = bcString || \" BC\"\n\n  const year = date.getUTCFullYear()\n\n  if (year > 0) {\n    return year.toString()\n  }\n\n  if (bcString[0] === \"-\") {\n    return bcString - year\n  }\n\n  return bcString - year\n}\n\nconst createTimeline = function ({ rootElId }) {\n  const outerWidth = document.getElementById(rootElId).getBoundingClientRect()\n    .width\n  const width = outerWidth - margin.left - margin.right\n\n  let bandY = 0\n  let bandNum = 0\n\n  const timeline = {}\n  const data = {}\n  const components = []\n  const bands = {}\n\n  const svg = d3utils.svg(`#${rootElId}`, outerWidth, outerHeight, margin)\n\n  d3utils.middleTitle(svg, outerWidth, \"Philosophers through History\", -20)\n  d3utils.filterBlackOpacity(\"intervals\", svg, 1, 0.2)\n\n  svg\n    .append(\"clipPath\")\n    .attr(\"id\", \"chart-area\")\n    .append(\"rect\")\n    .attr(\"width\", width)\n    .attr(\"height\", height)\n\n  svg.on(\"mouseup\", () =>\n    d3\n      .selectAll(\".interval rect\")\n      .style(\"filter\", \"url(#drop-shadow-intervals)\")\n  )\n\n  const chart = svg\n    .append(\"g\")\n    .attr(\"class\", \"chart\")\n    .attr(\"clip-path\", \"url(#chart-area)\")\n\n  timeline.data = function (timelineItems) {\n    const today = new Date()\n\n    const tracks = []\n    const yearMillis = 31622400000\n    const instantOffset = 100 * yearMillis\n\n    data.items = timelineItems\n\n    const compareAscending = function (item1, item2) {\n      let result = item1.start - item2.start\n\n      if (result < 0) {\n        return -1\n      }\n\n      if (result > 0) {\n        return 1\n      }\n\n      result = item2.end - item1.end\n\n      if (result < 0) {\n        return -1\n      }\n\n      if (result > 0) {\n        return 1\n      }\n\n      return 0\n    }\n\n    const compareDescending = function (item1, item2) {\n      let result = item1.start - item2.start\n\n      if (result < 0) {\n        return 1\n      }\n\n      if (result > 0) {\n        return -1\n      }\n\n      result = item2.end - item1.end\n\n      if (result < 0) {\n        return 1\n      }\n\n      if (result > 0) {\n        return -1\n      }\n\n      return 0\n    }\n\n    const calculateTracks = function (items, sortOrder, timeOrder) {\n      sortOrder = sortOrder || \"descending\"\n      timeOrder = timeOrder || \"backward\"\n\n      const sortBackward = function () {\n        return items.forEach((item) => {\n          let track = 0\n\n          for (\n            let i = 0, _i = 0, _ref = tracks.length;\n            0 <= _ref ? _i < _ref : _i > _ref;\n            i = 0 <= _ref ? ++_i : --_i\n          ) {\n            if (item.end < tracks[i]) {\n              break\n            }\n\n            track++\n          }\n\n          item.track = track\n\n          tracks[track] = item.start\n        })\n      }\n\n      const sortForward = function () {\n        return items.forEach((item) => {\n          let track = 0\n\n          for (\n            let i = 0, _i = 0, _ref = tracks.length;\n            0 <= _ref ? _i < _ref : _i > _ref;\n            i = 0 <= _ref ? ++_i : --_i\n          ) {\n            if (item.start > tracks[i]) {\n              break\n            }\n\n            track++\n          }\n\n          item.track = track\n\n          tracks[track] = item.end\n        })\n      }\n\n      if (sortOrder === \"ascending\") {\n        data.items.sort(compareAscending)\n      } else {\n        data.items.sort(compareDescending)\n      }\n\n      if (timeOrder === \"forward\") {\n        return sortForward()\n      }\n\n      return sortBackward()\n    }\n\n    data.items.forEach((item) => {\n      item.start = parseDate(item.start)\n\n      if (item.end === \"\") {\n        item.end = new Date(item.start.getTime() + instantOffset)\n        item.instant = true\n      } else {\n        item.end = parseDate(item.end)\n        item.instant = false\n      }\n\n      if (item.end > today) {\n        item.end = today\n      }\n    })\n\n    calculateTracks(data.items, \"descending\", \"backward\")\n\n    data.nTracks = tracks.length\n    data.minDate = d3next.min(data.items, (d) => d.start)\n    data.maxDate = d3next.max(data.items, (d) => d.end)\n\n    return timeline\n  }\n\n  timeline.tooltip = {\n    create() {\n      d3utils.tooltip(\".part.instant, .part.interval\", {\n        followMouse: true,\n        leftOffst: 80,\n      })\n\n      return timeline\n    },\n  }\n\n  timeline.band = function (bandName, sizeFactor) {\n    const band = {}\n\n    band.id = `band${bandNum}`\n    band.x = 0\n    band.y = bandY\n    band.w = width\n    band.h = height * (sizeFactor || 1)\n    band.trackOffset = 0\n    band.trackHeight = Math.min((band.h - band.trackOffset) / data.nTracks, 20)\n    band.itemHeight = band.trackHeight * 0.7\n    band.parts = []\n    band.instantWidth = 100\n    band.xScale = d3.time\n      .scale()\n      .domain([data.minDate, data.maxDate])\n      .range([0, band.w])\n\n    band.yScale = function (track) {\n      return band.trackOffset + track * band.trackHeight\n    }\n\n    band.yearsScale =\n      data.maxDate.getUTCFullYear() - data.minDate.getUTCFullYear()\n    band.g = chart\n      .append(\"g\")\n      .attr(\"id\", band.id)\n      .attr(\"transform\", `translate(0,${band.y})`)\n    band.g\n      .append(\"rect\")\n      .attr(\"class\", \"band\")\n      .attr(\"width\", band.w)\n      .attr(\"height\", band.h)\n\n    const items = band.g\n      .selectAll(\"g\")\n      .data(data.items)\n      .enter()\n      .append(\"svg\")\n      .attr(\"y\", (d) => band.yScale(d.track))\n      .attr(\"height\", band.itemHeight)\n      .attr(\"data-title\", (d) => {\n        if (d.instant) {\n          return `${d.label}: ${toYear(d.start)}`\n        }\n\n        return `${d.label}: ${toYear(d.start)} - ${toYear(d.end)}`\n      })\n      .attr(\"class\", (d) => {\n        if (d.instant) {\n          return \"part instant\"\n        }\n\n        return \"part interval\"\n      })\n\n    const intervals = d3.select(`#band${bandNum}`).selectAll(\".interval\")\n\n    intervals\n      .append(\"rect\")\n      .attr(\"height\", \"80%\")\n      .attr(\"width\", \"80%\")\n      .attr(\"x\", \"1px\")\n      .attr(\"y\", \".5px\")\n      .style(\"filter\", \"url(#drop-shadow-intervals)\")\n\n    intervals\n      .append(\"text\")\n      .attr(\"class\", \"intervalLabel\")\n      .attr(\"x\", 3)\n      .attr(\"y\", 9.5)\n\n    const instants = d3.select(`#band${bandNum}`).selectAll(\".instant\")\n\n    instants\n      .append(\"circle\")\n      .attr(\"cx\", band.itemHeight / 2)\n      .attr(\"cy\", band.itemHeight / 2)\n      .attr(\"r\", 5)\n    instants\n      .append(\"text\")\n      .attr(\"class\", \"instantLabel\")\n      .attr(\"x\", 15)\n      .attr(\"y\", 10)\n\n    band.addActions = function (actions) {\n      return actions.forEach((action) => items.on(action[0], action[1]))\n    }\n\n    band.redraw = function () {\n      items\n        .attr(\"x\", (d) => band.xScale(d.start))\n        .attr(\"width\", (d) => band.xScale(d.end) - band.xScale(d.start))\n        .select(\"text\")\n        .text((d) => {\n          const scale = band.xScale(d.end) - band.xScale(d.start)\n          const maxLetters = scale / 9\n\n          if (d.label.length > maxLetters) {\n            return `${d.label.substr(0, maxLetters - 1)}..`\n          }\n\n          return d.label\n        })\n\n      return band.parts.forEach((part) => part.redraw())\n    }\n\n    bands[bandName] = band\n    components.push(band)\n    bandY += band.h + bandGap\n    bandNum += 1\n\n    return timeline\n  }\n\n  timeline.labels = function (bandName) {\n    const band = bands[bandName]\n    const labelWidth = 46\n    const labelHeight = 20\n    const labelTop = band.y + band.h - 10\n    const yText = 15\n    const labelDefs = [\n      [\n        \"start\",\n        \"bandMinMaxLabel\",\n        0,\n        4,\n        function (min) {\n          return toYear(min)\n        },\n        \"Start of the selected interval\",\n        band.x + 30,\n        labelTop,\n      ],\n      [\n        \"end\",\n        \"bandMinMaxLabel\",\n        band.w - labelWidth,\n        band.w - 4,\n        function (_min, max) {\n          return toYear(max)\n        },\n        \"End of the selected interval\",\n        band.x + band.w - 152,\n        labelTop,\n      ],\n      [\n        \"middle\",\n        \"bandMidLabel\",\n        (band.w - labelWidth) / 2,\n        band.w / 2,\n        function (min, max) {\n          return max.getUTCFullYear() - min.getUTCFullYear()\n        },\n        \"Length of the selected interval\",\n        band.x + band.w / 2 - 75,\n        labelTop,\n      ],\n    ]\n    const bandLabels = chart\n      .append(\"g\")\n      .attr(\"id\", `${bandName}Labels`)\n      .attr(\"transform\", `translate(0,${band.y + band.h + 1})`)\n      .selectAll(`#${bandName}Labels`)\n      .data(labelDefs)\n      .enter()\n      .append(\"g\")\n\n    bandLabels\n      .append(\"rect\")\n      .attr(\"class\", \"bandLabel\")\n      .attr(\"x\", (d) => d[2])\n      .attr(\"width\", labelWidth)\n      .attr(\"height\", labelHeight)\n      .style(\"opacity\", 1)\n\n    const labels = bandLabels\n      .append(\"text\")\n      .attr(\"class\", (d) => d[1])\n      .attr(\"id\", (d) => d[0])\n      .attr(\"x\", (d) => d[3])\n      .attr(\"y\", yText)\n      .attr(\"text-anchor\", (d) => d[0])\n\n    labels.redraw = function () {\n      const min = band.xScale.domain()[0]\n      const max = band.xScale.domain()[1]\n\n      return labels.text((d) => d[4](min, max))\n    }\n\n    band.parts.push(labels)\n    components.push(labels)\n\n    return timeline\n  }\n\n  timeline.xAxis = function (bandName, orientation) {\n    const band = bands[bandName]\n    const axis = d3.svg\n      .axis()\n      .scale(band.xScale)\n      .orient(orientation || \"bottom\")\n      .tickSize(6, 0)\n      .tickFormat((d) => toYear(d))\n    const xAxis = chart\n      .append(\"g\")\n      .attr(\"class\", \"axis\")\n      .attr(\"transform\", `translate(0,${band.y + band.h})`)\n\n    xAxis.redraw = function () {\n      return xAxis.call(axis)\n    }\n\n    band.parts.push(xAxis)\n    components.push(xAxis)\n\n    return timeline\n  }\n\n  timeline.brush = function (bandName, targetNames) {\n    const band = bands[bandName]\n    const brush = d3.svg.brush().x(band.xScale.range([0, band.w]))\n\n    brush.on(\"brush\", () => {\n      const domain = brush.empty() ? band.xScale.domain() : brush.extent()\n\n      d3.selectAll(\".interval rect\").style(\"filter\", \"none\")\n\n      targetNames.forEach((d) => {\n        bands[d].xScale.domain(domain)\n\n        bands[d].redraw()\n      })\n    })\n\n    const xBrush = band.g.append(\"svg\").attr(\"class\", \"x brush\").call(brush)\n\n    xBrush\n      .selectAll(\"rect\")\n      .attr(\"y\", 1)\n      .attr(\"height\", band.h - 1)\n\n    return timeline\n  }\n\n  timeline.redraw = function () {\n    return components.forEach((component) => component.redraw())\n  }\n\n  return timeline\n}\n\nconst renderChart = ({ dataset, rootElId }) => {\n  createTimeline({ rootElId })\n    .data(dataset)\n    .band(\"mainBand\", 0.82)\n    .band(\"naviBand\", 0.08)\n    .xAxis(\"mainBand\")\n    .xAxis(\"naviBand\")\n    .labels(\"mainBand\")\n    .labels(\"naviBand\")\n    .brush(\"naviBand\", [\"mainBand\"])\n    .tooltip[\"create\"]()\n    .redraw()\n}\n\nconst main = async () => {\n  const dataset = await fetchData()\n\n  renderChart({\n    dataset,\n    rootElId: \"chart\",\n  })\n}\n\nexport default main\n","import React from \"react\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/timeline/timeline\"\n\nimport \"@/demos/timeline/timeline.styl\"\n\nconst Timeline = ({ pageContext: { demoInfo } }) => (\n  <Demo demoInfo={demoInfo} main={main} scripts={[\"/vendors/d3/d3.min.js\"]}>\n    <div className=\"timeline-chart\" id=\"chart\" />\n  </Demo>\n)\n\nexport default Timeline\n"],"sourceRoot":""}