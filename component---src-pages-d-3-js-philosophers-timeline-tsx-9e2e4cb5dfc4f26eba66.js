(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[230],{9023:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return M}});var r,n,i=a(7294),s=a(4275),c=a(2137),d=a(7757),o=a.n(d),h=a(7723),l=a(2203),u="timeline-bands-brush-chart-module--bandMinMaxLabel--9b1ie",f="timeline-bands-brush-chart-module--interval--2eQUh",m="timeline-bands-brush-chart-module--instant--2L0wB";!function(t){t.Ascending="ascending",t.Descending="descending"}(r||(r={})),function(t){t.Backward="backward",t.Forward="forward"}(n||(n={}));var p,g=0,b=20,v=20,x=60,w=700-x-g,C=function(t){var e=t.getUTCFullYear();return e>=0?e.toString():" BC"+Math.abs(e)},y=function(){function t(t){this.chartConfig=t;var e=document.getElementById(t.rootElId);e.classList.add("timeline-bands-brush-chart-module--timelineChart--1QNFT");var a=e.getBoundingClientRect().width;this.width=a-b-v,this.bandY=0,this.bandNum=0,this.dataContent={},this.components=[],this.bands={};var r=(0,h.Ys)("#"+t.rootElId).text("").append("svg").attr("height",700+x+g).attr("width",a+b+v).append("g").attr("transform","translate("+b+","+x+")");r.append("text").attr("class","chart-title").attr("text-anchor","middle").attr("transform","translate("+a/2+",-20)").text(t.chartTitle).style("font-weight","bold"),function(t){var e=t.deviation,a=t.id,r=t.slope,n=t.svg.append("defs").append("filter").attr("height","500%").attr("id","drop-shadow-"+a).attr("width","500%").attr("x","-200%").attr("y","-200%");n.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",e),n.append("feOffset").attr("dx",1).attr("dy",1),n.append("feComponentTransfer").append("feFuncA").attr("slope",r).attr("type","linear");var i=n.append("feMerge");i.append("feMergeNode"),i.append("feMergeNode").attr("in","SourceGraphic")}({deviation:1,id:"intervals",slope:.2,svg:r}),r.append("clipPath").attr("id","chart-area").append("rect").attr("width",this.width).attr("height",w),r.on("mouseup",(function(){return(0,h.td_)("."+f+" rect").style("filter","url(#drop-shadow-intervals)")})),this.chart=r.append("g").attr("class","timeline-bands-brush-chart-module--chart--1fxHv").attr("clip-path","url(#chart-area)")}var e=t.prototype;return e.addChartData=function(t){var e=this,a=[];this.dataContent.chartItems=t;var i,s,c,d,o,l,u;return i={chartItems:this.dataContent.chartItems,sortOrderInitial:r.Descending,timeOrderInitial:n.Backward},s=i.chartItems,c=i.sortOrderInitial,d=i.timeOrderInitial,o=null!=c?c:r.Descending,l=null!=d?d:n.Forward,u=e.chartConfig.getSortFn(o),e.dataContent.chartItems.sort(u),l!==n.Forward?s.forEach((function(t){var r=0;for(r=0;r<a.length&&!(e.chartConfig.getItemLimitRight(t)<a[r]);r+=1);t.track=r,a[r]=e.chartConfig.getItemLimitLeft(t)})):s.forEach((function(t){var r=0;for(r=0;r<a.length&&!(e.chartConfig.getItemLimitLeft(t)>a[r]);r+=1);t.track=r,a[r]=e.chartConfig.getItemLimitRight(t)})),this.dataContent.nTracks=a.length,this.dataContent.minDate=(0,h.VV$)(this.dataContent.chartItems,this.chartConfig.getItemLimitLeft),this.dataContent.maxDate=new Date,this},e.xAxis=function(t){var e=this.bands[t],a=(0,h.LLu)(e.xScale).tickSize(6).tickFormat((function(t){return C(t)})),r=this.chart.append("g").attr("class","timeline-bands-brush-chart-module--axis--eEXbX").attr("transform","translate(0,"+(e.y+e.h)+")");return r.redraw=function(){r.call(a)},e.parts.push(r),this.components.push(r),this},e.createTooltip=function(){return $(".part."+m+", .part."+f).tooltip({track:!0}),this},e.addBand=function(t){var e=this,a=t.bandName,r=t.sizeFactor,n={};n.id="band"+this.bandNum,n.x=0,n.y=this.bandY,n.w=this.width,n.h=w*(r||1),n.trackOffset=0,n.trackHeight=Math.min((n.h-n.trackOffset)/this.dataContent.nTracks,20),n.itemHeight=.7*n.trackHeight,n.parts=[],n.instantWidth=100,n.xScale=(0,h.Xf)().domain([this.dataContent.minDate,this.dataContent.maxDate]).range([0,n.w]),n.yScale=function(t){return n.trackOffset+t*n.trackHeight},n.g=this.chart.append("g").attr("id",n.id).attr("transform","translate(0,"+n.y+")"),n.g.append("rect").attr("class","timeline-bands-brush-chart-module--band--kNhNr").attr("width",n.w).attr("height",n.h);var i=n.g.selectAll("g").data(this.dataContent.chartItems).enter().append("svg").attr("y",(function(t){return n.yScale(t.track)})).attr("height",n.itemHeight).attr("title",this.chartConfig.getItemTitle).attr("class",(function(t){return"part "+(t.instant?m:f)})),s=(0,h.Ys)("#band"+this.bandNum).selectAll("."+f),c=(0,h.Ys)("#band"+this.bandNum).selectAll("."+m);s.append("rect").attr("height","100%").attr("width","100%").attr("x","1px").attr("y",".5px").style("filter","url(#drop-shadow-intervals)"),s.append("text").attr("class","timeline-bands-brush-chart-module--intervalLabel--2bkN7").attr("x",3).attr("y",9.5),c.append("circle").attr("cx",n.itemHeight/2).attr("cy",n.itemHeight/2).attr("r",5),c.append("text").attr("class","timeline-bands-brush-chart-module--instantLabel--1mTHv").attr("x",15).attr("y",10),[s,c].forEach((function(t){t.on("click",(function(){for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];var n=a[1];return e.chartConfig.onChartItemClick(n)})),t.style("cursor","pointer")}));var d=this.chartConfig,o=d.getItemLimitLeft,l=d.getItemLimitRight;return n.redraw=function(){i.attr("x",(function(t){return n.xScale(o(t))})).attr("width",(function(t){return n.xScale(l(t))-n.xScale(o(t))})).select("text").text((function(t){var a=(n.xScale(l(t))-n.xScale(o(t)))/9;return e.chartConfig.getItemText({chartItem:t,maxLetters:a})})),n.parts.forEach((function(t){return t.redraw()}))},this.bands[a]=n,this.components.push(n),this.bandY+=n.h+25,this.bandNum+=1,this},e.labels=function(t){var e=this.bands[t],a=e.y+e.h-10,r=[{className:u,getText:function(t){return C(t)},id:"Start of the selected interval",left:0,textAnchor:"start",textLeft:4,top:a},{className:u,getText:function(){for(var t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];var r=e[1];return C(r)},id:"End of the selected interval",left:e.w-46,textAnchor:"end",textLeft:e.w-4,top:a},{className:"timeline-bands-brush-chart-module--bandMidLabel--1FVWM",getText:function(){for(var t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];var r=e[0],n=e[1];return(n.getUTCFullYear()-r.getUTCFullYear()).toString()},id:"Length of the selected interval",left:(e.w-46)/2,textAnchor:"middle",textLeft:e.w/2,top:a}],n=this.chart.append("g").attr("id",t+"Labels").attr("transform","translate(0,"+(e.y+e.h+1)+")").selectAll("#"+t+"Labels").data(r).enter().append("g");n.append("rect").attr("class","timeline-bands-brush-chart-module--bandLabel--3R8M5").attr("x",(function(t){return t.left})).attr("width",46).attr("height",20).style("opacity",1);var i=n.append("text").attr("class",(function(t){return t.className})).attr("id",(function(t){return t.id})).attr("x",(function(t){return t.textLeft})).attr("y",15).attr("text-anchor",(function(t){return t.textAnchor}));return i.redraw=function(){var t=e.xScale.domain()[0],a=e.xScale.domain()[1];i.text((function(e){return e.getText(t,a)}))},e.parts.push(i),this.components.push(i),this},e.addBrush=function(t){var e=this,a=t.brushBandName,r=t.targetBandName,n=this.bands[a],i=(0,h.Yud)(),s=this.dataContent,c=s.maxDate,d=[s.minDate.getTime(),c.getTime()],o=(0,h.Xf)().domain([0,this.width]).range(d);return i.on("brush",(function(t){var a=n.xScale.domain();if(t.selection){var i=t.selection,s=i[0],c=i[1];a=[o(Math.max(0,s)),o(Math.min(e.width,c))]}(0,h.td_)("."+f+" rect").style("filter","none"),e.bands[r].xScale.domain(a),e.bands[r].redraw()})),n.g.append("svg").attr("class","x").call(i).selectAll("rect").attr("y",1).attr("height",n.h-1),this},e.redraw=function(){return this.components.forEach((function(t){return t.redraw()})),this},t}(),N=function(t){var e=t.getUTCFullYear();return e>=0?e.toString():" BC"+Math.abs(e)},I=function(t){var e=(0,h.Z1g)("%Y-%m-%d")(t);if(null!==e)return e;var a=isNaN(Number(t))?-t.replace(/[^0-9]/g,""):+t;return a<0||a>99?e=new Date(a,6,1):0===a?e=new Date(-1,6,1):(e=new Date(a,6,1)).setUTCFullYear(a),e},L=function(){var t=(0,c.Z)(o().mark((function t(){var e,a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,h.gyn)("/demos/data/d3js/philosophers-timeline/data.csv");case 2:return e=t.sent,a=new Date,316224e7,e.forEach((function(t){t.start=I(t.start.toString()),""===t.end?(t.end=new Date(t.start.getTime()+316224e7),t.instant=!0):(t.end=I(t.end.toString()),t.instant=!1),t.end>a&&(t.end=a)})),t.abrupt("return",e);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),k=function(t){return t.start},T=function(t){return t.end},S=function(t){return function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];var i=a[0],s=a[1],c=t===r.Ascending?1:-1,d=Number(i.start)-Number(s.start);return 0!==d?d*c:(Number(s.end)-Number(i.end))*c}},A=function(t){var e=t.chartItem,a=t.maxLetters;return e.label.length>a?e.label.substr(0,a-1)+"..":e.label},B=function(t){return t.instant?t.label+": "+N(t.start):t.label+": "+N(t.start)+" - "+N(t.end)},D=function(t){var e=t.instant?t.label:("Philosopher "+t.label+" "+(t.end?t.end.getFullYear():"")).trim();window.open("https://www.google.com/search?"+l.stringify({q:e}))};!function(t){t.Main="mainBand",t.Navi="naviBand"}(p||(p={}));var F=function(){var t=(0,c.Z)(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L();case 2:e=t.sent,new y({chartTitle:"Philosophers through History",getItemLimitLeft:k,getItemLimitRight:T,getItemText:A,getItemTitle:B,getSortFn:S,onChartItemClick:D,rootElId:"chart"}).addChartData(e).addBand({bandName:p.Main,sizeFactor:.82}).addBand({bandName:p.Navi,sizeFactor:.08}).xAxis(p.Main).xAxis(p.Navi).labels(p.Main).labels(p.Navi).addBrush({brushBandName:p.Navi,targetBandName:p.Main}).redraw().createTooltip();case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),M=function(t){var e=t.pageContext;return i.createElement(s.Z,{links:["/vendors/jquery-ui/themes/base/jquery-ui.min.css"],main:F,pageContext:e,scripts:["/vendors/jquery-ui/jquery-ui.min.js"]},i.createElement("div",{id:"chart"}))}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-philosophers-timeline-tsx-9e2e4cb5dfc4f26eba66.js.map