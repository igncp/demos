"use strict";(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[189],{9646:function(t,e,r){var n;r.d(e,{Z:function(){return h}});var a=new Uint8Array(16);function o(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(a)}var i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var u=function(t){return"string"==typeof t&&i.test(t)},c=[],s=0;s<256;++s)c.push((s+256).toString(16).substr(1));var l,d,f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(c[t[e+0]]+c[t[e+1]]+c[t[e+2]]+c[t[e+3]]+"-"+c[t[e+4]]+c[t[e+5]]+"-"+c[t[e+6]]+c[t[e+7]]+"-"+c[t[e+8]]+c[t[e+9]]+"-"+c[t[e+10]]+c[t[e+11]]+c[t[e+12]]+c[t[e+13]]+c[t[e+14]]+c[t[e+15]]).toLowerCase();if(!u(r))throw TypeError("Stringified UUID is invalid");return r},p=0,m=0;var h=function(t,e,r){var n=e&&r||0,a=e||new Array(16),i=(t=t||{}).node||l,u=void 0!==t.clockseq?t.clockseq:d;if(null==i||null==u){var c=t.random||(t.rng||o)();null==i&&(i=l=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==u&&(u=d=16383&(c[6]<<8|c[7]))}var s=void 0!==t.msecs?t.msecs:Date.now(),h=void 0!==t.nsecs?t.nsecs:m+1,g=s-p+(h-m)/1e4;if(g<0&&void 0===t.clockseq&&(u=u+1&16383),(g<0||s>p)&&void 0===t.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=s,m=h,d=u;var v=(1e4*(268435455&(s+=122192928e5))+h)%4294967296;a[n++]=v>>>24&255,a[n++]=v>>>16&255,a[n++]=v>>>8&255,a[n++]=255&v;var y=s/4294967296*1e4&268435455;a[n++]=y>>>8&255,a[n++]=255&y,a[n++]=y>>>24&15|16,a[n++]=y>>>16&255,a[n++]=u>>>8|128,a[n++]=255&u;for(var I=0;I<6;++I)a[n+I]=i[I];return e||f(a)}},1387:function(t,e,r){r.r(e),r.d(e,{default:function(){return L}});var n,a=r(7294),o=r(1745),i=r(5861),u=r(7757),c=r.n(u),s=r(5633),l="chart",d="data-source-select",f="toggle-voronoi",p="update-voronoi";!function(t){t.INCOME="income",t.NOBEL_PRIZES="nobel-prizes"}(n||(n={}));var m,h,g=function(){function t(t){this.source=n.INCOME,this.incomeItemData=t,this.incomeItemData.percentage=Number(this.incomeItemData.percentage)}t.fetchAndCreateCollection=function(){var e=(0,i.Z)(c().mark((function e(){var r,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.gyn)("/demos/data/d3js/area/data.csv");case 2:return r=e.sent,n=r.map((function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[0],a=e[1];return Object.assign({},n,{percentage:n.percent,pointIndex:a})})),e.abrupt("return",n.map((function(e){return new t(e)})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();var e=t.prototype;return e.getYear=function(){return this.incomeItemData.year},e.changePercentage=function(t){var e=Math.max(this.incomeItemData.percentage+t,0),r=Math.min(100,e);this.incomeItemData.percentage=r},e.getNormalizedValue=function(){return this.incomeItemData.percentage/100},e.getId=function(){return this.incomeItemData.pointIndex},e.getSummary=function(){var t=this.incomeItemData;return"Year: "+t.year+", Percentage: "+t.percentage.toFixed(2)+"%"},t}(),v=function(t){return t.getYear()},y=function(t){return t.getNormalizedValue()},I=function(t){return t.source+"-"+t.getId()},b=function(t){return t.getSummary()},w="Share of top decile [aka top 10%] in national income",x=w.replace(" [aka top 10%]",""),A=function(){var t=(0,i.Z)(c().mark((function t(){var e,r,n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.fetchAndCreateCollection();case 2:return e=t.sent,r={getAreaPoints:function(){return e},getChartTitle:function(){return w},getChartTitleShort:function(){return x},getItemId:I,getItemTitle:b,getItemXValue:v,getItemYValue:y,getRootElId:function(){return l},getXAxisFormat:function(){return(0,s.WUZ)(".0f")},getXAxisLabel:function(){return""},getYAxisFormat:function(){return(0,s.WUZ)(".0%")},getYAxisLabel:function(){return""}},n=function(){Array.from({length:50}).forEach((function(){var t=Math.floor(Math.random()*e.length),r=10*Math.random()*(Math.random()>.5?1:-1);e[t].changePercentage(r)}))},t.abrupt("return",{config:r,onUpdateRandomValue:n});case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),V=function(t){return t.birthYear},E=function(t){return t.prizeYear},C=function(t){return t.source+"-"+t.id},S=function(){return"nobel-prizes"},R="Nobel Prizes (subset)",Y=function(){var t=(0,i.Z)(c().mark((function t(){var e,r,a,o,i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,s.AVB)("https://api.nobelprize.org/2.1/laureates?limit=100");case 2:return e=t.sent,r=new Set,(a=e.laureates.filter((function(t){return t.birth&&t.nobelPrizes})).map((function(t){if(!t.nobelPrizes||!t.birth)return null;var e=parseInt(t.birth.date.split("-")[0],10);return r.has(e)?null:(r.add(e),{birthYear:e,id:Number(t.id),prizeYear:Number(t.nobelPrizes[0].awardYear),source:n.NOBEL_PRIZES})})).filter((function(t){return!!t}))).sort((function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[0],a=e[1];return n.birthYear-a.birthYear})),o={getAreaPoints:function(){return a},getChartTitle:function(){return"Nobel Prizes (subset) year of birth (x) vs. year of award (y)"},getChartTitleShort:function(){return R},getItemId:C,getItemTitle:S,getItemXValue:V,getItemYValue:E,getRootElId:function(){return l},getXAxisFormat:function(){return(0,s.WUZ)(".0f")},getYAxisFormat:function(){return(0,s.WUZ)(".0f")}},i=function(){Array.from({length:50}).forEach((function(){var t=Math.floor(Math.random()*a.length),e=10*Math.random()*(Math.random()>.5?1:-1);a[t].prizeYear=a[t].prizeYear+e}))},t.abrupt("return",Promise.resolve({config:o,onUpdateRandomValue:i}));case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();!function(t){t.INCOME="income",t.NOBEL_PRIZES="nobel-prizes"}(h||(h={}));var T=((m={})[h.INCOME]="Income",m[h.NOBEL_PRIZES]="Nobel Prizes (external API)",m),k=function(){var t=(0,i.Z)(c().mark((function t(e){var r,n,a,o,i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([A(),Y()]);case 2:return r=t.sent,n=r[0],a=r[1],o=function(t){switch(null!=t?t:e.source){case h.NOBEL_PRIZES:return a;case h.INCOME:return n;default:throw new Error("Unknown source")}},i=function(t){return o(t).config},t.abrupt("return",{config:{getAreaPoints:function(){return i().getAreaPoints()},getChartTitle:function(){return i().getChartTitle()},getChartTitleShort:function(){return i().getChartTitleShort()},getItemId:function(t){return i(t.source).getItemId(t)},getItemTitle:function(t){return i(t.source).getItemTitle(t)},getItemXValue:function(t){return i(t.source).getItemXValue(t)},getItemYValue:function(t){return i(t.source).getItemYValue(t)},getRootElId:function(){return i().getRootElId()},getXAxisFormat:function(){return i().getXAxisFormat()},getYAxisFormat:function(){return i().getYAxisFormat()}},onUpdateRandomValue:function(){return o().onUpdateRandomValue()},updateSource:function(t){e.source=t}});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),N=function(t){var e=t.onToggleVoronoiClick,r=t.onUpdateRandomValue,n=t.onUpdateSelect,a=t.selectOptions,o=document.getElementById(d),i=document.getElementById(f),u=document.getElementById(p);a.forEach((function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[0],a=e[1],i=document.createElement("option");i.setAttribute("value",n.inputValue),0===a&&i.setAttribute("selected","selected"),i.innerHTML=n.label,o.appendChild(i)})),o.addEventListener("change",(function(){n(o.value)})),i.addEventListener("click",(function(t){t.preventDefault(),e()})),u.addEventListener("click",(function(t){t.preventDefault(),r()}))},P=r(8747),z=r.n(P),O=r(9646),M="area-chart-module--axis--6cab9",F=r(2149),U=function(){function t(t){this.state={hasVoronoi:!1},this.voronoiGroup=t.append("g")}var e=t.prototype;return e.toggleVoronoi=function(){this.state.hasVoronoi=!this.state.hasVoronoi,this.setVoronoi()},e.render=function(t){var e=t.animationDuration,r=t.boundaries,n=t.className,a=t.clipPath,o=t.extractXScale,i=t.extractYScale,u=t.filter,c=t.getItemId,l=t.getTitle,d=t.mouseenter,f=t.mouseleave,p=t.points,m=this.voronoiGroup,h=m.selectAll("path").data(p,(function(t){return c(t)}));h.enter().append("path"),h.exit().remove();var g=(0,s.PKp)(s.i4X),v=F.Z.from(p,o,i).voronoi(r);m.attr("clip-path",a).attr("class","area-chart-module--voronoi--25398").selectAll("path").attr("fill",(function(t){var e=c(t),r=g(e),n=(0,s.$_Y)(r);return n.opacity=.2,n.formatRgb()})).on("mouseenter",d).on("mouseleave",f).attr("class",n).attr("data-voronoi-item",(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[1];return n})).attr("title",l).style("filter",u).transition().duration(e).attr("d",(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[1];return v.renderCell(n)})),this.setVoronoi()},e.setVoronoi=function(){var t=this.state.hasVoronoi,e=this.voronoiGroup,r="area-chart-module--showVoronoi--5bec7",n=e.attr("class").replace(r,"").trim(),a=t?n+" "+r:n;e.attr("class",a),e.attr("data-has-voronoi",t)},t}();"undefined"!=typeof window&&r(5356);var Z=function(){function t(t){var e=this;this.handleWindowResize=function(){e.render(!0)},this.config=t;var r=t.getRootElId(),n=(0,s.Ys)("#"+r).append("svg"),a=n.append("g").attr("class","area-chart-module--areaChart--8ccff"),o=a.append("g"),i=a.append("text").attr("class","area-chart-module--chartTitle--ca932").attr("text-anchor","middle").style("font-weight","bold"),u=a.append("g"),c=a.append("g"),l=a.append("path"),d=a.append("path"),f=new U(a),p=a.append("clipPath").attr("id","clip").append("rect"),m=a.append("clipPath").attr("id","clip-top").append("rect");this.svgOpacityFilter="opacity-"+(0,O.Z)().slice(0,6),function(t){var e=t.deviation,r=t.id,n=t.slope,a=t.svg.append("defs").append("filter").attr("height","500%").attr("id","drop-shadow-"+r).attr("width","500%").attr("x","-200%").attr("y","-200%");a.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",e),a.append("feOffset").attr("dx",1).attr("dy",1),a.append("feComponentTransfer").append("feFuncA").attr("slope",n).attr("type","linear");var o=a.append("feMerge");o.append("feMergeNode"),o.append("feMergeNode").attr("in","SourceGraphic")}({deviation:2,id:this.svgOpacityFilter,slope:.5,svg:a}),this.elements={areaSel:d,backgroundBands:o,chartTitleSel:i,clipRect:p,clipTopRect:m,lineSel:l,svg:n,svgG:a,voronoiGroup:f,xAxisSel:u,yAxisSel:c},this.render(!0),window.addEventListener("resize",this.handleWindowResize)}t.renderChart=function(e){return new t(e)};var e=t.prototype;return e.refresh=function(t){this.render(!!t)},e.tearDown=function(){window.removeEventListener("resize",this.handleWindowResize)},e.toggleVoronoi=function(){this.elements.voronoiGroup.toggleVoronoi()},e.render=function(t){var e=this.config.getRootElId(),r=document.getElementById(e).getBoundingClientRect().width,n=r<500,a=t||n?0:1e3,o=50,i=n?50:70,u=n?10:50,c=50,l=r-i-u,d=400-c-o,f=this.config,p=f.getAreaPoints(),m="tooltip-item-"+(0,O.Z)().slice(0,6),h="point-"+(0,O.Z)().slice(0,6)+"-",g=this.elements,v=g.areaSel,y=g.backgroundBands,I=g.chartTitleSel,b=g.clipRect,w=g.clipTopRect,x=g.lineSel,A=g.svg,V=g.svgG,E=g.voronoiGroup,C=g.xAxisSel,S=g.yAxisSel;A.attr("height",d+c+o).attr("width",l+i+u),V.attr("transform","translate("+i+","+c+")"),I.attr("transform","translate("+(r/2-i)+","+"-15)").text((function(){return n?f.getChartTitleShort():f.getChartTitle()}));var R=(0,s.Fp7)(p,f.getItemXValue),Y=(0,s.VV$)(p,f.getItemXValue),T=(0,s.Fp7)(p,f.getItemYValue),k=(0,s.VV$)(p,f.getItemYValue),N=(0,s.BYU)().domain([Y,R]).range([0,l]),P=(0,s.BYU)().domain([T+.05,k-.05]).range([0,d]),F=function(t){return N(f.getItemXValue(t))},U=function(t){return P(f.getItemYValue(t))},Z=n?(0,s.aE8)().domain([0,500]).range(Array.from({length:6}).map((function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[1];return n})))(r):null,B=this.config.getXAxisFormat(),D=this.config.getYAxisFormat(),L=(0,s.LLu)(N).tickFormat(B).ticks(Z),X=(0,s.y4O)(P).tickFormat(D).tickSize(10);C.attr("class","area-chart-module--x--5ced5 "+M).attr("transform","translate(0,"+d+")").call(L).selectAll("text").attr("dy","1.25em"),S.attr("class","area-chart-module--y--c7cbb "+M).attr("clip-path","url(#clip-top)").transition().duration(a).call(X).selectAll("text").attr("dx","-.25em");var G=(0,s.SOn)().x(F).y0(d).y1(U),W=(0,s.jvg)().x(F).y(U);x.datum(p).attr("clip-path","url(#clip)").attr("class","area-chart-module--line--571fe").transition().duration(a).attr("d",W),b.attr("height",d).attr("width",l),w.attr("height",d).attr("width",l).attr("transform","translate(-50,-5)"),v.datum(p).attr("class","area-chart-module--area--5af1c").attr("clip-path","url(#clip)").transition().duration(a).attr("d",G);var _=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[1];(0,s.Ys)("."+h+f.getItemId(n)).style("display","block")},j=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[1];(0,s.Ys)("."+h+f.getItemId(n)).style("display","none")},$=Array.from({length:10}).map((function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[1];return n})),q=d/10,H=y.selectAll("rect").data($);H.enter().append("rect"),H.exit().remove(),y.selectAll("rect").attr("clip-path","url(#clip)").attr("x",0).attr("width",l).attr("fill",(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[1];return n%2?"#f7f7f7":"#ffffff"})).attr("class","backgroundBands").attr("height",q).attr("y",(function(t){return t*q}));var K=V.selectAll("circle").data(p);K.enter().append("circle"),K.exit().remove(),V.selectAll("circle").attr("r","5px").style("filter","url(#drop-shadow-"+this.svgOpacityFilter+")").attr("transform",(function(t){return"translate("+F(t)+","+U(t)+")"})).attr("class",(function(t){return"area-chart-module--point--3acfa "+m+" "+h+f.getItemId(t)})).on("mouseenter",_).on("mouseleave",j).attr("title",f.getItemTitle),E.render({animationDuration:a,boundaries:[-i,-c,l+u,d+o],className:m,clipPath:"url(#clip)",extractXScale:F,extractYScale:U,filter:"url(#drop-shadow-"+this.svgOpacityFilter+")",getItemId:f.getItemId,getTitle:f.getItemTitle,mouseenter:_,mouseleave:j,points:p}),z()("."+m).tooltip({track:!0})},t}(),B=function(){var t=(0,i.Z)(c().mark((function t(){var e,r,n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={source:h.INCOME},t.next=3,k(e);case 3:r=t.sent,n=Z.renderChart(r.config),N({onToggleVoronoiClick:function(){n.toggleVoronoi()},onUpdateRandomValue:function(){r.onUpdateRandomValue(),n.refresh()},onUpdateSelect:function(t){r.updateSource(t),n.refresh(!0)},selectOptions:Object.values(h).map((function(t){return{inputValue:t,label:T[t]}}))});case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),D=B,L=function(t){var e=t.pageContext;return a.createElement(o.Z,{main:D,pageContext:e},a.createElement("form",{className:"area-page-module--form--1895c"},a.createElement("select",{className:"form-select",id:d}),a.createElement("button",{className:"btn btn-info",id:f,type:"button"},"Toggle Voronoi"),a.createElement("button",{className:"btn btn-success",id:p,type:"button"},"Update Random Values")),a.createElement("div",{id:l}))}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-area-tsx-e2ddedd230361594d4fa.js.map