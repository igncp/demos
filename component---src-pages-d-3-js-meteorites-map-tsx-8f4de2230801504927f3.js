(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[257],{3063:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return S}});var n,o=r(7294),a=r(4275),i=r(2137),s=r(7757),c=r.n(s),l=r(628),u=r(7956),d=r(2203),p=new Uint8Array(16);function m(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(p)}var f=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var h=function(e){return"string"==typeof e&&f.test(e)},g=[],v=0;v<256;++v)g.push((v+256).toString(16).substr(1));var y,w,k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(g[e[t+0]]+g[e[t+1]]+g[e[t+2]]+g[e[t+3]]+"-"+g[e[t+4]]+g[e[t+5]]+"-"+g[e[t+6]]+g[e[t+7]]+"-"+g[e[t+8]]+g[e[t+9]]+"-"+g[e[t+10]]+g[e[t+11]]+g[e[t+12]]+g[e[t+13]]+g[e[t+14]]+g[e[t+15]]).toLowerCase();if(!h(r))throw TypeError("Stringified UUID is invalid");return r},b=0,M=0;var j=function(e,t,r){var n=t&&r||0,o=t||new Array(16),a=(e=e||{}).node||y,i=void 0!==e.clockseq?e.clockseq:w;if(null==a||null==i){var s=e.random||(e.rng||m)();null==a&&(a=y=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==i&&(i=w=16383&(s[6]<<8|s[7]))}var c=void 0!==e.msecs?e.msecs:Date.now(),l=void 0!==e.nsecs?e.nsecs:M+1,u=c-b+(l-M)/1e4;if(u<0&&void 0===e.clockseq&&(i=i+1&16383),(u<0||c>b)&&void 0===e.nsecs&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");b=c,M=l,w=i;var d=(1e4*(268435455&(c+=122192928e5))+l)%4294967296;o[n++]=d>>>24&255,o[n++]=d>>>16&255,o[n++]=d>>>8&255,o[n++]=255&d;var p=c/4294967296*1e4&268435455;o[n++]=p>>>8&255,o[n++]=255&p,o[n++]=p>>>24&15|16,o[n++]=p>>>16&255,o[n++]=i>>>8|128,o[n++]=255&i;for(var f=0;f<6;++f)o[n+f]=a[f];return t||k(o)},C="meteorites-map-module--meteorite--1d0Jo",x="meteorites-map-module--modal--2rmkA",E=function(){var e=(0,i.Z)(c().mark((function e(){var t,r,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([(0,l.AVB)("/demos/data/d3js/meteorites-map/world_countries.json"),(0,l.AVB)("/demos/data/d3js/meteorites-map/meteorites.json")]);case 2:return t=e.sent,r=t[0],n=t[1],e.abrupt("return",{countries:r,meteorites:n});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=0,A=0,Y=1e3-0-0,D=function(e){var t=e.meteoritesEls,r=e.modal,n=e.state;n.isDuringAnimation||(n.selectedMeteorite=null,t.attr("class",C),(0,u.Z)({targets:"."+C,translateX:0,translateY:0}),n.isDuringAnimation=!0,(0,u.Z)({complete:function(){n.isDuringAnimation=!1,r.text("")},targets:"."+x,translateY:0}))},F="Meteorite landings in Earth",I=function(e){var t=e.clickedMeteorite,r=e.meteoritesEls,n=e.meteoritesGeo,o=e.modal,a=e.projectionFn,i=e.rootElId,s=e.state;if(!s.isDuringAnimation)if(s.selectedMeteorite!==t.id){s.selectedMeteorite=t.id;var c=(0,l.i$Z)("%Y")(new Date(t.year)),p=(new Intl.NumberFormat).format(+t.mass);o.html(("\n<h1>"+t.name+"</h1>\n<p>Year: "+c+', Class: <a href="https://www.google.com/search?'+d.stringify({q:t.recclass+" Meteorite Class"})+'" target="_blank">'+t.recclass+"</a></p>\n<p>"+(p?"Mass: "+p+"g, ":"")+"Name: "+t.nametype+'</p>\n<p><a href="https://www.google.com/search?'+d.stringify({q:t.name+" Meteorite "+c})+'" target="_blank">Click here to search</a></p>\n').trim());var m=function(e){var t=e.allMeteorites,r=e.projectionFn,n=e.targetMeteorite,o=r(n.geometry.coordinates),a=t.slice(0).filter((function(e){return!!e.geometry})).map((function(e){var t=e.geometry.coordinates,n=r(t),a=[n[0]-o[0],n[1]-o[1]],i=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2));return Object.assign({},e,{vector:a,vectorLength:i})})).filter((function(e){return e.vectorLength<20&&0!==e.vectorLength})).map((function(e){return Object.assign({},e,{vectorNormalized:[e.vector[0]/e.vectorLength,e.vector[1]/e.vectorLength]})})),i=new Set(a.map((function(e){return e.id}))),s=a.reduce((function(e,t){return e[t.id]=t.vectorNormalized,e}),{});return{nearMeteorites:a,nearMeteoritesSet:i,vectorsMap:s}}({allMeteorites:n,projectionFn:a,targetMeteorite:t}),f=m.nearMeteoritesSet,h=m.vectorsMap;r.attr("class",(function(e){return f.has(e.id)?"meteorites-map-module--moved--1Atuq "+C:e.id===t.id?"meteorites-map-module--active--3vr62 "+C:C}));var g=function(e){return function(r,o){if(function(e){var r=n[e];return r.id===t.id||!f.has(r.id)}(o))return 0;var a=n[o];return 20*h[a.id][e]}};(0,u.Z)({targets:"."+C,translateX:g(0),translateY:g(1)});var v=document.getElementById(i).getBoundingClientRect().top;(0,u.Z)({targets:"."+x,translateY:300+v+window.scrollY})}else D({meteoritesEls:r,modal:o,state:s})},Z=function(e){(0,l.Ys)(this).transition().duration(500).attr("transform",e.transform)},L=function(e){var t=e.countries,r=e.meteorites,n=e.rootElId,o=document.getElementById(n).getBoundingClientRect().width-q-A,a=(0,l.mw4)().translate([o/2,Y/2]),i=(0,l.l49)().projection(a),s={isDuringAnimation:!1,selectedMeteorite:null},c=function(){D({meteoritesEls:h,modal:d,state:s})},u=r.map((function(e){return Object.assign({},e,{geometry:e.geolocation,type:"Feature"})})),d=(0,l.Ys)("#"+n).append("div").attr("class",x).style("top","-250px"),p=(0,l.Ys)("#"+n).append("svg").attr("width",o).attr("height",Y-250).style("cursor","pointer").on("click",c).style("transform-origin","top left").call((0,l.sPX)().extent([[0,0],[o,Y]]).on("end",Z)),m=p.append("g");p.append("text").text(F).attr("text-anchor","middle").style("font-size","20px").attr("transform","translate("+o/2+",40)").style("font-weight","bold"),function(e){var t=e.svg,r=e.width,n="dialog-"+j().slice(0,6),o=t.append("g").attr("transform","translate("+(r-50)+",50)").attr("cursor","pointer");t.append("g").html('\n<filter id="pulse" x="0" y="0" width="100%" height="100%">\n  <feTurbulence result="cloud" baseFrequency=".01" seed="1"  type="fractalNoise" numOctaves="2">\n  <animate attributeName="baseFrequency" calcMode="paced" begin="0s" dur="12s" values=".01;.13;.01;" repeatCount="indefinite"/>\n  </feTurbulence>\n  <feComposite operator="in" in="cloud" in2="SourceGraphic"/>\n</filter>\n    ');var a=(0,l.Ys)(document.body).append("div").attr("id",n).html('\n<p>The green circles refer to meteorites which were moved in the map to allow seeing the selected meteorite, which is in red.</p>\n<p>You can find the <a href="http://www.meteoritemarket.com/type.htm">meteorites classification here</a></p>\n'.trim());$("#"+n).dialog({autoOpen:!1,modal:!0,resizable:!1}),o.append("circle").attr("fill","#fff").attr("stroke","#ccc").attr("r","20").attr("filter","url(#pulse)"),o.append("text").text("?").attr("text-anchor","middle").style("font-size",20).attr("transform","translate(0,5)"),o.on("click",(function(){$("#"+n).dialog("open")}))}({svg:p,width:o});var f="country-"+j().slice(0,6);m.append("g").attr("class",f).selectAll("path").data(t.features).enter().append("path").attr("d",i).attr("fill","#ccc").style("stroke","white").style("stroke-width",1.5).style("opacity",.8).style("stroke","white").style("stroke-width",.3).on("click",c).attr("title",(function(e){return e.properties.name}));var h=m.append("g").on("click",c).selectAll("path").data(u).enter().append("path").attr("d",i).attr("class",C).style("stroke","white").style("cursor","pointer").style("stroke-width",1.5).style("opacity",.8).attr("title",(function(e){return e.name})).on("click",(function(e,t){e.stopPropagation(),I({clickedMeteorite:t,meteoritesEls:h,meteoritesGeo:u,modal:d,projectionFn:a,rootElId:n,state:s})}));$("."+C).tooltip({track:!0}),$("."+f).tooltip({tooltipClass:"meteorites-map-module--countryTooltip--2egLQ",track:!0})},R=function(){var e=(0,i.Z)(c().mark((function e(){var t,r,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:t=e.sent,r=t.countries,n=t.meteorites,L({countries:r,meteorites:n,rootElId:"chart"});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(e){var t=e.pageContext;return o.createElement(a.Z,{links:["/vendors/jquery-ui/themes/base/jquery-ui.min.css"],main:R,pageContext:t,scripts:["/vendors/jquery-ui/jquery-ui.min.js"]},o.createElement("div",{id:"chart"}))}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-meteorites-map-tsx-8f4de2230801504927f3.js.map