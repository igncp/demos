{
    "componentChunkName": "component---src-pages-d-3-js-chord-tsx",
    "path": "/d3js/chord/",
    "result": {"pageContext":{"demoInfo":{"dataFiles":["data.csv"],"docs":[],"isCompleted":true,"name":"Chord","notes":[],"sources":["http://bl.ocks.org/mbostock/1308257"],"summary":[],"category":"d3js","files":{"demoCSS":[{"content":"<span class=\"token selector\">.chartTitle </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> bold<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.chord </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">fill-opacity</span><span class=\"token punctuation\">:</span> 0.75<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">stroke-width</span><span class=\"token punctuation\">:</span> 0.75<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.group </span><span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">text </span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">font</span><span class=\"token punctuation\">:</span> 10rem sans-serif<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">pointer-events</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token selector\">path </span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">stroke</span><span class=\"token punctuation\">:</span> #000<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.groupLabel </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 14px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n","filePath":"src/demos/chord/chord.module.css"}],"demoTS":[{"content":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">UPDATE_BUTTON_ID</span><span class=\"token punctuation\">,</span> getChartConfig <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./chord-chart-config\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FinancialData <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./chord-data-model\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> NChordChart <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./n-chord-chart\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">CONTAINER_ID</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./ui-constants\"</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">main</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> financialData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> FinancialData<span class=\"token punctuation\">.</span><span class=\"token function\">fetchAndCreate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> chartConfig <span class=\"token operator\">=</span> <span class=\"token function\">getChartConfig</span><span class=\"token punctuation\">(</span>financialData<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> chordChart <span class=\"token operator\">=</span> NChordChart<span class=\"token punctuation\">.</span><span class=\"token function\">renderChart</span><span class=\"token punctuation\">(</span>chartConfig<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> buttonEl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token constant\">UPDATE_BUTTON_ID</span><span class=\"token punctuation\">)</span><span class=\"token operator\">!</span>\n\n  buttonEl<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    chartConfig<span class=\"token punctuation\">.</span>chords<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>chordMatrix<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      chordMatrix<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">[</span>chordRow<span class=\"token punctuation\">,</span> chordRowIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        chordRow<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> chordCellIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// Avoid creating a self-referencing ribbon</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>chordRowIndex <span class=\"token operator\">===</span> chordCellIndex<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span>\n          <span class=\"token punctuation\">}</span>\n\n          <span class=\"token keyword\">const</span> shouldUpdate <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.1</span>\n\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>shouldUpdate<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            chordRow<span class=\"token punctuation\">[</span>chordCellIndex<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span>\n              <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n              Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">20</span>\n            <span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    chordChart<span class=\"token punctuation\">.</span><span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">CONTAINER_ID</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">UPDATE_BUTTON_ID</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> main\n","filePath":"src/demos/chord/chord.ts"},{"content":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> format <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"d3\"</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FinancialData<span class=\"token punctuation\">,</span> FinancialMatrix <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./chord-data-model\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ChartConfig <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./n-chord-chart\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">CONTAINER_ID</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./ui-constants\"</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">UPDATE_BUTTON_ID</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"update\"</span>\n\n<span class=\"token keyword\">const</span> getChartConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>financialData<span class=\"token operator\">:</span> FinancialData<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> ChartConfig <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> debits <span class=\"token operator\">=</span> financialData<span class=\"token punctuation\">.</span><span class=\"token function\">getDebits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> credits <span class=\"token operator\">=</span> financialData<span class=\"token punctuation\">.</span><span class=\"token function\">getCredits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> countriesList <span class=\"token operator\">=</span> financialData<span class=\"token punctuation\">.</span><span class=\"token function\">getCountriesList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> formatCurrencyNum <span class=\"token operator\">=</span> <span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\",.3r\"</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">formatCurrency</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>currencyValue<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">$</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">formatCurrencyNum</span><span class=\"token punctuation\">(</span>currencyValue<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">B.</span><span class=\"token template-punctuation string\">`</span></span>\n\n  <span class=\"token keyword\">const</span> getRibbonTitle<span class=\"token operator\">:</span> ChartConfig<span class=\"token punctuation\">[</span><span class=\"token string\">\"getRibbonTitle\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    chartIndex<span class=\"token punctuation\">,</span>\n    sourceIndex<span class=\"token punctuation\">,</span>\n    sourceValue<span class=\"token punctuation\">,</span>\n    targetIndex<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>sourceIndex<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> sourceData<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>targetIndex<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> targetData <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span>\n      countriesList\n\n    <span class=\"token keyword\">const</span> names <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>targetData<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> sourceData<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>chartIndex<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      names<span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>names<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> owes </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>names<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">formatCurrency</span><span class=\"token punctuation\">(</span>sourceValue<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> getGroupTitle<span class=\"token operator\">:</span> ChartConfig<span class=\"token punctuation\">[</span><span class=\"token string\">\"getGroupTitle\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    chartIndex<span class=\"token punctuation\">,</span>\n    chordGroup<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>countriesList<span class=\"token punctuation\">[</span>chordGroup<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>\n      chartIndex <span class=\"token operator\">?</span> <span class=\"token string\">\"owes\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"is owed\"</span>\n    <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">formatCurrency</span><span class=\"token punctuation\">(</span>chordGroup<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n\n  <span class=\"token keyword\">const</span> groupItems <span class=\"token operator\">=</span> countriesList<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>country<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    id<span class=\"token operator\">:</span> country<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n    label<span class=\"token operator\">:</span> country<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">extractChordMatrix</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>row<span class=\"token operator\">:</span> FinancialMatrix<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n    row<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>cell <span class=\"token operator\">?</span> <span class=\"token operator\">+</span>cell<span class=\"token punctuation\">.</span>amount <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> chordLeft <span class=\"token operator\">=</span> debits<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>extractChordMatrix<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> chordRight <span class=\"token operator\">=</span> credits<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>extractChordMatrix<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    chords<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>chordLeft<span class=\"token punctuation\">,</span> chordRight<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    chordsTitles<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"Debits\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Credits\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    getGroupTitle<span class=\"token punctuation\">,</span>\n    getRibbonTitle<span class=\"token punctuation\">,</span>\n    groupItems<span class=\"token punctuation\">,</span>\n    rootElId<span class=\"token operator\">:</span> <span class=\"token constant\">CONTAINER_ID</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">UPDATE_BUTTON_ID</span><span class=\"token punctuation\">,</span> getChartConfig <span class=\"token punctuation\">}</span>\n","filePath":"src/demos/chord/chord-chart-config.ts"},{"content":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> csv <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"d3\"</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">CSVDataItem</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  amount<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  creditor<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  debtor<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  risk<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Country</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n  name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Creditor</span> <span class=\"token operator\">=</span> Country\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Debtor</span> <span class=\"token operator\">=</span> Country <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">{</span> risk<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">CSVParsedItem</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  amount<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  creditor<span class=\"token operator\">:</span> Creditor\n  debtor<span class=\"token operator\">:</span> Debtor\n  risk<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">FinancialMatrix</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>CSVParsedItem <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token operator\">>></span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">FinancialData</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> credits<span class=\"token operator\">:</span> FinancialMatrix\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> debits<span class=\"token operator\">:</span> FinancialMatrix\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> countriesList<span class=\"token operator\">:</span> Country<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    countriesList<span class=\"token punctuation\">,</span>\n    credits<span class=\"token punctuation\">,</span>\n    debits<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    countriesList<span class=\"token operator\">:</span> Country<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    credits<span class=\"token operator\">:</span> FinancialMatrix\n    debits<span class=\"token operator\">:</span> FinancialMatrix\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>credits <span class=\"token operator\">=</span> credits\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>debits <span class=\"token operator\">=</span> debits\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>countriesList <span class=\"token operator\">=</span> countriesList\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">async</span> <span class=\"token function\">fetchAndCreate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FinancialData<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> originalCSVItems <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">csv</span><span class=\"token punctuation\">(</span>\n      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">ROOT_PATH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">data/d3js/chord/data.csv</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> CSVDataItem<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">const</span> countriesList<span class=\"token operator\">:</span> Country<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">const</span> countries<span class=\"token operator\">:</span> Record<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> Country<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">const</span> debits<span class=\"token operator\">:</span> FinancialMatrix <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">const</span> credits<span class=\"token operator\">:</span> FinancialMatrix <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n    <span class=\"token keyword\">const</span> country <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>countryName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Country <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>countryName <span class=\"token keyword\">in</span> countries<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        countries<span class=\"token punctuation\">[</span>countryName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n          id<span class=\"token punctuation\">,</span>\n          name<span class=\"token operator\">:</span> countryName<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n\n        id <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">return</span> countries<span class=\"token punctuation\">[</span>countryName<span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">const</span> parsedList<span class=\"token operator\">:</span> CSVParsedItem<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> originalCSVItems<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>\n      <span class=\"token punctuation\">(</span>originalCSVItem<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>originalCSVItem<span class=\"token punctuation\">,</span>\n        creditor<span class=\"token operator\">:</span> <span class=\"token function\">country</span><span class=\"token punctuation\">(</span>originalCSVItem<span class=\"token punctuation\">.</span>creditor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        debtor<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token operator\">...</span><span class=\"token function\">country</span><span class=\"token punctuation\">(</span>originalCSVItem<span class=\"token punctuation\">.</span>debtor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n          risk<span class=\"token operator\">:</span> originalCSVItem<span class=\"token punctuation\">.</span>risk<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n\n    <span class=\"token builtin\">Array</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> length<span class=\"token operator\">:</span> id <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> sourceIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      debits<span class=\"token punctuation\">[</span>sourceIndex<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n      credits<span class=\"token punctuation\">[</span>sourceIndex<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n      <span class=\"token builtin\">Array</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> length<span class=\"token operator\">:</span> id <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> targetIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        debits<span class=\"token punctuation\">[</span>sourceIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>targetIndex<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n        credits<span class=\"token punctuation\">[</span>sourceIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>targetIndex<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    parsedList<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>financialItem<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      debits<span class=\"token punctuation\">[</span>financialItem<span class=\"token punctuation\">.</span>creditor<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>financialItem<span class=\"token punctuation\">.</span>debtor<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> financialItem\n      credits<span class=\"token punctuation\">[</span>financialItem<span class=\"token punctuation\">.</span>debtor<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>financialItem<span class=\"token punctuation\">.</span>creditor<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span>\n        financialItem\n\n      countriesList<span class=\"token punctuation\">[</span>financialItem<span class=\"token punctuation\">.</span>creditor<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> financialItem<span class=\"token punctuation\">.</span>creditor\n      countriesList<span class=\"token punctuation\">[</span>financialItem<span class=\"token punctuation\">.</span>debtor<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> financialItem<span class=\"token punctuation\">.</span>debtor\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FinancialData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      countriesList<span class=\"token punctuation\">,</span>\n      credits<span class=\"token punctuation\">,</span>\n      debits<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">getCredits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>credits\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">getDebits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>debits\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">getCountriesList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>countriesList\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> FinancialData<span class=\"token punctuation\">,</span> FinancialMatrix <span class=\"token punctuation\">}</span>\n","filePath":"src/demos/chord/chord-data-model.ts"},{"content":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  BaseType<span class=\"token punctuation\">,</span>\n  Chord<span class=\"token punctuation\">,</span>\n  ChordGroup<span class=\"token punctuation\">,</span>\n  ScaleOrdinal<span class=\"token punctuation\">,</span>\n  Selection<span class=\"token punctuation\">,</span>\n  arc <span class=\"token keyword\">as</span> arcD3<span class=\"token punctuation\">,</span>\n  chord<span class=\"token punctuation\">,</span>\n  descending<span class=\"token punctuation\">,</span>\n  interpolate<span class=\"token punctuation\">,</span>\n  rgb<span class=\"token punctuation\">,</span>\n  ribbon <span class=\"token keyword\">as</span> ribbonD3<span class=\"token punctuation\">,</span>\n  scaleOrdinal<span class=\"token punctuation\">,</span>\n  schemePastel2<span class=\"token punctuation\">,</span>\n  select<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"d3\"</span>\n<span class=\"token keyword\">import</span> $ <span class=\"token keyword\">from</span> <span class=\"token string\">\"jquery\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"jquery-ui/themes/base/all.css\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> v1 <span class=\"token keyword\">as</span> uuidv1 <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"uuid\"</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> styles <span class=\"token keyword\">from</span> <span class=\"token string\">\"./chord.module.css\"</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> window <span class=\"token operator\">!==</span> <span class=\"token string\">\"undefined\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jquery-ui/ui/widgets/tooltip\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getRibbonKey</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>ribbonNode<span class=\"token operator\">:</span> Chord<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ribbonNode<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">.</span>index<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">_</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ribbonNode<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>index<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getChordGroupKey</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>chordGroup<span class=\"token operator\">:</span> ChordGroup<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> chordGroup<span class=\"token punctuation\">.</span>index\n\n<span class=\"token keyword\">const</span> addDropShadowFilter <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>SVGData<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  charts<span class=\"token punctuation\">,</span>\n  deviation<span class=\"token punctuation\">,</span>\n  name<span class=\"token punctuation\">,</span>\n  slope<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  charts<span class=\"token operator\">:</span> Selection<span class=\"token operator\">&lt;</span>SVGGElement<span class=\"token punctuation\">,</span> SVGData<span class=\"token punctuation\">,</span> BaseType<span class=\"token punctuation\">,</span> <span class=\"token builtin\">unknown</span><span class=\"token operator\">></span>\n  deviation<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n  name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  slope<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> defs <span class=\"token operator\">=</span> charts<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"defs\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> filter <span class=\"token operator\">=</span> defs<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"filter\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\n\n  filter\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"feOffset\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dx\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dy\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"in\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SourceGraphic\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"result\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"offOut\"</span><span class=\"token punctuation\">)</span>\n\n  filter\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"feGaussianBlur\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"in\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"offOut\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"result\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"blurOut\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stdDeviation\"</span><span class=\"token punctuation\">,</span> deviation<span class=\"token punctuation\">)</span>\n\n  filter\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"feBlend\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"in\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SourceGraphic\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"in2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"blurOut\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mode\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"normal\"</span><span class=\"token punctuation\">)</span>\n\n  filter\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"feComponentTransfer\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"feFuncA\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"slope\"</span><span class=\"token punctuation\">,</span> slope<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"type\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"linear\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> margin <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  bottom<span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n  top<span class=\"token operator\">:</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">GroupItem</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n  label<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">ChordMatrix</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">ChartConfig</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  chords<span class=\"token operator\">:</span> ChordMatrix<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  chordsTitles<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token function-variable function\">getGroupTitle</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    chartIndex<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n    chordGroup<span class=\"token operator\">:</span> ChordGroup\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">string</span>\n  <span class=\"token function-variable function\">getRibbonTitle</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    chartIndex<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n    sourceIndex<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n    sourceValue<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n    targetIndex<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n    targetValue<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">string</span>\n  groupItems<span class=\"token operator\">:</span> GroupItem<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  rootElId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">ChartElements</span> <span class=\"token operator\">=</span> Readonly<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span>\n  charts<span class=\"token operator\">:</span> Selection<span class=\"token operator\">&lt;</span>SVGGElement<span class=\"token punctuation\">,</span> ChordMatrix<span class=\"token punctuation\">,</span> BaseType<span class=\"token punctuation\">,</span> <span class=\"token builtin\">unknown</span><span class=\"token operator\">></span>\n  chartsDivs<span class=\"token operator\">:</span> Selection<span class=\"token operator\">&lt;</span>HTMLDivElement<span class=\"token punctuation\">,</span> ChordMatrix<span class=\"token punctuation\">,</span> BaseType<span class=\"token punctuation\">,</span> <span class=\"token builtin\">unknown</span><span class=\"token operator\">></span>\n  chartsSVGs<span class=\"token operator\">:</span> Selection<span class=\"token operator\">&lt;</span>SVGSVGElement<span class=\"token punctuation\">,</span> ChordMatrix<span class=\"token punctuation\">,</span> BaseType<span class=\"token punctuation\">,</span> <span class=\"token builtin\">unknown</span><span class=\"token operator\">></span>\n  root<span class=\"token operator\">:</span> Selection<span class=\"token operator\">&lt;</span>BaseType<span class=\"token punctuation\">,</span> <span class=\"token builtin\">unknown</span><span class=\"token punctuation\">,</span> HTMLElement<span class=\"token punctuation\">,</span> <span class=\"token builtin\">unknown</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">BaseChart</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">refresh</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span>\n  <span class=\"token function-variable function\">tearDown</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">NChordChart</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">BaseChart</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> config<span class=\"token operator\">:</span> ChartConfig\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> dropShadowGroupsId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> ribbonItemClass<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> chordGroupClass<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> elements<span class=\"token operator\">:</span> ChartElements\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> colorScale<span class=\"token operator\">:</span> ScaleOrdinal<span class=\"token operator\">&lt;</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">string</span><span class=\"token operator\">></span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>chartConfig<span class=\"token operator\">:</span> ChartConfig<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>config <span class=\"token operator\">=</span> chartConfig\n\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n      config<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> chords<span class=\"token punctuation\">,</span> rootElId <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dropShadowGroupsId <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">drop-shadow-groups-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">uuidv1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ribbonItemClass <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">ribbon-item-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">uuidv1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>chordGroupClass <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">chord-group-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">uuidv1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n\n    <span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> <span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">#</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>rootElId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"width\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"100%\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"justify-content\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"space-evenly\"</span><span class=\"token punctuation\">)</span>\n\n    root<span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>chords<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">const</span> chartsDivs <span class=\"token operator\">=</span> root<span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">selectAll</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>HTMLDivElement<span class=\"token punctuation\">,</span> ChordMatrix<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> chartsSVGs <span class=\"token operator\">=</span> chartsDivs<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"svg\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> charts <span class=\"token operator\">=</span> chartsSVGs<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"g\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elements <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      charts<span class=\"token punctuation\">,</span>\n      chartsDivs<span class=\"token punctuation\">,</span>\n      chartsSVGs<span class=\"token punctuation\">,</span>\n      root<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n\n    charts<span class=\"token punctuation\">.</span><span class=\"token function\">each</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> chartIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> chart <span class=\"token operator\">=</span> charts<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>\n        <span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> chartIndexInner<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> chartIndex <span class=\"token operator\">===</span> chartIndexInner\n      <span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n        chordsTitles<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>chartIndex<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> label <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> chartConfig\n\n      chart\n        <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>label<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> styles<span class=\"token punctuation\">.</span>chartTitle<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"text-anchor\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"middle\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">addDropShadowFilter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      charts<span class=\"token punctuation\">,</span>\n      deviation<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n      name<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dropShadowGroupsId<span class=\"token punctuation\">,</span>\n      slope<span class=\"token operator\">:</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>colorScale <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">scaleOrdinal</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">string</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>schemePastel2<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"resize\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleWindowResize<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token function\">renderChart</span><span class=\"token punctuation\">(</span>chartConfig<span class=\"token operator\">:</span> ChartConfig<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">NChordChart</span><span class=\"token punctuation\">(</span>chartConfig<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">tearDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"resize\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleWindowResize<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>withAnimation<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n      colorScale<span class=\"token punctuation\">,</span>\n      config<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> chords<span class=\"token punctuation\">,</span> getGroupTitle<span class=\"token punctuation\">,</span> getRibbonTitle<span class=\"token punctuation\">,</span> groupItems<span class=\"token punctuation\">,</span> rootElId <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span>\n\n    <span class=\"token keyword\">const</span> animationDuration <span class=\"token operator\">=</span> withAnimation <span class=\"token operator\">?</span> <span class=\"token number\">1000</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token keyword\">const</span> rootEl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span>rootElId<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> HTMLElement\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> width<span class=\"token operator\">:</span> fullWidth <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> rootEl<span class=\"token punctuation\">.</span><span class=\"token function\">getBoundingClientRect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> width <span class=\"token operator\">=</span> fullWidth <span class=\"token operator\">/</span> chords<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">20</span>\n    <span class=\"token keyword\">const</span> isSmallDevice <span class=\"token operator\">=</span> fullWidth <span class=\"token operator\">&lt;</span> <span class=\"token number\">768</span>\n    <span class=\"token keyword\">const</span> height <span class=\"token operator\">=</span> isSmallDevice <span class=\"token operator\">?</span> fullWidth <span class=\"token operator\">:</span> width\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n      elements<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> charts<span class=\"token punctuation\">,</span> chartsDivs<span class=\"token punctuation\">,</span> chartsSVGs<span class=\"token punctuation\">,</span> root <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span>\n\n    <span class=\"token keyword\">const</span> outerRadius <span class=\"token operator\">=</span>\n      Math<span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>isSmallDevice <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> chords<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span>\n      <span class=\"token punctuation\">(</span>isSmallDevice <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> innerRadius <span class=\"token operator\">=</span> outerRadius <span class=\"token operator\">-</span> <span class=\"token number\">20</span>\n\n    <span class=\"token keyword\">const</span> chordGroupArc <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">arcD3</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>ChordGroup<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">innerRadius</span><span class=\"token punctuation\">(</span>innerRadius<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">outerRadius</span><span class=\"token punctuation\">(</span>outerRadius<span class=\"token punctuation\">)</span>\n\n    root\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"display\"</span><span class=\"token punctuation\">,</span> isSmallDevice <span class=\"token operator\">?</span> <span class=\"token string\">\"flex\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"inline-flex\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"flex-direction\"</span><span class=\"token punctuation\">,</span> isSmallDevice <span class=\"token operator\">?</span> <span class=\"token string\">\"column\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"row\"</span><span class=\"token punctuation\">)</span>\n\n    chartsDivs\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"width\"</span><span class=\"token punctuation\">,</span> isSmallDevice <span class=\"token operator\">?</span> fullWidth <span class=\"token operator\">:</span> width<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"height\"</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>height <span class=\"token operator\">+</span> margin<span class=\"token punctuation\">.</span>top <span class=\"token operator\">+</span> margin<span class=\"token punctuation\">.</span>bottom<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n\n    chartsSVGs\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"width\"</span><span class=\"token punctuation\">,</span> isSmallDevice <span class=\"token operator\">?</span> fullWidth <span class=\"token operator\">:</span> width<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"height\"</span><span class=\"token punctuation\">,</span> height <span class=\"token operator\">+</span> margin<span class=\"token punctuation\">.</span>top <span class=\"token operator\">+</span> margin<span class=\"token punctuation\">.</span>bottom<span class=\"token punctuation\">)</span>\n\n    charts<span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">\"transform\"</span><span class=\"token punctuation\">,</span>\n      isSmallDevice\n        <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>fullWidth <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>height <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> margin<span class=\"token punctuation\">.</span>top<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>width <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>height <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> margin<span class=\"token punctuation\">.</span>top<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">)</span>\n\n    charts<span class=\"token punctuation\">.</span><span class=\"token function\">each</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> chartIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> chart <span class=\"token operator\">=</span> charts<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>\n        <span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> chartIndexInner<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> chartIndex <span class=\"token operator\">===</span> chartIndexInner\n      <span class=\"token punctuation\">)</span>\n\n      chart\n        <span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>styles<span class=\"token punctuation\">.</span>chartTitle<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"transform\"</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(0,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token operator\">*</span> height<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">-</span> <span class=\"token number\">0</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> chordGroupClass<span class=\"token punctuation\">,</span> dropShadowGroupsId<span class=\"token punctuation\">,</span> ribbonItemClass <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span>\n\n    charts<span class=\"token punctuation\">.</span><span class=\"token function\">each</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token function\">renderSingleChart</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">[</span>numberMatrix<span class=\"token punctuation\">,</span> chartIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> chartSel <span class=\"token operator\">=</span> <span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token keyword\">const</span> chordData <span class=\"token operator\">=</span> <span class=\"token function\">chord</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">sortChords</span><span class=\"token punctuation\">(</span>descending<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>numberMatrix<span class=\"token punctuation\">)</span>\n\n      <span class=\"token keyword\">const</span> ribbonPath <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">ribbonD3</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>Chord<span class=\"token punctuation\">,</span> Chord<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">radius</span><span class=\"token punctuation\">(</span>innerRadius<span class=\"token punctuation\">)</span>\n\n      <span class=\"token keyword\">const</span> initialRibbonsData <span class=\"token operator\">=</span> chartSel\n        <span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">selectAll</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>SVGPathElement<span class=\"token punctuation\">,</span> Chord<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>styles<span class=\"token punctuation\">.</span>chord<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">reduce</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>k<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> Chord <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span> <span class=\"token punctuation\">}</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">[</span>acc<span class=\"token punctuation\">,</span> ribbonNode<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          acc<span class=\"token punctuation\">[</span><span class=\"token function\">getRibbonKey</span><span class=\"token punctuation\">(</span>ribbonNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> ribbonNode\n\n          <span class=\"token keyword\">return</span> acc\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token keyword\">const</span> chordUpdated <span class=\"token operator\">=</span> chartSel\n        <span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>styles<span class=\"token punctuation\">.</span>chord<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>chordData<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> ribbonIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> ribbonIndex<span class=\"token punctuation\">)</span>\n\n      chordUpdated\n        <span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"path\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>styles<span class=\"token punctuation\">.</span>chord<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ribbonItemClass<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      chordUpdated<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n      chartSel\n        <span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">selectAll</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>SVGPathElement<span class=\"token punctuation\">,</span> Chord<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">path.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>styles<span class=\"token punctuation\">.</span>chord<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fill\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>chordItem<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">colorScale</span><span class=\"token punctuation\">(</span>chordItem<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stroke\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>ribbonItem<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> originalColor <span class=\"token operator\">=</span> <span class=\"token function\">colorScale</span><span class=\"token punctuation\">(</span>ribbonItem<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">const</span> newColor <span class=\"token operator\">=</span> <span class=\"token function\">rgb</span><span class=\"token punctuation\">(</span>originalColor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">darker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n          <span class=\"token keyword\">return</span> newColor<span class=\"token punctuation\">.</span><span class=\"token function\">formatHex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stroke-width\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>ribbonItem<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n          <span class=\"token function\">getRibbonTitle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            chartIndex<span class=\"token punctuation\">,</span>\n            sourceIndex<span class=\"token operator\">:</span> ribbonItem<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">,</span>\n            sourceValue<span class=\"token operator\">:</span> ribbonItem<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span>\n            targetIndex<span class=\"token operator\">:</span> ribbonItem<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">,</span>\n            targetValue<span class=\"token operator\">:</span> ribbonItem<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">transition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">duration</span><span class=\"token punctuation\">(</span>animationDuration<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attrTween</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"d\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>finalRibbon<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span><span class=\"token function\">getRibbonKey</span><span class=\"token punctuation\">(</span>finalRibbon<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> initialRibbon <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span>\n            initialRibbonsData\n          <span class=\"token keyword\">const</span> interpolateFn <span class=\"token operator\">=</span> <span class=\"token function\">interpolate</span><span class=\"token punctuation\">(</span>\n            initialRibbon <span class=\"token operator\">??</span> finalRibbon<span class=\"token punctuation\">,</span>\n            finalRibbon\n          <span class=\"token punctuation\">)</span>\n\n          <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">const</span> interpolatedRibbon <span class=\"token operator\">=</span> <span class=\"token function\">interpolateFn</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">)</span>\n\n            <span class=\"token keyword\">return</span> <span class=\"token function\">ribbonPath</span><span class=\"token punctuation\">(</span>interpolatedRibbon<span class=\"token punctuation\">)</span><span class=\"token operator\">!</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token keyword\">const</span> newGroupsSel <span class=\"token operator\">=</span> chartSel\n        <span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">selectAll</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>SVGGElement<span class=\"token punctuation\">,</span> ChordGroup<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>styles<span class=\"token punctuation\">.</span>group<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>chordData<span class=\"token punctuation\">.</span>groups<span class=\"token punctuation\">,</span> getChordGroupKey<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"g\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> styles<span class=\"token punctuation\">.</span>group<span class=\"token punctuation\">)</span>\n\n      newGroupsSel<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"path\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> chordGroupClass<span class=\"token punctuation\">)</span>\n      newGroupsSel\n        <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"group-text\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dy\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"textPath\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span>\n          <span class=\"token string\">\"xlink:href\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">(</span>chordGroup<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">#group</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chordGroup<span class=\"token punctuation\">.</span>index<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chartIndex<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> styles<span class=\"token punctuation\">.</span>groupLabel<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>chordGroup<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> groupItems<span class=\"token punctuation\">[</span>chordGroup<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">)</span>\n\n      <span class=\"token keyword\">const</span> initialGroupsData <span class=\"token operator\">=</span> chartSel<span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chordGroupClass<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">const</span> groupsSel <span class=\"token operator\">=</span> chartSel<span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>styles<span class=\"token punctuation\">.</span>group<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n\n      groupsSel\n        <span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">selectAll</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>SVGPathElement<span class=\"token punctuation\">,</span> ChordGroup<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chordGroupClass<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>chordData<span class=\"token punctuation\">.</span>groups<span class=\"token punctuation\">,</span> getChordGroupKey<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fill\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>chordGroup<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">colorScale</span><span class=\"token punctuation\">(</span>chordGroup<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>chordGroup<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">group</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chordGroup<span class=\"token punctuation\">.</span>index<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chartIndex<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"filter\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">url(#</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>dropShadowGroupsId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>chordGroup<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n          <span class=\"token function\">getGroupTitle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            chartIndex<span class=\"token punctuation\">,</span>\n            chordGroup<span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">transition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">duration</span><span class=\"token punctuation\">(</span>animationDuration<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">attrTween</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"d\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>finalGroup<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>finalGroup<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> initialGroup <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> initialGroupsData\n          <span class=\"token keyword\">const</span> interpolateFn <span class=\"token operator\">=</span> <span class=\"token function\">interpolate</span><span class=\"token punctuation\">(</span>initialGroup<span class=\"token punctuation\">,</span> finalGroup<span class=\"token punctuation\">)</span>\n\n          <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">chordGroupArc</span><span class=\"token punctuation\">(</span><span class=\"token function\">interpolateFn</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">!</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n      groupsSel\n        <span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">selectAll</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>SVGTextElement<span class=\"token punctuation\">,</span> ChordGroup<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\".group-text\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">selectAll</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>SVGTextPathElement<span class=\"token punctuation\">,</span> ChordGroup<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"textPath\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>chordData<span class=\"token punctuation\">.</span>groups<span class=\"token punctuation\">,</span> getChordGroupKey<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">transition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">duration</span><span class=\"token punctuation\">(</span>animationDuration<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"opacity\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>chordGroup<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n          Math<span class=\"token punctuation\">.</span><span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>chordGroup<span class=\"token punctuation\">.</span>startAngle <span class=\"token operator\">-</span> chordGroup<span class=\"token punctuation\">.</span>endAngle<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0.4</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n        <span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span>ribbonItemClass<span class=\"token punctuation\">,</span> chordGroupClass<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>className<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>className<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">tooltip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n          track<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> <span class=\"token function-variable function\">handleWindowResize</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> NChordChart<span class=\"token punctuation\">,</span> ChartConfig <span class=\"token punctuation\">}</span>\n","filePath":"src/demos/chord/n-chord-chart.ts"},{"content":"<span class=\"token keyword\">const</span> <span class=\"token constant\">CONTAINER_ID</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"chart\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">CONTAINER_ID</span> <span class=\"token punctuation\">}</span>\n","filePath":"src/demos/chord/ui-constants.ts"}],"page":{"content":"<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> DemoPageProps <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@/common\"</span>\n\n<span class=\"token keyword\">import</span> Demo <span class=\"token keyword\">from</span> <span class=\"token string\">\"@/components/demo\"</span>\n\n<span class=\"token keyword\">import</span> main<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">CONTAINER_ID</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">UPDATE_BUTTON_ID</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@/demos/chord/chord\"</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Chord</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> pageContext <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> DemoPageProps</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Demo</span></span> <span class=\"token attr-name\">main</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>main<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">pageContext</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>pageContext<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">marginBottom</span><span class=\"token operator\">:</span> <span class=\"token number\">20</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>btn btn-info<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token constant\">UPDATE_BUTTON_ID</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        Update Random Value\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token constant\">CONTAINER_ID</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Demo</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Chord\n","type":"tsx"}},"key":"chord"},"meta":{"description":"Chord Chart example using D3.js, which has a different color scheme with a color for each country, and a special drop shadow filter for a 3D effect."}}},
    "staticQueryHashes": []}