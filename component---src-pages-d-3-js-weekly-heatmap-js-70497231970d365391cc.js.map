{"version":3,"sources":["webpack://demos/./src/demos/_utils/d3utils.js","webpack://demos/./src/demos/weekly-heatmap/weekly-heatmap.js","webpack://demos/./src/pages/d3js/weekly-heatmap.js"],"names":["d3utils","colorsScale","colors","extent","c","d3","scale","linear","domain","range","colorScale","length","p","filterBlackOpacity","id","svg","deviation","slope","filter","append","attr","height","width","x","y","in","stdDeviation","dx","dy","type","feMerge","filterColor","extra","result","in2","mode","middleTitle","text","top","class","transform","String","style","selector","margin","select","bottom","left","right","tooltip","customOpts","opts","_","merge","elementSelector","followElement","followMouse","leftOffst","tOpts","container","viewport","topOffst","$","hover","e","css","pageX","pageY","position","innerWidth","Math","ceil","gridSize","floor","legendElementWidth","days","times","tsv","ROOT_PATH","d","day","hour","value","_error","data","quantile","buckets","max","selectAll","enter","_d","i","heatMap","rx","ry","transition","duration","delay","hide","show","legend","concat","quantiles","fill","stroke","round","demoInfo","pageContext","main","scripts","className"],"mappings":"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","file":"component---src-pages-d-3-js-weekly-heatmap-js-70497231970d365391cc.js","sourcesContent":["const d3utils = {\n  colorsScale(colors, extent) {\n    const c = d3.scale.linear().domain(extent).range([0, 1])\n    const colorScale = d3.scale\n      .linear()\n      .domain(d3.range(0, 1, 1.0 / colors.length))\n      .range(colors)\n\n    return function (p) {\n      return colorScale(c(p))\n    }\n  },\n  filterBlackOpacity(id, svg, deviation, slope) {\n    const defs = svg.append(\"defs\")\n    const filter = defs.append(\"filter\").attr({\n      height: \"500%\",\n      id: `drop-shadow-${id}`,\n      width: \"500%\",\n      x: \"-200%\",\n      y: \"-200%\",\n    })\n\n    filter.append(\"feGaussianBlur\").attr({\n      in: \"SourceAlpha\",\n      stdDeviation: deviation,\n    })\n    filter.append(\"feOffset\").attr({\n      dx: 1,\n      dy: 1,\n    })\n    filter.append(\"feComponentTransfer\").append(\"feFuncA\").attr({\n      slope,\n      type: \"linear\",\n    })\n\n    const feMerge = filter.append(\"feMerge\")\n\n    feMerge.append(\"feMergeNode\")\n\n    return feMerge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\")\n  },\n  filterColor(id, svg, deviation, slope, extra) {\n    if (extra == null) {\n      extra = false\n    }\n\n    const defs = svg.append(\"defs\")\n    const filter = defs.append(\"filter\").attr({\n      id: `drop-shadow-${id}`,\n    })\n\n    if (extra) {\n      filter.attr({\n        height: \"500%\",\n        width: \"500%\",\n        x: \"-200%\",\n        y: \"-200%\",\n      })\n    }\n\n    filter.append(\"feOffset\").attr({\n      dx: 0.5,\n      dy: 0.5,\n      in: \"SourceGraphic\",\n      result: \"offOut\",\n    })\n    filter.append(\"feGaussianBlur\").attr({\n      in: \"offOut\",\n      result: \"blurOut\",\n      stdDeviation: deviation,\n    })\n    filter.append(\"feBlend\").attr({\n      in: \"SourceGraphic\",\n      in2: \"blurOut\",\n      mode: \"normal\",\n    })\n\n    return filter.append(\"feComponentTransfer\").append(\"feFuncA\").attr({\n      slope,\n      type: \"linear\",\n    })\n  },\n  middleTitle(svg, width, text, top) {\n    if (top == null) {\n      top = -15\n    }\n\n    svg\n      .append(\"text\")\n      .attr({\n        class: \"chart-title\",\n        \"text-anchor\": \"middle\",\n        transform: `translate(${String(width / 2)},${top})`,\n      })\n      .text(text)\n      .style({\n        \"font-weight\": \"bold\",\n      })\n  },\n  svg(selector, width, height, margin) {\n    return d3\n      .select(selector)\n      .text(\"\")\n      .append(\"svg\")\n      .attr({\n        height: height + margin.top + margin.bottom,\n        width: width + margin.left + margin.right,\n      })\n      .append(\"g\")\n      .attr({\n        transform: `translate(${margin.left},${margin.top})`,\n      })\n  },\n  tooltip(selector, customOpts) {\n    if (customOpts == null) {\n      customOpts = {}\n    }\n\n    const defaultOpts = {\n      elementSelector: \"\",\n      followElement: false,\n      followMouse: false,\n      leftOffst: 60,\n      tOpts: {\n        container: \"body\",\n        viewport: {\n          selector: \"#chart svg\",\n        },\n      },\n      topOffst: 40,\n    }\n\n    const opts = _.merge(defaultOpts, customOpts)\n\n    $(selector).tooltip(opts.tOpts)\n\n    if (opts.followMouse) {\n      $(selector).hover((e) =>\n        $(\".tooltip\").css({\n          left: `${String(e.pageX - opts.leftOffst)}px`,\n          top: `${String(e.pageY - opts.topOffst)}px`,\n        })\n      )\n    } else if (opts.followElement) {\n      $(selector).hover(() =>\n        $(\".tooltip\").css({\n          left: `${String(\n            $(opts.elementSelector).position().left - opts.leftOffst\n          )}px`,\n          top: `${String(\n            $(opts.elementSelector).position().top - opts.topOffst\n          )}px`,\n        })\n      )\n    }\n  },\n}\n\nexport default d3utils\n","import d3utils from \"@/demos/_utils/d3utils\"\n\nconst main = () => {\n  const margin = {\n    bottom: 100,\n    left: 50,\n    right: 50,\n    top: 50,\n  }\n\n  const width = $(\"#chart\").innerWidth() - margin.left - margin.right\n  const height = Math.ceil((width * 10) / 24) - margin.top - margin.bottom + 60\n  const gridSize = Math.floor(width / 24)\n  const legendElementWidth = gridSize * 2\n  const buckets = 9\n  const colors = [\n    \"#ffffd9\",\n    \"#edf8b1\",\n    \"#c7e9b4\",\n    \"#7fcdbb\",\n    \"#41b6c4\",\n    \"#1d91c0\",\n    \"#225ea8\",\n    \"#253494\",\n    \"#081d58\",\n  ]\n\n  const days = [\"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\", \"Su\"]\n  const times = [\n    \"1 am\",\n    \"2 am\",\n    \"3 am\",\n    \"4 am\",\n    \"5 am\",\n    \"6 am\",\n    \"7 am\",\n    \"8 am\",\n    \"9 am\",\n    \"10 am\",\n    \"11 am\",\n    \"12 am\",\n    \"1 pm\",\n    \"2 pm\",\n    \"3 pm\",\n    \"4 pm\",\n    \"5 pm\",\n    \"6 pm\",\n    \"7 pm\",\n    \"8 pm\",\n    \"9 pm\",\n    \"10 pm\",\n    \"11 pm\",\n    \"12 pm\",\n  ]\n\n  const values = function (d) {\n    return {\n      day: +d.day,\n      hour: +d.hour,\n      value: +d.value,\n    }\n  }\n\n  d3.tsv(\n    `${ROOT_PATH}data/d3js/weekly-heatmap/data.tsv`,\n    values,\n    (_error, data) => {\n      const colorScale = d3.scale\n        .quantile()\n        .domain([0, buckets - 1, d3.max(data, (d) => d.value)])\n        .range(colors)\n      const svg = d3\n        .select(\"#chart\")\n        .append(\"svg\")\n        .attr({\n          height: height + margin.top + margin.bottom,\n          width: width + margin.left + margin.right,\n        })\n        .append(\"g\")\n        .attr(\"transform\", `translate(${margin.left},${margin.top})`)\n\n      svg\n        .selectAll(\".dayLabel\")\n        .data(days)\n        .enter()\n        .append(\"text\")\n        .text((d) => d)\n        .attr({\n          class(_d, i) {\n            if (i >= 0 && i <= 4) {\n              return \"dayLabel mono axis axis-workweek\"\n            }\n\n            return \"dayLabel mono axis\"\n          },\n          transform: `translate(-6,${gridSize / 1.5})`,\n          x: 0,\n          y(_d, i) {\n            return i * gridSize\n          },\n        })\n        .style(\"text-anchor\", \"end\")\n\n      svg\n        .selectAll(\".timeLabel\")\n        .data(times)\n        .enter()\n        .append(\"text\")\n        .text((d) => d)\n        .attr({\n          class(_d, i) {\n            if (i >= 7 && i <= 16) {\n              return \"timeLabel mono axis axis-worktime\"\n            }\n\n            return \"timeLabel mono axis\"\n          },\n          transform: `translate(${gridSize / 2}, -6)`,\n          x(_d, i) {\n            return i * gridSize\n          },\n          y: 0,\n        })\n        .style(\"text-anchor\", \"middle\")\n\n      const heatMap = svg\n        .selectAll(\".hour\")\n        .data(data)\n        .enter()\n        .append(\"rect\")\n        .attr({\n          class: \"hour bordered\",\n          height: gridSize,\n          rx: 4,\n          ry: 4,\n          width: gridSize,\n          x(d) {\n            return (d.hour - 1) * gridSize\n          },\n          y(d) {\n            return (d.day - 1) * gridSize\n          },\n        })\n        .style(\"fill\", colors[0])\n\n      heatMap\n        .transition()\n        .duration(6000)\n        .style(\"fill\", (d) => colorScale(d.value))\n      heatMap.attr(\"data-title\", (d) => `Value: ${d.value}`)\n      d3utils.tooltip(\".hour\", {\n        tOpts: {\n          delay: {\n            hide: 0,\n            show: 500,\n          },\n        },\n      })\n\n      const legend = svg\n        .selectAll(\".legend\")\n        .data([0].concat(colorScale.quantiles()), (d) => d)\n        .enter()\n        .append(\"g\")\n        .attr(\"class\", \"legend\")\n\n      legend\n        .append(\"rect\")\n        .attr(\"x\", (_d, i) => legendElementWidth * i)\n        .attr(\"y\", height)\n        .attr(\"width\", legendElementWidth)\n        .attr(\"height\", gridSize / 2)\n        .style({\n          fill(_d, i) {\n            return colors[i]\n          },\n          stroke: \"#CCC\",\n        })\n\n      legend\n        .append(\"text\")\n        .attr(\"class\", \"mono\")\n        .text((d) => `≥ ${Math.round(d)}`)\n        .attr(\"x\", (_d, i) => legendElementWidth * i)\n        .attr(\"y\", height + gridSize)\n    }\n  )\n}\n\nexport default main\n","import React from \"react\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/weekly-heatmap/weekly-heatmap\"\n\nimport \"@/demos/weekly-heatmap/weekly-heatmap.styl\"\n\nconst WeeklyHeatmap = ({ pageContext: { demoInfo } }) => (\n  <Demo\n    demoInfo={demoInfo}\n    main={main}\n    scripts={[\"/vendors/d3/d3.min.js\", \"/js/d3js-utils.js\"]}\n  >\n    <div className=\"weekly-heatmap-chart\" id=\"chart\" />\n  </Demo>\n)\n\nexport default WeeklyHeatmap\n"],"sourceRoot":""}