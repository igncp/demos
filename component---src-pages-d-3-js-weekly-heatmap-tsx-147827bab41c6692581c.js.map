{"version":3,"sources":["webpack://demos/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://demos/./src/demos/weekly-heatmap/weekly-heatmap.module.css","webpack://demos/./src/demos/weekly-heatmap/weekly-heatmap-chart.ts","webpack://demos/./src/demos/weekly-heatmap/weekly-heatmap-data.ts","webpack://demos/./src/demos/weekly-heatmap/weekly-heatmap.ts","webpack://demos/./src/pages/d3js/weekly-heatmap.tsx"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","mono","axisBold","colors","buckets","length","margin","renderChart","chartConfig","data","rootElId","rootEl","document","getElementById","classList","add","horizontalLabels","verticalLabels","width","getBoundingClientRect","height","Math","ceil","cellSize","floor","legendElementWidth","max","maxD3","item","getItemValue","colorScale","scaleQuantile","domain","range","svg","select","append","attr","selectAll","enter","text","label","labelIndex","styles","getIsVerticalLabelBold","_label","style","getIsHorizontalLabelBold","getItemHorizontalIndex","getItemVerticalIndex","getItemTooltip","transition","duration","$","tooltip","legend","concat","quantiles","d","_value","valueIndex","getLegendText","days","hours","Array","from","map","_","index","fetchData","tsv","ROOT_PATH","timeItem","day","hour","_hour","hourIndex","_day","dayIndex","toFixed","createChartConfig","pageContext","links","main","scripts","id"],"mappings":"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","file":"component---src-pages-d-3-js-weekly-heatmap-tsx-147827bab41c6692581c.js","sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","// extracted by mini-css-extract-plugin\nexport var weeklyHeatmapChart = \"weekly-heatmap-module--weeklyHeatmapChart--3k92Q\";\nexport var bordered = \"weekly-heatmap-module--bordered--2Vfqv\";\nexport var mono = \"weekly-heatmap-module--mono--1FY_w\";\nexport var axisBold = \"weekly-heatmap-module--axisBold--ymVm3\";","import { max as maxD3, scaleQuantile, select } from \"d3\"\n\nimport * as styles from \"./weekly-heatmap.module.css\"\n\nconst colors = [\n  \"#ffffd9\",\n  \"#edf8b1\",\n  \"#c7e9b4\",\n  \"#7fcdbb\",\n  \"#41b6c4\",\n  \"#1d91c0\",\n  \"#225ea8\",\n  \"#253494\",\n  \"#081d58\",\n]\nconst { length: buckets } = colors\n\nconst margin = {\n  bottom: 100,\n  left: 50,\n  right: 50,\n  top: 50,\n}\n\nconst rectRadiusSize = 100\nconst extraHeight = 60\nconst axisOffset = -6\n\nconst legendStroke = \"#ccc\"\n\nexport type ChartConfig<ChartData> = {\n  data: ChartData[]\n  getIsHorizontalLabelBold: (a: string, i: number) => boolean\n  getIsVerticalLabelBold: (a: string, i: number) => boolean\n  getItemHorizontalIndex: (a: ChartData) => number\n  getItemTooltip: (a: ChartData) => string\n  getItemValue: (a: ChartData) => number\n  getItemVerticalIndex: (a: ChartData) => number\n  getLegendText: (value: number) => string\n  horizontalLabels: string[]\n  rootElId: string\n  verticalLabels: string[]\n}\n\nexport const renderChart = <ChartData>(chartConfig: ChartConfig<ChartData>) => {\n  const { data, rootElId } = chartConfig\n  const rootEl = document.getElementById(rootElId) as HTMLElement\n\n  rootEl.classList.add(styles.weeklyHeatmapChart)\n\n  const { horizontalLabels, verticalLabels } = chartConfig\n\n  const width =\n    rootEl.getBoundingClientRect().width - margin.left - margin.right\n  const height =\n    Math.ceil((width * 10) / horizontalLabels.length) -\n    margin.top -\n    margin.bottom +\n    extraHeight\n  const cellSize = Math.floor(width / horizontalLabels.length)\n  const legendElementWidth = cellSize * 2\n\n  const max = maxD3(data, (item) => chartConfig.getItemValue(item))\n\n  const colorScale = scaleQuantile<string>()\n    .domain([0, buckets - 1, max])\n    .range(colors)\n\n  const svg = select(`#${rootElId}`)\n    .append(\"svg\")\n    .attr(\"height\", height + margin.top + margin.bottom)\n    .attr(\"width\", width + margin.left + margin.right)\n    .append(\"g\")\n    .attr(\"transform\", `translate(${margin.left},${margin.top})`)\n\n  svg\n    .selectAll(\".verticalLabel\")\n    .data(verticalLabels)\n    .enter()\n    .append(\"text\")\n    .text((label) => label)\n    .attr(\n      \"class\",\n      (label, labelIndex) =>\n        `verticalLabel ${styles.mono} axis${\n          chartConfig.getIsVerticalLabelBold(label, labelIndex)\n            ? ` ${styles.axisBold}`\n            : \"\"\n        }`\n    )\n    .attr(\"transform\", `translate(${axisOffset},${cellSize / 1.5})`)\n    .attr(\"x\", 0)\n    .attr(\"y\", (_label, labelIndex) => labelIndex * cellSize)\n    .style(\"text-anchor\", \"end\")\n\n  svg\n    .selectAll(\".horizontalLabel\")\n    .data(horizontalLabels)\n    .enter()\n    .append(\"text\")\n    .text((label) => label)\n    .attr(\n      \"class\",\n      (label, labelIndex) =>\n        `horizontalLabel ${styles.mono} axis${\n          chartConfig.getIsHorizontalLabelBold(label, labelIndex)\n            ? ` ${styles.axisBold}`\n            : \"\"\n        }`\n    )\n    .attr(\"transform\", `translate(${cellSize / 2}, ${axisOffset})`)\n    .attr(\"x\", (_label, labelIndex) => labelIndex * cellSize)\n    .attr(\"y\", 0)\n    .style(\"text-anchor\", \"middle\")\n\n  const heatMap = svg\n    .selectAll(\".cell\")\n    .data(data)\n    .enter()\n    .append(\"rect\")\n    .attr(\"class\", `cell ${styles.bordered}`)\n    .attr(\"height\", cellSize)\n    .attr(\"rx\", rectRadiusSize)\n    .attr(\"ry\", rectRadiusSize)\n    .attr(\"width\", cellSize)\n    .attr(\"x\", (item) => chartConfig.getItemHorizontalIndex(item) * cellSize)\n    .attr(\"y\", (item) => chartConfig.getItemVerticalIndex(item) * cellSize)\n    .attr(\"title\", chartConfig.getItemTooltip)\n    .style(\"fill\", colors[0])\n\n  heatMap\n    .transition()\n    .duration(6000)\n    .style(\"fill\", (item) => colorScale(chartConfig.getItemValue(item)))\n\n  $(\".cell\").tooltip()\n\n  const legend = svg\n    .selectAll(\".legend\")\n    .data<any>([0].concat(colorScale.quantiles()), (d) => d)\n    .enter()\n    .append(\"g\")\n    .attr(\"class\", \"legend\")\n\n  legend\n    .append(\"rect\")\n    .attr(\"x\", (_value, valueIndex) => legendElementWidth * valueIndex)\n    .attr(\"y\", height)\n    .attr(\"width\", legendElementWidth)\n    .attr(\"height\", cellSize / 2)\n    .style(\"fill\", (_value, valueIndex) => colors[valueIndex])\n    .style(\"stroke\", legendStroke)\n\n  legend\n    .append(\"text\")\n    .attr(\"class\", styles.mono)\n    .text(chartConfig.getLegendText)\n    .style(\"text-anchor\", \"middle\")\n    .attr(\n      \"x\",\n      (_value, valueIndex) =>\n        legendElementWidth * valueIndex + legendElementWidth / 2\n    )\n    .attr(\"y\", height + cellSize)\n}\n","import { tsv } from \"d3\"\n\nimport { ChartConfig } from \"./weekly-heatmap-chart\"\n\nexport type TimeItem = {\n  day: number\n  hour: number\n  value: number\n}\n\nconst days = [\"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\", \"Su\"]\n\nconst hours = Array.from({ length: 24 }).map((_, index: number) => {\n  const num = index % 12\n\n  return `${num + 1} ${index >= 11 && index !== 23 ? \"pm\" : \"am\"}`\n})\n\nconst workingHourMin = 7\nconst workingHourMax = 16\nconst workingDayMin = 0\nconst workingDayMax = 4\n\nexport const fetchData = async (): Promise<TimeItem[]> => {\n  const data: any = await tsv(`${ROOT_PATH}data/d3js/weekly-heatmap/data.tsv`)\n\n  return data.map((timeItem: TimeItem) => ({\n    day: +timeItem.day,\n    hour: +timeItem.hour,\n    value: +timeItem.value,\n  }))\n}\n\ntype Config = ChartConfig<TimeItem>\n\nconst getItemValue: Config[\"getItemValue\"] = (item) => item.value\nconst getItemTooltip: Config[\"getItemTooltip\"] = (timeItem) =>\n  `Value: ${timeItem.value}`\nconst getItemHorizontalIndex: Config[\"getItemHorizontalIndex\"] = (timeItem) =>\n  timeItem.hour - 1\nconst getItemVerticalIndex: Config[\"getItemVerticalIndex\"] = (timeItem) =>\n  timeItem.day - 1\nconst getIsHorizontalLabelBold: Config[\"getIsHorizontalLabelBold\"] = (\n  _hour,\n  hourIndex\n) => hourIndex >= workingHourMin && hourIndex <= workingHourMax\n\nconst getIsVerticalLabelBold: Config[\"getIsVerticalLabelBold\"] = (\n  _day,\n  dayIndex\n) => dayIndex >= workingDayMin && dayIndex <= workingDayMax\n\nconst getLegendText: Config[\"getLegendText\"] = (value) =>\n  `≥ ${value.toFixed(2)}`\n\nexport const createChartConfig = (data: TimeItem[]): Config => ({\n  data,\n  getIsHorizontalLabelBold,\n  getIsVerticalLabelBold,\n  getItemHorizontalIndex,\n  getItemTooltip,\n  getItemValue,\n  getItemVerticalIndex,\n  getLegendText,\n  horizontalLabels: hours,\n  rootElId: \"chart\",\n  verticalLabels: days,\n})\n","import { renderChart } from \"./weekly-heatmap-chart\"\nimport { TimeItem, createChartConfig, fetchData } from \"./weekly-heatmap-data\"\n\nconst main = async () => {\n  const data = await fetchData()\n  const chartConfig = createChartConfig(data)\n\n  renderChart<TimeItem>(chartConfig)\n}\n\nexport default main\n","import React from \"react\"\n\nimport { DemoPageProps } from \"@/common\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/weekly-heatmap/weekly-heatmap\"\n\nconst WeeklyHeatmap = ({ pageContext }: DemoPageProps) => (\n  <Demo\n    links={[\"/vendors/jquery-ui/themes/base/jquery-ui.min.css\"]}\n    main={main}\n    pageContext={pageContext}\n    scripts={[\"/vendors/jquery-ui/jquery-ui.min.js\"]}\n  >\n    <div id=\"chart\" />\n  </Demo>\n)\n\nexport default WeeklyHeatmap\n"],"sourceRoot":""}