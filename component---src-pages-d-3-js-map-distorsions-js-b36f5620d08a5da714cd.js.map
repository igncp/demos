{"version":3,"sources":["webpack://demos/./src/demos/map-distorsions/map-distorsions.js","webpack://demos/./src/pages/d3js/map-distorsions.js"],"names":["margin","bottom","left","right","top","width","$","innerWidth","height","colors","dimensions","name","scale","d3","ordinal","rangePoints","type","String","linear","range","Number","sqrt","svg","d3utils","x","domain","map","d","line","defined","isNaN","yAxis","axis","orient","dimension","selectAll","data","enter","append","attr","tsv","ROOT_PATH","sortBy","colorFn","length","forEach","dimItem","extent","sort","draw","tooltipText","vals","item","toFixed","join","each","select","this","call","text","style","_d","i","moveToFront","parentNode","appendChild","projection","on","classed","p","filter","followMouse","leftOffst","topOffst","demoInfo","pageContext","main","scripts","className","id"],"mappings":"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","file":"component---src-pages-d-3-js-map-distorsions-js-b36f5620d08a5da714cd.js","sourcesContent":["import sortBy from \"lodash/sortBy\"\nimport d3utils from \"@/demos/_utils/d3utils\"\n\nconst margin = {\n  bottom: 20,\n  left: 200,\n  right: 40,\n  top: 90,\n}\n\nconst main = () => {\n  const width = $(\"#chart\").innerWidth() - margin.left - margin.right\n  const height = 750 - margin.top - margin.bottom\n  const colors = [\"#7C7CC9\", \"#429742\", \"#63BD28\", \"#D14141\"]\n  const dimensions = [\n    {\n      name: \"name\",\n      scale: d3.scale.ordinal().rangePoints([0, height]),\n      type: String,\n    },\n    {\n      name: \"Acc. 40ยบ 150%\",\n      scale: d3.scale.linear().range([0, height]),\n      type: Number,\n    },\n    {\n      name: \"Scale\",\n      scale: d3.scale.linear().range([height, 0]),\n      type: Number,\n    },\n    {\n      name: \"Areal\",\n      scale: d3.scale.sqrt().range([height, 0]),\n      type: Number,\n    },\n    {\n      name: \"Angular\",\n      scale: d3.scale.linear().range([height, 0]),\n      type: Number,\n    },\n  ]\n  const svg = d3utils.svg(\"#chart\", width, height, margin)\n  const title =\n    \"Comparison of 41 map projections by four different types of distortion. Lower is better.\"\n\n  d3utils.middleTitle(svg, width, title, -60)\n\n  const x = d3.scale\n    .ordinal()\n    .domain(dimensions.map((d) => d.name))\n    .rangePoints([0, width])\n  const line = d3.svg.line().defined((d) => !isNaN(d[1]))\n  const yAxis = d3.svg.axis().orient(\"left\")\n  const dimension = svg\n    .selectAll(\".dimension\")\n    .data(dimensions)\n    .enter()\n    .append(\"g\")\n    .attr(\"class\", \"dimension\")\n    .attr(\"transform\", (d) => `translate(${x(d.name)})`)\n\n  d3.tsv(`${ROOT_PATH}data/d3js/map-distorsions/data.tsv`, (data) => {\n    d3utils.filterColor(\"lines\", svg, 2, 0.4)\n    data = sortBy(data, \"name\")\n\n    const colorFn = d3utils.colorsScale(colors, [0, data.length - 1])\n\n    dimensions.forEach((dimItem) =>\n      dimItem.scale.domain(\n        dimItem.type === Number\n          ? d3.extent(data, (d) => +d[dimItem.name])\n          : data.map((d) => d[dimItem.name]).sort()\n      )\n    )\n\n    const draw = function (d) {\n      return line(\n        dimensions.map((dimItem) => [\n          x(dimItem.name),\n          dimItem.scale(d[dimItem.name]),\n        ])\n      )\n    }\n\n    const tooltipText = function (d) {\n      const vals = [\"Acc. 40ยบ 150%\", \"Scale\", \"Areal\", \"Angular\"].map((item) =>\n        String(Number(d[item]).toFixed(2))\n      )\n\n      return `${d.name}:  ${vals.join(\" - \")}`\n    }\n\n    svg\n      .append(\"g\")\n      .attr(\"class\", \"background\")\n      .selectAll(\"path\")\n      .data(data)\n      .enter()\n      .append(\"path\")\n      .attr(\"d\", draw)\n      .attr(\"data-title\", tooltipText)\n    svg\n      .append(\"g\")\n      .attr(\"class\", \"foreground\")\n      .selectAll(\"path\")\n      .data(data)\n      .enter()\n      .append(\"path\")\n      .attr(\"d\", draw)\n      .attr(\"data-title\", tooltipText)\n    dimension\n      .append(\"g\")\n      .attr(\"class\", \"axis\")\n      .each(function (d) {\n        return d3.select(this).call(yAxis.scale(d.scale))\n      })\n      .append(\"text\")\n      .attr(\"class\", \"title\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"y\", -9)\n      .text((d) => d.name)\n    svg\n      .select(\".axis\")\n      .selectAll(\"text:not(.title)\")\n      .attr(\"class\", \"label\")\n      .data(data, (d) => d.name || d)\n      .style(\"fill\", (_d, i) => colorFn(i))\n\n    const moveToFront = function () {\n      return this.parentNode.appendChild(this)\n    }\n\n    const mouseover = function (d) {\n      svg.selectAll(\".foreground path\").style(\"filter\", \"none\")\n      svg.classed(\"active\", true)\n      projection.classed(\"inactive\", (p) => p !== d)\n\n      return projection.filter((p) => p === d).each(moveToFront)\n    }\n\n    const mouseout = function () {\n      svg\n        .selectAll(\".foreground path\")\n        .style(\"filter\", \"url(#drop-shadow-lines)\")\n      svg.classed(\"active\", false)\n      projection.classed(\"inactive\", false)\n    }\n\n    svg\n      .selectAll(\".foreground path\")\n      .style(\"filter\", \"url(#drop-shadow-lines)\")\n      .style(\"stroke\", (_d, i) => colorFn(i))\n\n    const projection = svg\n      .selectAll(\".axis text,.background path,.foreground path\")\n      .on(\"mouseover\", mouseover)\n      .on(\"mouseout\", mouseout)\n\n    d3utils.tooltip(\".background path, .foreground path\", {\n      followMouse: true,\n      leftOffst: 100,\n      topOffst: 50,\n    })\n  })\n}\n\nexport default main\n","import React from \"react\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/map-distorsions/map-distorsions\"\n\nimport \"@/demos/map-distorsions/map-distorsions.styl\"\n\nconst MapDistorsions = ({ pageContext: { demoInfo } }) => (\n  <Demo\n    demoInfo={demoInfo}\n    main={main}\n    scripts={[\"/vendors/d3/d3.min.js\", \"/js/d3js-utils.js\"]}\n  >\n    <div className=\"map-distorsions-chart\" id=\"chart\" />\n  </Demo>\n)\n\nexport default MapDistorsions\n"],"sourceRoot":""}