{"version":3,"sources":["webpack://demos/./src/demos/weekly-heatmap/weekly-heatmap.ts","webpack://demos/./src/pages/d3js/weekly-heatmap.js"],"names":["colors","days","times","fetchData","values","d","day","hour","value","d3","ROOT_PATH","data","map","margin","renderChart","rootElId","width","document","getElementById","getBoundingClientRect","height","Math","ceil","gridSize","floor","legendElementWidth","max","colorScale","domain","buckets","range","svg","append","attr","selectAll","enter","text","_d","i","style","heatMap","transition","duration","d3utils","tOpts","delay","hide","show","legend","concat","quantiles","toFixed","demoInfo","pageContext","main","className","id"],"mappings":"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","file":"component---src-pages-d-3-js-weekly-heatmap-js-de0f24d039de551a8ba2.js","sourcesContent":["import * as d3 from \"d3\"\nimport d3utils from \"@/demos/_utils/d3nextutils\"\n\ntype DataItem = {\n  day: number\n  hour: number\n  value: number\n}\n\nconst buckets = 9\nconst colors = [\n  \"#ffffd9\",\n  \"#edf8b1\",\n  \"#c7e9b4\",\n  \"#7fcdbb\",\n  \"#41b6c4\",\n  \"#1d91c0\",\n  \"#225ea8\",\n  \"#253494\",\n  \"#081d58\",\n]\n\nconst days = [\"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\", \"Su\"]\nconst times = [\n  \"1 am\",\n  \"2 am\",\n  \"3 am\",\n  \"4 am\",\n  \"5 am\",\n  \"6 am\",\n  \"7 am\",\n  \"8 am\",\n  \"9 am\",\n  \"10 am\",\n  \"11 am\",\n  \"12 am\",\n  \"1 pm\",\n  \"2 pm\",\n  \"3 pm\",\n  \"4 pm\",\n  \"5 pm\",\n  \"6 pm\",\n  \"7 pm\",\n  \"8 pm\",\n  \"9 pm\",\n  \"10 pm\",\n  \"11 pm\",\n  \"12 pm\",\n]\n\nconst fetchData = async (): Promise<DataItem[]> => {\n  const values = function (d: DataItem) {\n    return {\n      day: +d.day,\n      hour: +d.hour,\n      value: +d.value,\n    }\n  }\n\n  const data: any = await d3.tsv(\n    `${ROOT_PATH}data/d3js/weekly-heatmap/data.tsv`\n  )\n\n  return data.map(values)\n}\n\nconst margin = {\n  bottom: 100,\n  left: 50,\n  right: 50,\n  top: 50,\n}\n\nconst renderChart = async ({\n  data,\n  rootElId,\n}: {\n  data: DataItem[]\n  rootElId: string\n}) => {\n  const width =\n    (document.getElementById(rootElId) as HTMLElement).getBoundingClientRect()\n      .width -\n    margin.left -\n    margin.right\n  const height = Math.ceil((width * 10) / 24) - margin.top - margin.bottom + 60\n  const gridSize = Math.floor(width / 24)\n  const legendElementWidth = gridSize * 2\n\n  const max = d3.max(data, (d) => d.value)\n\n  const colorScale = d3\n    .scaleQuantile<string>()\n    .domain([0, buckets - 1, max])\n    .range(colors)\n\n  const svg = d3\n    .select(`#${rootElId}`)\n    .append(\"svg\")\n    .attr(\"height\", height + margin.top + margin.bottom)\n    .attr(\"width\", width + margin.left + margin.right)\n    .append(\"g\")\n    .attr(\"transform\", `translate(${margin.left},${margin.top})`)\n\n  svg\n    .selectAll(\".dayLabel\")\n    .data(days)\n    .enter()\n    .append(\"text\")\n    .text((d) => d)\n    .attr(\"class\", (_d, i) => {\n      if (i >= 0 && i <= 4) {\n        return \"dayLabel mono axis axis-workweek\"\n      }\n\n      return \"dayLabel mono axis\"\n    })\n    .attr(\"transform\", `translate(-6,${gridSize / 1.5})`)\n    .attr(\"x\", 0)\n    .attr(\"y\", (_d, i) => i * gridSize)\n    .style(\"text-anchor\", \"end\")\n\n  svg\n    .selectAll(\".timeLabel\")\n    .data(times)\n    .enter()\n    .append(\"text\")\n    .text((d) => d)\n    .attr(\"class\", (_d, i) => {\n      if (i >= 7 && i <= 16) {\n        return \"timeLabel mono axis axis-worktime\"\n      }\n\n      return \"timeLabel mono axis\"\n    })\n    .attr(\"transform\", `translate(${gridSize / 2}, -6)`)\n    .attr(\"x\", (_d, i) => i * gridSize)\n    .attr(\"y\", 0)\n    .style(\"text-anchor\", \"middle\")\n\n  const heatMap = svg\n    .selectAll(\".hour\")\n    .data(data)\n    .enter()\n    .append(\"rect\")\n    .attr(\"class\", \"hour bordered\")\n    .attr(\"height\", gridSize)\n    .attr(\"rx\", 4)\n    .attr(\"ry\", 4)\n    .attr(\"width\", gridSize)\n    .attr(\"x\", (d) => (d.hour - 1) * gridSize)\n    .attr(\"y\", (d) => (d.day - 1) * gridSize)\n    .style(\"fill\", colors[0])\n\n  heatMap\n    .transition()\n    .duration(6000)\n    .style(\"fill\", (d) => colorScale(d.value))\n\n  heatMap.attr(\"data-title\", (d) => `Value: ${d.value}`)\n\n  d3utils.tooltip(\".hour\", {\n    tOpts: {\n      delay: {\n        hide: 0,\n        show: 500,\n      },\n    },\n  })\n\n  const legend = svg\n    .selectAll(\".legend\")\n    .data<any>([0].concat(colorScale.quantiles()), (d) => d)\n    .enter()\n    .append(\"g\")\n    .attr(\"class\", \"legend\")\n\n  legend\n    .append(\"rect\")\n    .attr(\"x\", (_d, i) => legendElementWidth * i)\n    .attr(\"y\", height)\n    .attr(\"width\", legendElementWidth)\n    .attr(\"height\", gridSize / 2)\n    .style(\"fill\", (_d, i) => colors[i])\n    .style(\"stroke\", \"#CCC\")\n\n  legend\n    .append(\"text\")\n    .attr(\"class\", \"mono\")\n    .text((d) => `â‰¥ ${d.toFixed(2)}`)\n    .attr(\"x\", (_d, i) => legendElementWidth * i)\n    .attr(\"y\", height + gridSize)\n}\n\nconst main = async () => {\n  const data = await fetchData()\n\n  renderChart({ data, rootElId: \"chart\" })\n}\n\nexport default main\n","import React from \"react\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/weekly-heatmap/weekly-heatmap\"\n\nimport \"@/demos/weekly-heatmap/weekly-heatmap.styl\"\n\nconst WeeklyHeatmap = ({ pageContext: { demoInfo } }) => (\n  <Demo demoInfo={demoInfo} main={main}>\n    <div className=\"weekly-heatmap-chart\" id=\"chart\" />\n  </Demo>\n)\n\nexport default WeeklyHeatmap\n"],"sourceRoot":""}