{"version":3,"sources":["webpack://demos/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://demos/./src/demos/partition/partition.js","webpack://demos/./src/pages/d3js/partition.tsx"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","colorScale","d3","renderChart","root","rootElId","width","document","getElementById","getBoundingClientRect","radius","Math","min","color","d","children","data","name","parent","svg","append","attr","dataHierarchy","sum","size","PI","arc","startAngle","x0","endAngle","x1","innerRadius","y0","outerRadius","y1","path","selectAll","descendants","enter","depth","_d","i","style","texts","text","abs","length","centroid","rotationDeg","forEach","set","on","index","selector","ROOT_PATH","demoInfo","pageContext","main","scripts","id"],"mappings":"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","file":"component---src-pages-d-3-js-partition-tsx-8b50611619c95bc4c3e6.js","sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import * as d3 from \"d3\"\n\nconst fetchData = () => d3.json(`${ROOT_PATH}data/d3js/partition/flare.json`)\n\n// @TODO: add back the count option\n\nconst height = 700\nconst colorScale = d3.scaleOrdinal(d3.schemePastel2)\n\nconst renderChart = ({ root, rootElId }) => {\n  const addTitles = (selectors) => {\n    selectors.forEach((selector) =>\n      selector.append(\"title\").text((d) => `${d.data.name}\\n${d.value}`)\n    )\n  }\n\n  const { width } = document.getElementById(\"chart\").getBoundingClientRect()\n  const radius = Math.min(width, height) / 2\n\n  const color = (d) =>\n    d.children ? colorScale(d.data.name) : colorScale(d.parent.name)\n\n  const svg = d3\n    .select(`#${rootElId}`)\n    .append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height)\n    .append(\"g\")\n    .attr(\"transform\", `translate(${width / 2},${height * 0.52})`)\n\n  const dataHierarchy = d3.hierarchy(root).sum((d) => d.size)\n\n  d3.partition().size([2 * Math.PI, radius])(dataHierarchy)\n\n  const arc = d3\n    .arc()\n    .startAngle((d) => d.x0)\n    .endAngle((d) => d.x1)\n    .innerRadius((d) => d.y0)\n    .outerRadius((d) => d.y1)\n\n  const path = svg\n    .selectAll(\"path\")\n    .data(dataHierarchy.descendants())\n    .enter()\n    .append(\"path\")\n    .attr(\"display\", (d) => (d.depth ? null : \"none\"))\n    .attr(\"data-index\", (_d, i) => i)\n    .attr(\"d\", arc)\n    .style(\"stroke\", \"#000\")\n    .style(\"stroke-width\", \"1px\")\n    .style(\"fill\", (d) => color(d))\n\n  const texts = svg\n    .selectAll(\"text\")\n    .data(dataHierarchy.descendants())\n    .enter()\n    .append(\"text\")\n    .text((d) => {\n      const dx = Math.abs(d.x0 - d.x1)\n\n      if (dx > 0.07 && d.parent && d.data.name.length < 10) {\n        return d.data.name\n      }\n\n      return \"\"\n    })\n    .attr(\"data-index\", (_d, i) => i)\n    .style(\"fill\", \"black\")\n    .attr(\"text-anchor\", \"middle\")\n    .style(\"font\", \"bold 12px Arial\")\n    .attr(\"transform\", (d) => {\n      if (!d.depth) {\n        return null\n      }\n\n      const centroid = arc.centroid(d)\n      let rotationDeg = 90 + ((d.x0 + (d.x1 - d.x0) / 2) * 180) / Math.PI\n\n      if (rotationDeg > 90 && rotationDeg < 270) {\n        rotationDeg -= 180\n      }\n\n      return `rotate(${rotationDeg},${centroid[0]},${centroid[1]}) translate(${centroid[0]},${centroid[1]})`\n    })\n    .style(\"cursor\", \"default\")\n\n  ;[path, texts].forEach((set) =>\n    set.on(\"mouseover\", function () {\n      const index = d3.select(this).attr(\"data-index\")\n\n      d3.select(`path[data-index=\"${index}\"]`).style(\"fill\", \"#333\")\n      d3.select(`text[data-index=\"${index}\"]`).style(\"fill\", \"white\")\n    })\n  )\n  ;[path, texts].forEach((set) =>\n    set.on(\"mouseout\", function () {\n      const index = d3.select(this).attr(\"data-index\")\n\n      d3.select(`path[data-index=\"${index}\"]`).style(\"fill\", color)\n      d3.select(`text[data-index=\"${index}\"]`).style(\"fill\", \"#000\")\n    })\n  )\n\n  addTitles([path, texts])\n}\n\nconst main = async () => {\n  const root = await fetchData()\n\n  renderChart({\n    root,\n    rootElId: \"chart\",\n  })\n}\n\nexport default main\n","import React from \"react\"\n\nimport { DemoPageProps } from \"@/common\"\n\nimport Demo from \"@/components/demo\"\n\n// @ts-ignore\nimport main from \"@/demos/partition/partition\"\n\nconst Partition = ({ pageContext: { demoInfo } }: DemoPageProps) => (\n  <Demo demoInfo={demoInfo} main={main} scripts={[\"/vendors/d3/d3.min.js\"]}>\n    <div id=\"chart\" />\n  </Demo>\n)\n\nexport default Partition\n"],"sourceRoot":""}