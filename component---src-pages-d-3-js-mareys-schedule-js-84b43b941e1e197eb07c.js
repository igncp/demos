(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[495],{7440:function(t,e,n){"use strict";var r=n(2492),a=n.n(r),o={colorsScale:function(t,e){var n=d3.scale.linear().domain(e).range([0,1]),r=d3.scale.linear().domain(d3.range(0,1,1/t.length)).range(t);return function(t){return r(n(t))}},filterBlackOpacity:function(t,e,n,r){var a=e.append("defs").append("filter").attr({height:"500%",id:"drop-shadow-"+t,width:"500%",x:"-200%",y:"-200%"});a.append("feGaussianBlur").attr({in:"SourceAlpha",stdDeviation:n}),a.append("feOffset").attr({dx:1,dy:1}),a.append("feComponentTransfer").append("feFuncA").attr({slope:r,type:"linear"});var o=a.append("feMerge");return o.append("feMergeNode"),o.append("feMergeNode").attr("in","SourceGraphic")},filterColor:function(t,e,n,r,a){null==a&&(a=!1);var o=e.append("defs").append("filter").attr({id:"drop-shadow-"+t});return a&&o.attr({height:"500%",width:"500%",x:"-200%",y:"-200%"}),o.append("feOffset").attr({dx:.5,dy:.5,in:"SourceGraphic",result:"offOut"}),o.append("feGaussianBlur").attr({in:"offOut",result:"blurOut",stdDeviation:n}),o.append("feBlend").attr({in:"SourceGraphic",in2:"blurOut",mode:"normal"}),o.append("feComponentTransfer").append("feFuncA").attr({slope:r,type:"linear"})},middleTitle:function(t,e,n,r){null==r&&(r=-15),t.append("text").attr({class:"chart-title","text-anchor":"middle",transform:"translate("+String(e/2)+","+r+")"}).text(n).style("font-weight","bold")},svg:function(t,e,n,r){return d3.select(t).text("").append("svg").attr({height:n+r.top+r.bottom,width:e+r.left+r.right}).append("g").attr({transform:"translate("+r.left+","+r.top+")"})},tooltip:function(t,e){null==e&&(e={});var n=a()({elementSelector:"",followElement:!1,followMouse:!1,leftOffst:60,tOpts:{container:"body",viewport:{selector:"#chart svg"}},topOffst:40},e);$(t).tooltip(n.tOpts),n.followMouse?$(t).hover((function(t){return $(".tooltip").css({left:String(t.pageX-n.leftOffst)+"px",top:String(t.pageY-n.topOffst)+"px"})})):n.followElement&&$(t).hover((function(){return $(".tooltip").css({left:String($(n.elementSelector).position().left-n.leftOffst)+"px",top:String($(n.elementSelector).position().top-n.topOffst)+"px"})}))}};e.Z=o},6117:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return c}});var r=n(7294),a=n(7538),o=n(6073),i=n.n(o),s=n(928),l=n.n(s),u=n(7440),p=function(){var t=!1,e=[],n={bottom:50,left:120,right:50,top:80},r=document.getElementById("chart").getBoundingClientRect().width-n.left-n.right,a=600-n.top-n.bottom,o=d3.time.format("%I:%M%p"),s=function(t){var e=o.parse(t);return null!==e&&e.getHours()<3&&e.setDate(e.getDate()+1),e},p=$(".slider");p.slider({change:function(){var c=[];return i()(p.slider("values"),(function(t){var e=t/100*1200,n="AM",r=Math.floor(e/60),a=Math.floor(e%60);a>30?(a-=30,r+=1):a+=30,(r+=4)>23?r-=24===r?12:24:r>11&&(n="PM",12!==r&&(r-=12)),a<10&&(a="0"+String(a));var o=String(r)+":"+a+n;return c.push(o)})),function(i){var p=d3.time.scale().domain([s(i[0]),s(i[1])]).range([0,r]),c=d3.scale.linear().range([0,a]),f=d3.svg.axis().scale(p).ticks(8).tickFormat(o),d=u.Z.svg("#chart",r,a,n);u.Z.middleTitle(d,r,"E.J. Mareyâ€™s graphical train schedule  (4:30AM - 1:30AM)",-40),u.Z.filterBlackOpacity("trains",d,2,.2),d.append("defs").append("clipPath").attr("id","clip").append("rect").attr("y",-n.top).attr("width",r).attr("height",a+n.top+n.bottom),c.domain(d3.extent(e,(function(t){return t.distance})));var m=d.append("g").attr("class","station").selectAll("g").data(e).enter().append("g").attr("transform",(function(t){return"translate(0,"+c(t.distance)+")"}));m.append("text").attr("x",-6).attr("dy",".35em").text((function(t){return t.name})),m.append("line").attr("x2",r),d.append("g").attr("class","x top axis").call(f.orient("top")),d.append("g").attr("class","x bottom axis").attr("transform","translate(0,"+a+")").call(f.orient("bottom"));var h=d.append("g").attr("class","train").attr("clip-path","url(#clip)").selectAll("g").data(t.filter((function(t){return/[NLB]/.test(t.type)}))).enter().append("g").attr("class",(function(t){return t.type+" train-"+t.index})).on("mouseover",(function(t){return d3.select(".train-"+t.index).select("path").style("stroke-width","5px")})).on("mouseleave",(function(t){return d3.select(".train-"+t.index).select("path").style('"stroke-width"',"2.5px")})),v=d3.svg.line().x((function(t){return p(t.time)})).y((function(t){return c(t.station.distance)})),g=function(t){return"S"===t.direction?t.stops[0].station.name+" -> "+l()(t.stops).station.name:l()(t.stops).station.name+" -> "+t.stops[0].station.name};h.append("path").attr("d",(function(t){return v(t.stops)})).append("title").text((function(t){return g(t)})),h.selectAll("circle").data((function(t){return t.stops})).enter().append("circle").attr("transform",(function(t){return"translate("+p(t.time)+","+c(t.station.distance)+")"})).style("filter","url(#drop-shadow-trains)").attr("r","5px").append("title").text((function(e){return g(t[e.train_index])+"\n"+e.station.name+" at "+(o=(r=(n=e.time).getHours())>=12?"PM":"AM",(r=(r%=12)||12)+":"+(a=(a=n.getMinutes())<10?"0"+a:a)+" "+o);var n,r,a,o}))}(c)},range:!0}),d3.tsv("/demos/data/d3js/mareys-schedule/data.tsv",(function(t,n){var r=null;if(!n)for(var a in t)/^stop\|/.test(a)&&(r=a.split("|"),e.push({distance:+r[2],key:a,name:r[1],zone:+r[3]}));return{direction:t.direction,number:t.number,stops:e.map((function(e){return{station:e,time:s(t[e.key])}})).filter((function(t){return null!==t.time})),type:t.type}}),(function(e,n){return(t=n).forEach((function(t,e){t.index=e,t.stops.forEach((function(t){t.train_index=e}))})),p.slider("values",[10,50])}))},c=function(t){var e=t.pageContext.demoInfo;return r.createElement(a.Z,{demoInfo:e,links:["/vendors/jquery-ui/themes/base/theme.css","/vendors/jquery-ui/themes/base/slider.css"],main:p,scripts:["/vendors/d3/d3.min.js","/vendors/jquery-ui/jquery-ui.min.js","/vendors/jquery-ui/ui/slider.js","/js/d3js-utils.js"]},r.createElement("div",null,r.createElement("div",{className:"slider"})),r.createElement("div",{className:"mareys-schedule-chart",id:"chart"}))}},7412:function(t){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},4140:function(t,e,n){var r=n(7816),a=n(9291)(r);t.exports=a},7816:function(t,e,n){var r=n(8483),a=n(3674);t.exports=function(t,e){return t&&r(t,e,a)}},280:function(t,e,n){var r=n(5726),a=n(6916),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return a(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}},4290:function(t,e,n){var r=n(6557);t.exports=function(t){return"function"==typeof t?t:r}},9291:function(t,e,n){var r=n(8612);t.exports=function(t,e){return function(n,a){if(null==n)return n;if(!r(n))return t(n,a);for(var o=n.length,i=e?o:-1,s=Object(n);(e?i--:++i<o)&&!1!==a(s[i],i,s););return n}}},6916:function(t,e,n){var r=n(5569)(Object.keys,Object);t.exports=r},6073:function(t,e,n){t.exports=n(4486)},4486:function(t,e,n){var r=n(7412),a=n(4140),o=n(4290),i=n(1469);t.exports=function(t,e){return(i(t)?r:a)(t,o(e))}},3674:function(t,e,n){var r=n(4636),a=n(280),o=n(8612);t.exports=function(t){return o(t)?r(t):a(t)}},928:function(t){t.exports=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-mareys-schedule-js-84b43b941e1e197eb07c.js.map