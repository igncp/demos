(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[257],{9646:function(e,t,r){"use strict";var n;r.d(t,{Z:function(){return h}});var o=new Uint8Array(16);function a(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}var i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var s=function(e){return"string"==typeof e&&i.test(e)},c=[],l=0;l<256;++l)c.push((l+256).toString(16).substr(1));var u,d,p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!s(r))throw TypeError("Stringified UUID is invalid");return r},m=0,f=0;var h=function(e,t,r){var n=t&&r||0,o=t||new Array(16),i=(e=e||{}).node||u,s=void 0!==e.clockseq?e.clockseq:d;if(null==i||null==s){var c=e.random||(e.rng||a)();null==i&&(i=u=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==s&&(s=d=16383&(c[6]<<8|c[7]))}var l=void 0!==e.msecs?e.msecs:Date.now(),h=void 0!==e.nsecs?e.nsecs:f+1,g=l-m+(h-f)/1e4;if(g<0&&void 0===e.clockseq&&(s=s+1&16383),(g<0||l>m)&&void 0===e.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");m=l,f=h,d=s;var v=(1e4*(268435455&(l+=122192928e5))+h)%4294967296;o[n++]=v>>>24&255,o[n++]=v>>>16&255,o[n++]=v>>>8&255,o[n++]=255&v;var y=l/4294967296*1e4&268435455;o[n++]=y>>>8&255,o[n++]=255&y,o[n++]=y>>>24&15|16,o[n++]=y>>>16&255,o[n++]=s>>>8|128,o[n++]=255&s;for(var w=0;w<6;++w)o[n+w]=i[w];return t||p(o)}},8926:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return C}});var n=r(7294),o=r(4275),a=r(2137),i=r(7757),s=r.n(i),c=r(6660),l=r(7956),u=r(2203),d=r(9646),p="meteorites-map-module--meteorite--1d0Jo",m="meteorites-map-module--modal--2rmkA",f=function(){var e=(0,a.Z)(s().mark((function e(){var t,r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([(0,c.AVB)("/demos/data/d3js/meteorites-map/world_countries.json"),(0,c.AVB)("/demos/data/d3js/meteorites-map/meteorites.json")]);case 2:return t=e.sent,r=t[0],n=t[1],e.abrupt("return",{countries:r,meteorites:n});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=0,g=0,v=1e3-0-0,y=function(e){var t=e.meteoritesEls,r=e.modal,n=e.state;n.isDuringAnimation||(n.selectedMeteorite=null,t.attr("class",p),(0,l.Z)({targets:"."+p,translateX:0,translateY:0}),n.isDuringAnimation=!0,(0,l.Z)({complete:function(){n.isDuringAnimation=!1,r.text("")},targets:"."+m,translateY:0}))},w="Meteorite landings in Earth",k=function(e){var t=e.clickedMeteorite,r=e.meteoritesEls,n=e.meteoritesGeo,o=e.modal,a=e.projectionFn,i=e.rootElId,s=e.state;if(!s.isDuringAnimation)if(s.selectedMeteorite!==t.id){s.selectedMeteorite=t.id;var d=(0,c.i$Z)("%Y")(new Date(t.year)),f=(new Intl.NumberFormat).format(+t.mass);o.html(("\n<h1>"+t.name+"</h1>\n<p>Year: "+d+', Class: <a href="https://www.google.com/search?'+u.stringify({q:t.recclass+" Meteorite Class"})+'" target="_blank">'+t.recclass+"</a></p>\n<p>"+(f?"Mass: "+f+"g, ":"")+"Name: "+t.nametype+'</p>\n<p><a href="https://www.google.com/search?'+u.stringify({q:t.name+" Meteorite "+d})+'" target="_blank">Click here to search</a></p>\n').trim());var h=function(e){var t=e.allMeteorites,r=e.projectionFn,n=e.targetMeteorite,o=r(n.geometry.coordinates),a=t.slice(0).filter((function(e){return!!e.geometry})).map((function(e){var t=e.geometry.coordinates,n=r(t),a=[n[0]-o[0],n[1]-o[1]],i=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2));return Object.assign({},e,{vector:a,vectorLength:i})})).filter((function(e){return e.vectorLength<20&&0!==e.vectorLength})).map((function(e){return Object.assign({},e,{vectorNormalized:[e.vector[0]/e.vectorLength,e.vector[1]/e.vectorLength]})})),i=new Set(a.map((function(e){return e.id}))),s=a.reduce((function(e,t){return e[t.id]=t.vectorNormalized,e}),{});return{nearMeteorites:a,nearMeteoritesSet:i,vectorsMap:s}}({allMeteorites:n,projectionFn:a,targetMeteorite:t}),g=h.nearMeteoritesSet,v=h.vectorsMap;r.attr("class",(function(e){return g.has(e.id)?"meteorites-map-module--moved--1Atuq "+p:e.id===t.id?"meteorites-map-module--active--3vr62 "+p:p}));var w=function(e){return function(r,o){if(function(e){var r=n[e];return r.id===t.id||!g.has(r.id)}(o))return 0;var a=n[o];return 20*v[a.id][e]}};(0,l.Z)({targets:"."+p,translateX:w(0),translateY:w(1)});var k=document.getElementById(i).getBoundingClientRect().top;(0,l.Z)({targets:"."+m,translateY:300+k+window.scrollY})}else y({meteoritesEls:r,modal:o,state:s})},b=function(e){(0,c.Ys)(this).transition().duration(500).attr("transform",e.transform)},M=function(e){var t=e.countries,r=e.meteorites,n=e.rootElId,o=document.getElementById(n).getBoundingClientRect().width-h-g,a=(0,c.mw4)().translate([o/2,v/2]),i=(0,c.l49)().projection(a),s={isDuringAnimation:!1,selectedMeteorite:null},l=function(){y({meteoritesEls:E,modal:f,state:s})},u=r.map((function(e){return Object.assign({},e,{geometry:e.geolocation,type:"Feature"})})),f=(0,c.Ys)("#"+n).append("div").attr("class",m).style("top","-250px"),M=(0,c.Ys)("#"+n).append("svg").attr("width",o).attr("height",v-250).style("cursor","pointer").on("click",l).style("transform-origin","top left").call((0,c.sPX)().extent([[0,0],[o,v]]).on("end",b)),j=M.append("g");M.append("text").text(w).attr("text-anchor","middle").style("font-size","20px").attr("transform","translate("+o/2+",40)").style("font-weight","bold"),function(e){var t=e.svg,r=e.width,n="dialog-"+(0,d.Z)().slice(0,6),o=t.append("g").attr("transform","translate("+(r-50)+",50)").attr("class","meteorites-map-module--infoTrigger--2tb0J");t.append("g").html('\n<filter id="pulse" x="0" y="0" width="100%" height="100%">\n  <feTurbulence result="cloud" baseFrequency=".01" seed="1"  type="fractalNoise" numOctaves="2">\n  <animate attributeName="baseFrequency" calcMode="paced" begin="0s" dur="12s" values=".01;.13;.01;" repeatCount="indefinite"/>\n  </feTurbulence>\n  <feComposite operator="in" in="cloud" in2="SourceGraphic"/>\n</filter>\n    ');var a=(0,c.Ys)(document.body).append("div").attr("id",n).html('\n<p>The green circles refer to meteorites which were moved in the map to allow seeing the selected meteorite, which is in red.</p>\n<p>You can find the <a href="http://www.meteoritemarket.com/type.htm">meteorites classification here</a></p>\n'.trim());$("#"+n).dialog({autoOpen:!1,modal:!0,resizable:!1}),o.append("circle").attr("r","20").attr("filter","url(#pulse)"),o.append("text").text("?"),o.on("click",(function(){$("#"+n).dialog("open")}))}({svg:M,width:o});var C="country-"+(0,d.Z)().slice(0,6);j.append("g").attr("class",C).selectAll("path").data(t.features).enter().append("path").attr("d",i).attr("fill","#ccc").style("stroke","white").style("stroke-width",1.5).style("opacity",.8).style("stroke","white").style("stroke-width",.3).on("click",l).attr("title",(function(e){return e.properties.name}));var E=j.append("g").on("click",l).selectAll("path").data(u).enter().append("path").attr("d",i).attr("class",p).style("stroke","white").style("cursor","pointer").style("stroke-width",1.5).style("opacity",.8).attr("title",(function(e){return e.name})).on("click",(function(e,t){e.stopPropagation(),k({clickedMeteorite:t,meteoritesEls:E,meteoritesGeo:u,modal:f,projectionFn:a,rootElId:n,state:s})}));$("."+p).tooltip({track:!0}),$("."+C).tooltip({tooltipClass:"meteorites-map-module--countryTooltip--2egLQ",track:!0})},j=function(){var e=(0,a.Z)(s().mark((function e(){var t,r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:t=e.sent,r=t.countries,n=t.meteorites,M({countries:r,meteorites:n,rootElId:"chart"});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(e){var t=e.pageContext;return n.createElement(o.Z,{links:["/vendors/jquery-ui/themes/base/jquery-ui.min.css"],main:j,pageContext:t,scripts:["/vendors/jquery-ui/jquery-ui.min.js"]},n.createElement("div",{id:"chart"}))}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-meteorites-map-tsx-decd2be8eff2211f6f2f.js.map