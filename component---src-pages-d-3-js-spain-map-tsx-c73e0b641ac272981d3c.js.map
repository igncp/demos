{"version":3,"sources":["webpack://demos/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://demos/./node_modules/topojson-client/src/identity.js","webpack://demos/./node_modules/topojson-client/src/feature.js","webpack://demos/./node_modules/topojson-client/src/transform.js","webpack://demos/./node_modules/topojson-client/src/reverse.js","webpack://demos/./src/demos/spain-map/spain-map.ts","webpack://demos/./src/pages/d3js/spain-map.tsx"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","x","topology","o","objects","type","features","geometries","map","id","bbox","properties","geometry","transformPoint","transform","identity","x0","y0","kx","scale","ky","dx","translate","dy","input","i","j","n","length","output","Array","arcs","arc","points","pop","a","k","push","array","t","reverse","point","p","line","ring","polygon","coordinates","object","colorsScheme","height","margin","addDropShadowFilter","svg","deviation","slope","filter","append","attr","feMerge","renderChart","data","rootElId","widthChart","document","getElementById","getBoundingClientRect","width","widthPeninsula","widthCanarias","dataRoot","data1","dataGeo","feature","forEach","d","index","colorScale","scaleLinear","domain","range","colorScaleConversion","colorFn","select","generateProjection","center","geoMercator","generatePath","projection","geoPath","generateAreas","svgComp","path","filterId","selectAll","enter","style","on","text","NAME_2","svgLeft","generateSvg","svgRight","projectionCanarias","projectionPeninsula","pathCanarias","pathPeninsula","json","ROOT_PATH","pageContext","main"],"mappings":"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","file":"component---src-pages-d-3-js-spain-map-tsx-c73e0b641ac272981d3c.js","sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","export default function (x) {\n  return x;\n}","import reverse from \"./reverse.js\";\nimport transform from \"./transform.js\";\nexport default function (topology, o) {\n  if (typeof o === \"string\") o = topology.objects[o];\n  return o.type === \"GeometryCollection\" ? {\n    type: \"FeatureCollection\",\n    features: o.geometries.map(function (o) {\n      return feature(topology, o);\n    })\n  } : feature(topology, o);\n}\n\nfunction feature(topology, o) {\n  var id = o.id,\n      bbox = o.bbox,\n      properties = o.properties == null ? {} : o.properties,\n      geometry = object(topology, o);\n  return id == null && bbox == null ? {\n    type: \"Feature\",\n    properties: properties,\n    geometry: geometry\n  } : bbox == null ? {\n    type: \"Feature\",\n    id: id,\n    properties: properties,\n    geometry: geometry\n  } : {\n    type: \"Feature\",\n    id: id,\n    bbox: bbox,\n    properties: properties,\n    geometry: geometry\n  };\n}\n\nexport function object(topology, o) {\n  var transformPoint = transform(topology.transform),\n      arcs = topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) points.pop();\n\n    for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length; k < n; ++k) {\n      points.push(transformPoint(a[k], k));\n    }\n\n    if (i < 0) reverse(points, n);\n  }\n\n  function point(p) {\n    return transformPoint(p);\n  }\n\n  function line(arcs) {\n    var points = [];\n\n    for (var i = 0, n = arcs.length; i < n; ++i) {\n      arc(arcs[i], points);\n    }\n\n    if (points.length < 2) points.push(points[0]); // This should never happen per the specification.\n\n    return points;\n  }\n\n  function ring(arcs) {\n    var points = line(arcs);\n\n    while (points.length < 4) {\n      points.push(points[0]);\n    } // This may happen if an arc has only two points.\n\n\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var type = o.type,\n        coordinates;\n\n    switch (type) {\n      case \"GeometryCollection\":\n        return {\n          type: type,\n          geometries: o.geometries.map(geometry)\n        };\n\n      case \"Point\":\n        coordinates = point(o.coordinates);\n        break;\n\n      case \"MultiPoint\":\n        coordinates = o.coordinates.map(point);\n        break;\n\n      case \"LineString\":\n        coordinates = line(o.arcs);\n        break;\n\n      case \"MultiLineString\":\n        coordinates = o.arcs.map(line);\n        break;\n\n      case \"Polygon\":\n        coordinates = polygon(o.arcs);\n        break;\n\n      case \"MultiPolygon\":\n        coordinates = o.arcs.map(polygon);\n        break;\n\n      default:\n        return null;\n    }\n\n    return {\n      type: type,\n      coordinates: coordinates\n    };\n  }\n\n  return geometry(o);\n}","import identity from \"./identity.js\";\nexport default function (transform) {\n  if (transform == null) return identity;\n  var x0,\n      y0,\n      kx = transform.scale[0],\n      ky = transform.scale[1],\n      dx = transform.translate[0],\n      dy = transform.translate[1];\n  return function (input, i) {\n    if (!i) x0 = y0 = 0;\n    var j = 2,\n        n = input.length,\n        output = new Array(n);\n    output[0] = (x0 += input[0]) * kx + dx;\n    output[1] = (y0 += input[1]) * ky + dy;\n\n    while (j < n) {\n      output[j] = input[j], ++j;\n    }\n\n    return output;\n  };\n}","export default function (array, n) {\n  var t,\n      j = array.length,\n      i = j - n;\n\n  while (i < --j) {\n    t = array[i], array[i++] = array[j], array[j] = t;\n  }\n}","import {\n  BaseType,\n  GeoPath,\n  GeoPermissibleObjects,\n  GeoProjection,\n  Selection,\n  geoMercator,\n  geoPath,\n  json,\n  range,\n  scaleLinear,\n  select,\n} from \"d3\"\nimport { feature } from \"topojson-client\"\nimport { GeoJsonProperties } from \"geojson\"\nimport { Topology, Objects } from \"topojson-specification\"\n\nconst fetchData = (): Promise<Data | undefined> =>\n  json(`${ROOT_PATH}data/d3js/spain-map/data.json`)\n\nconst colorsScheme = [\"#323247\", \"#7C7CC9\", \"#72B66C\", \"#429742\"]\nconst height = 500\nconst margin = {\n  bottom: 20,\n  top: 50,\n}\nconst strokeWidth = 0.4\n\ntype SVG = Selection<BaseType, unknown, HTMLElement, unknown>\n\ntype DataShape = {\n  index: number\n  properties: {\n    NAME_2: string\n  }\n} & GeoPermissibleObjects\n\ntype Data = Topology<Objects<GeoJsonProperties>>\n\nconst addDropShadowFilter = function (\n  id: number,\n  svg: SVG,\n  deviation: number,\n  slope: number\n) {\n  const defs = svg.append(\"defs\")\n  const filter = defs.append(\"filter\").attr(\"id\", `drop-shadow-${id}`)\n\n  filter\n    .append(\"feGaussianBlur\")\n    .attr(\"in\", \"SourceAlpha\")\n    .attr(\"stdDeviation\", deviation)\n\n  filter.append(\"feOffset\").attr(\"dx\", 1).attr(\"dy\", 1)\n  filter\n    .append(\"feComponentTransfer\")\n    .append(\"feFuncA\")\n    .attr(\"slope\", slope)\n    .attr(\"type\", \"linear\")\n\n  const feMerge = filter.append(\"feMerge\")\n\n  feMerge.append(\"feMergeNode\")\n\n  feMerge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\")\n}\n\nconst renderChart = async ({\n  data,\n  rootElId,\n}: {\n  data: Data\n  rootElId: string\n}) => {\n  const widthChart = (document.getElementById(\n    rootElId\n  ) as HTMLElement).getBoundingClientRect().width\n  const widthCanarias = widthChart / 3.5\n  const widthPeninsula = widthChart - widthCanarias - 10\n\n  const dataRoot = data.objects.data1\n  const dataGeo = (feature(data, dataRoot) as any).features\n\n  dataGeo.forEach((d: DataShape, i: number) => {\n    d.index = i\n  })\n\n  const colorScale = scaleLinear()\n    .domain([0, (dataRoot as any).geometries.length])\n    .range([0, 1])\n  const colorScaleConversion = scaleLinear<string>()\n    .domain(range(0, 1, 1.0 / colorsScheme.length))\n    .range(colorsScheme)\n\n  const colorFn = function (d: DataShape) {\n    return colorScaleConversion(colorScale(d.index))\n  }\n\n  const svg = select(`#${rootElId}`)\n\n  const generateSvg = function (width: number) {\n    return svg\n      .append(\"div\")\n      .style(\"display\", \"inline-block\")\n      .style(\"height\", `${height + margin.top + margin.bottom}px`)\n      .style(\"width\", `${width}px`)\n      .append(\"svg:svg\")\n      .attr(\"width\", width)\n      .attr(\"height\", height + margin.top + margin.bottom)\n      .append(\"svg:g\")\n      .attr(\"transform\", `translate(${width / 2},${height / 2 + margin.top})`)\n  }\n\n  const generateProjection = (center: [number, number]) =>\n    geoMercator()\n      .center(center)\n      .scale(2650)\n      .translate([widthPeninsula / 2, height / 2])\n\n  const generatePath = function (projection: GeoProjection) {\n    return geoPath().projection(projection)\n  }\n\n  const generateAreas = function (\n    svgComp: SVG,\n    path: GeoPath<SVGPathElement, GeoPermissibleObjects>,\n    filterId: number\n  ) {\n    svgComp\n      .selectAll(\".area\")\n      .data<DataShape>(dataGeo)\n      .enter()\n      .append(\"path\")\n      .attr(\"d\", path)\n      .style(\"fill\", colorFn)\n      .style(\"stroke\", \"#FFF\")\n      .style(\"stroke-width\", strokeWidth)\n      .style(\"filter\", () => `url(#drop-shadow-${filterId})`)\n      .on(\"mouseover\", function () {\n        return select(this)\n          .style(\"fill\", \"#FFB61A\")\n          .style(\"stroke-width\", \"1px\")\n      })\n      .on(\"mouseleave\", function () {\n        return select<SVGPathElement, DataShape>(this)\n          .style(\"fill\", (d) => colorFn(d))\n          .style(\"stroke-width\", strokeWidth)\n      })\n      .append(\"title\")\n      .text((d) => d.properties.NAME_2)\n  }\n\n  const svgLeft = generateSvg(widthCanarias)\n  const svgRight = generateSvg(widthPeninsula)\n\n  addDropShadowFilter(1, svgLeft, 2, 0.3)\n  addDropShadowFilter(2, svgRight, 2, 0.3)\n\n  const projectionCanarias = generateProjection([-7, 23])\n  const projectionPeninsula = generateProjection([6, 35.5])\n\n  const pathCanarias = generatePath(projectionCanarias)\n  const pathPeninsula = generatePath(projectionPeninsula)\n\n  generateAreas(svgLeft, pathCanarias, 1)\n  generateAreas(svgRight, pathPeninsula, 2)\n}\n\nconst main = async () => {\n  const data = await fetchData()\n\n  if (!data) {\n    return\n  }\n\n  renderChart({\n    data,\n    rootElId: \"chart\",\n  })\n}\n\nexport default main\n","import React from \"react\"\n\nimport { DemoPageProps } from \"@/common\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/spain-map/spain-map\"\n\nconst SpainMap = ({ pageContext }: DemoPageProps) => (\n  <Demo main={main} pageContext={pageContext}>\n    <div id=\"chart\" />\n  </Demo>\n)\n\nexport default SpainMap\n"],"sourceRoot":""}