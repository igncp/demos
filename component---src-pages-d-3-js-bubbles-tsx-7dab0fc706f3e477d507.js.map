{"version":3,"file":"component---src-pages-d-3-js-bubbles-tsx-7dab0fc706f3e477d507.js","mappings":"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","sources":["webpack://demos/./src/demos/bubbles/bubbles.ts","webpack://demos/./src/demos/bubbles/bubbles.module.css","webpack://demos/./src/pages/d3js/bubbles.tsx","webpack://demos/./node_modules/gatsby/node_modules/@babel/runtime/regenerator/index.js","webpack://demos/./node_modules/gatsby/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"],"sourcesContent":["import * as styles from \"./bubbles.module.css\"\n\nconst CONTAINER_ID = \"chart\"\n\nconst fetchScript = (src: string) =>\n  new Promise((resolve) => {\n    const script = document.createElement(\"script\")\n\n    script.setAttribute(\"type\", \"text/javascript\")\n    script.setAttribute(\"src\", src)\n    script.onload = resolve\n\n    document.body.appendChild(script)\n  })\n\nconst fetchLink = (href: string) =>\n  new Promise((resolve) => {\n    const link = document.createElement(\"link\")\n\n    link.onload = resolve\n\n    link.href = href\n    link.setAttribute(\"rel\", \"stylesheet\")\n    link.setAttribute(\"type\", \"text/css\")\n\n    document.head.appendChild(link)\n  })\n\nconst fetchDependencies = async () => {\n  await Promise.all([\n    fetchLink(`${ROOT_PATH}vendors/nvd3/nv.d3.min.css`),\n    (async () => {\n      await fetchScript(`${ROOT_PATH}vendors/d3/d3.min.js`)\n      await fetchScript(`${ROOT_PATH}vendors/nvd3/nv.d3.min.js`)\n    })(),\n  ])\n}\n\ntype JsonData = Array<{\n  activityId: string\n  activityTimeZone: string\n  activityType: string\n  deviceType: string\n  links: unknown\n  metricSummary: {\n    calories: string\n    distance: string\n    duration: string\n    fuel: string\n    steps: string\n  }\n  metrics: unknown\n  startTime: string\n  status: string\n  tags: unknown\n}>\n\nconst durationToMinutes = (str: string) => {\n  const strParts = str.split(\":\")\n\n  return (\n    60 * Number(strParts[0]) + Number(strParts[1]) + Number(strParts[2]) / 60\n  )\n}\n\nconst margin = {\n  bottom: 100,\n  left: 100,\n  right: 100,\n  top: 100,\n}\n\nconst fetchData = async () => {\n  const response = await fetch(`${ROOT_PATH}data/d3js/bubbles/data.json`)\n  const jsonData = await response.json()\n\n  return jsonData.data\n}\n\ntype RenderChart = (o: { jsonData: JsonData; rootElId: string }) => void\n\nconst renderChart: RenderChart = ({ jsonData, rootElId }) => {\n  const { d3, nv } = window as any // eslint-disable-line @typescript-eslint/no-explicit-any\n\n  const rootEl = document.getElementById(rootElId) as HTMLElement\n\n  rootEl.classList.add(styles.bubblesChart)\n\n  const { width } = rootEl.getBoundingClientRect()\n\n  const color = d3.scale.category20b()\n\n  const chartData = [\n    {\n      key: \"Data\",\n      // eslint-disable-next-line id-denylist\n      values: jsonData.map((...[jsonItem, jsonItemIndex]) => {\n        const distance = +jsonItem.metricSummary.distance\n        const time = durationToMinutes(jsonItem.metricSummary.duration)\n        const pace = time / distance\n\n        return {\n          color: color(distance),\n          jsonItem,\n          size: distance,\n          x: jsonData.length - jsonItemIndex,\n          y: pace,\n        }\n      }),\n    },\n  ]\n\n  type ChartData = typeof chartData\n  type ChartDataItem = ChartData[0][\"values\"][0]\n\n  const chart = nv.models.scatterChart()\n\n  chart.margin(margin)\n\n  nv.utils.windowResize(chart.update)\n\n  chart.forceY([4.5, 6.5]).forceX([0, 135])\n\n  chart.tooltipContent(\n    (...[, , , obj]: [unknown, unknown, unknown, { point: ChartDataItem }]) =>\n      `${obj.point.size.toFixed(1)} km - ${obj.point.jsonItem.deviceType}`\n  )\n  chart.xAxis\n    .axisLabelDistance(45)\n    .tickFormat(d3.format(\"f\"))\n    .axisLabel(\"Person Number\")\n  chart.yAxis\n    .tickFormat(d3.format(\".2f\"))\n    .axisLabelDistance(10)\n    .axisLabel(\"Pace (min/km)\")\n\n  d3.select(`#${rootElId}`)\n    .append(\"svg\")\n    .attr(\"width\", width)\n    .datum(chartData)\n    .call(chart)\n}\n\nconst main = async () => {\n  const [jsonData] = await Promise.all([fetchData(), fetchDependencies()])\n\n  renderChart({\n    jsonData,\n    rootElId: CONTAINER_ID,\n  })\n}\n\nexport { CONTAINER_ID }\n\nexport default main\n","// extracted by mini-css-extract-plugin\nexport var bubblesChart = \"bubbles-module--bubblesChart--5KhpF\";","import React from \"react\"\n\nimport { DemoPageProps } from \"@/common\"\n\nimport Demo from \"@/components/demo\"\n\nimport main, { CONTAINER_ID } from \"@/demos/bubbles/bubbles\"\n\nconst Bubbles = ({ pageContext }: DemoPageProps) => (\n  <Demo main={main} pageContext={pageContext}>\n    <div id={CONTAINER_ID} style={{ height: 600 }} />\n  </Demo>\n)\n\nexport default Bubbles\n","module.exports = require(\"regenerator-runtime\");\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}"],"names":["CONTAINER_ID","fetchScript","src","Promise","resolve","script","document","createElement","setAttribute","onload","body","appendChild","fetchLink","href","link","head","fetchDependencies","all","ROOT_PATH","durationToMinutes","str","strParts","split","Number","margin","bottom","left","right","top","fetchData","fetch","response","json","jsonData","data","renderChart","rootElId","window","d3","nv","rootEl","getElementById","classList","add","width","getBoundingClientRect","color","scale","category20b","chartData","key","values","map","jsonItem","jsonItemIndex","distance","metricSummary","time","duration","pace","size","x","length","y","chart","models","scatterChart","utils","windowResize","update","forceY","forceX","tooltipContent","obj","point","toFixed","deviceType","xAxis","axisLabelDistance","tickFormat","format","axisLabel","yAxis","select","append","attr","datum","call","pageContext","main","id","style","height","module","exports","asyncGeneratorStep","gen","reject","_next","_throw","arg","info","value","error","done","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined"],"sourceRoot":""}