{"version":3,"file":"component---src-pages-d-3-js-fish-eye-tsx-6bb4310ebd1fe0f93b5b.js","mappings":"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","sources":["webpack://demos/./src/demos/_utils/fish-eye.ts","webpack://demos/./src/demos/fish-eye/fish-eye.module.css","webpack://demos/./src/demos/fish-eye/fish-eye.ts","webpack://demos/./src/pages/d3js/fish-eye.tsx","webpack://demos/./node_modules/gatsby/node_modules/@babel/runtime/regenerator/index.js","webpack://demos/./node_modules/gatsby/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"],"sourcesContent":["import { extent } from \"d3\"\n\nfunction createFishEyeScale({\n  initialDistortion,\n  initialFocus,\n  scale,\n}: {\n  initialDistortion: number\n  initialFocus: number\n  scale: any // eslint-disable-line @typescript-eslint/no-explicit-any\n}) {\n  let distortion = initialDistortion\n  let focus = initialFocus\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const fishEyeScale = (xValue: any): number => {\n    const x = scale(xValue)\n    const isLeft = x < focus\n    const range = extent<number>(scale.range()) as [number, number]\n    const min = range[0]\n    const max = range[1]\n\n    const focusDiff = isLeft ? focus - min : max - focus\n    const diff = focusDiff === 0 ? max - min : focusDiff\n\n    return (\n      ((isLeft ? -1 : 1) * diff * (distortion + 1)) /\n        (distortion + diff / Math.abs(x - focus)) +\n      focus\n    )\n  }\n\n  fishEyeScale.distortion = (newDistortion: number) => {\n    distortion = newDistortion\n\n    return fishEyeScale\n  }\n\n  fishEyeScale.focus = (newFocus: number) => {\n    focus = newFocus\n\n    return fishEyeScale\n  }\n\n  fishEyeScale.copy = () =>\n    createFishEyeScale({\n      initialDistortion,\n      initialFocus,\n      scale: scale.copy(),\n    })\n\n  fishEyeScale.domain = (...args: [[number, number]] | []) => {\n    const domainResult = scale.domain(...args)\n\n    return domainResult === scale ? fishEyeScale : domainResult\n  }\n\n  fishEyeScale.range = (...args: [[number, number]] | []) => {\n    const rangeResult = scale.range(...args)\n\n    return rangeResult === scale ? fishEyeScale : rangeResult\n  }\n\n  fishEyeScale.nice = scale.nice\n  fishEyeScale.ticks = scale.ticks\n  fishEyeScale.tickFormat = scale.tickFormat\n\n  return fishEyeScale\n}\n\nexport type FishEyeScale = ReturnType<typeof createFishEyeScale>\n\n// https://github.com/d3/d3-plugins/blob/master/fisheye/fisheye.js\nconst d3Fisheye = {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  scale(createScale: any): FishEyeScale {\n    return createFishEyeScale({\n      initialDistortion: 3,\n      initialFocus: 0,\n      scale: createScale(),\n    })\n  },\n}\n\nexport default d3Fisheye\n","// extracted by mini-css-extract-plugin\nexport var fishEyeChart = \"fish-eye-module--fishEyeChart--r1OJ9\";\nexport var axis = \"fish-eye-module--axis--2iiOh\";\nexport var background = \"fish-eye-module--background--1I5aD\";\nexport var chartTitle = \"fish-eye-module--chartTitle--z6BaN\";\nexport var pointer = \"fish-eye-module--pointer--BU8Qx\";","import {\n  Axis,\n  ScaleOrdinal,\n  ScalePower,\n  Selection,\n  axisBottom,\n  axisLeft,\n  format,\n  json,\n  pointer as pointerD3,\n  scaleLinear,\n  scaleLog,\n  scaleOrdinal,\n  scaleSqrt,\n  schemePastel2,\n  select,\n} from \"d3\"\n\nimport d3Fisheye, { FishEyeScale } from \"@/demos/_utils/fish-eye\"\n\nimport * as styles from \"./fish-eye.module.css\"\n\nconst CONTAINER_ID = \"chart\"\n\ntype IncomeMetric = {\n  income: number\n  lifeExpectancy: number\n  name: string\n  population: number\n  region: string\n}\n\nconst fetchData = async (): Promise<IncomeMetric[] | undefined> =>\n  json(`${ROOT_PATH}data/d3js/fish-eye/data.json`)\n\nconst humanizeNumber = (initialN: number): string => {\n  let numStr = initialN.toString()\n\n  while (true) {\n    const numStrFormatted = numStr.replace(/(\\d)(\\d{3})($|,|\\.)/g, \"$1,$2$3\")\n\n    if (numStrFormatted === numStr) {\n      break\n    }\n\n    numStr = numStrFormatted\n  }\n\n  return numStr\n}\n\nconst margin = {\n  bottom: 70,\n  left: 70,\n  right: 50,\n  top: 80,\n}\nconst height = 700 - margin.top - margin.bottom\n\ntype FishEyeChartOpts = {\n  incomeMetrics: IncomeMetric[]\n  rootElId: string\n}\n\nclass FishEyeChart {\n  private readonly rootElId: string\n  private readonly incomeMetrics: IncomeMetric[]\n\n  private width!: number\n\n  private dom!: {\n    dot?: Selection<SVGCircleElement, IncomeMetric, SVGGElement, unknown>\n    pointer?: Selection<SVGTextElement, unknown, HTMLElement, unknown>\n    svg: Selection<SVGGElement, unknown, HTMLElement, unknown>\n    xAxis?: Axis<IncomeMetric[\"income\"]>\n    yAxis?: Axis<IncomeMetric[\"lifeExpectancy\"]>\n  }\n\n  private vars!: {\n    colorScale: ScaleOrdinal<string, string>\n    focused: boolean\n    radiusScale: ScalePower<number, number>\n    xScale: FishEyeScale\n    yScale: FishEyeScale\n  }\n\n  public constructor({ incomeMetrics, rootElId }: FishEyeChartOpts) {\n    this.rootElId = rootElId\n    this.incomeMetrics = incomeMetrics\n\n    this.setupRootEl()\n    this.setVars()\n    this.setDom()\n  }\n\n  public render() {\n    this.setChartTitle()\n    this.setBackground()\n    this.setPointer()\n    this.setFilter()\n    this.setAxis()\n    this.setLabels()\n    this.setDots()\n    this.setTitles()\n    this.bindMousemove()\n    this.bindClick()\n  }\n\n  private setupRootEl() {\n    const rootEl = document.getElementById(this.rootElId) as HTMLElement\n\n    rootEl.classList.add(styles.fishEyeChart)\n\n    this.width =\n      rootEl.getBoundingClientRect().width - margin.left - margin.right\n  }\n\n  private setDom() {\n    this.dom = {\n      svg: select(`#${this.rootElId}`)\n        .append(\"svg\")\n        .attr(\"width\", this.width + margin.left + margin.right)\n        .attr(\"height\", height + margin.top + margin.bottom)\n        .append(\"g\")\n        .attr(\"transform\", `translate(${margin.left},${margin.top})`),\n    }\n  }\n\n  private setChartTitle() {\n    this.dom.svg\n      .append(\"text\")\n      .attr(\"class\", styles.chartTitle)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"transform\", `translate(${this.width / 2},-40)`)\n      .text(\n        \"Income Per Capita vs \" +\n          \"Life Expectancy vs Population vs Region - 180 Countries\"\n      )\n      .style(\"font-weight\", \"bold\")\n  }\n\n  private setVars() {\n    const colorScale = scaleOrdinal<string>()\n      .domain([\n        \"Sub-Saharan Africa\",\n        \"South Asia\",\n        \"Middle East & North Africa\",\n        \"America\",\n        \"Europe & Central Asia\",\n        \"East Asia & Pacific\",\n      ])\n      .range(schemePastel2)\n\n    const radiusScale = scaleSqrt().domain([0, 5e8]).range([5, 60])\n    const xScale = d3Fisheye\n      .scale(scaleLog)\n      .domain([300, 1e5])\n      .range([0, this.width])\n    const yScale = d3Fisheye\n      .scale(scaleLinear)\n      .domain([20, 90])\n      .range([height, 0])\n\n    this.vars = {\n      colorScale,\n      focused: false,\n      radiusScale,\n      xScale,\n      yScale,\n    }\n  }\n\n  private setAxis() {\n    this.dom.xAxis = axisBottom<IncomeMetric[\"population\"]>(this.vars.xScale)\n      .tickFormat(format(\",d\"))\n      .tickSize(-height)\n    this.dom.yAxis = axisLeft<IncomeMetric[\"income\"]>(\n      this.vars.yScale\n    ).tickSize(-this.width)\n    this.dom.svg\n      .append(\"g\")\n      .attr(\"class\", `x ${styles.axis}`)\n      .attr(\"transform\", `translate(0,${height})`)\n      .call(this.dom.xAxis)\n    this.dom.svg\n      .append(\"g\")\n      .attr(\"class\", `y ${styles.axis}`)\n      .call(this.dom.yAxis)\n  }\n\n  private setBackground() {\n    return this.dom.svg\n      .append(\"rect\")\n      .attr(\"class\", styles.background)\n      .attr(\"width\", this.width)\n      .attr(\"height\", height)\n  }\n\n  private setLabels() {\n    this.dom.svg\n      .append(\"text\")\n      .attr(\"class\", \"x label\")\n      .attr(\"text-anchor\", \"end\")\n      .attr(\"x\", this.width - 26)\n      .attr(\"y\", height + 26)\n      .text(\"income per capita, inflation-adjusted (dollars)\")\n\n    this.dom.svg\n      .append(\"text\")\n      .attr(\"class\", \"y label\")\n      .attr(\"text-anchor\", \"end\")\n      .attr(\"x\", -26)\n      .attr(\"y\", -40)\n      .attr(\"dy\", \".75em\")\n      .attr(\"transform\", \"rotate(-90)\")\n      .text(\"life expectancy (years)\")\n  }\n\n  private setFilter() {\n    const defs = this.dom.svg.append(\"defs\")\n    const filter = defs.append(\"filter\").attr(\"id\", `drop-shadow-circles`)\n\n    filter\n      .attr(\"height\", \"500%\")\n      .attr(\"width\", \"500%\")\n      .attr(\"x\", \"-200%\")\n      .attr(\"y\", \"-200%\")\n\n    filter\n      .append(\"feOffset\")\n      .attr(\"dx\", 0.5)\n      .attr(\"dy\", 0.5)\n      .attr(\"in\", \"SourceGraphic\")\n      .attr(\"result\", \"offOut\")\n\n    filter\n      .append(\"feGaussianBlur\")\n      .attr(\"in\", \"offOut\")\n      .attr(\"result\", \"blurOut\")\n      .attr(\"stdDeviation\", 1.5)\n\n    filter\n      .append(\"feBlend\")\n      .attr(\"in\", \"SourceGraphic\")\n      .attr(\"in2\", \"blurOut\")\n      .attr(\"mode\", \"normal\")\n\n    filter\n      .append(\"feComponentTransfer\")\n      .append(\"feFuncA\")\n      .attr(\"slope\", 0.6)\n      .attr(\"type\", \"linear\")\n  }\n\n  private position() {\n    this.dom\n      .dot!.attr(\"cx\", (incomeMetric) => this.vars.xScale(incomeMetric.income))\n      .attr(\"cy\", (incomeMetric) =>\n        this.vars.yScale(incomeMetric.lifeExpectancy)\n      )\n      .attr(\"r\", (incomeMetric) =>\n        this.vars.radiusScale(incomeMetric.population)\n      )\n  }\n\n  private setDots() {\n    this.dom.dot = this.dom.svg\n      .append(\"g\")\n      .attr(\"class\", \"dots\")\n      .selectAll(\".dot\")\n      .data<IncomeMetric>(this.incomeMetrics)\n      .enter()\n      .append(\"circle\")\n      .attr(\"class\", \"dot\")\n      .style(\"fill\", (incomeMetric) =>\n        this.vars.colorScale(incomeMetric.region)\n      )\n      .style(\"filter\", \"url(#drop-shadow-circles)\")\n      .style(\"stroke\", \"black\")\n      .style('\"stroke-width\"', \"1px\")\n      .sort(\n        (...[incomeMetricA, incomeMetricB]) =>\n          incomeMetricB.population - incomeMetricA.population\n      )\n\n    this.position()\n  }\n\n  private setTitles() {\n    this.dom\n      .dot!.append(\"title\")\n      .text(\n        (incomeMetric) =>\n          `${incomeMetric.name}:\\n- Income: ${humanizeNumber(\n            incomeMetric.income\n          )} $/P.C.\\n` +\n          `- Population: ${humanizeNumber(incomeMetric.population)}\\n` +\n          `- Life expectancy: ${incomeMetric.lifeExpectancy} years`\n      )\n  }\n\n  private zoom(ev: Event) {\n    const mouse = pointerD3(ev)\n\n    this.vars.xScale.distortion(2.5).focus(mouse[0])\n    this.vars.yScale.distortion(2.5).focus(mouse[1])\n    this.position()\n\n    this.dom.svg.select<SVGGElement>(`.x.${styles.axis}`).call(this.dom.xAxis!)\n    this.dom.svg.select<SVGGElement>(`.y.${styles.axis}`).call(this.dom.yAxis!)\n  }\n\n  private setPointer() {\n    this.dom.pointer = this.dom.svg\n      .append(\"text\")\n      .text(\"+\")\n      .attr(\"class\", styles.pointer)\n  }\n\n  private bindMousemove() {\n    return this.dom.svg.on(\"mousemove\", (ev) => {\n      if (!this.vars.focused) {\n        this.zoom(ev)\n      }\n    })\n  }\n\n  private bindClick() {\n    this.dom.svg.on(\"click\", (ev: Event) => {\n      this.vars.focused = !this.vars.focused\n\n      if (this.vars.focused) {\n        const pointer = pointerD3(this)\n\n        this.dom\n          .pointer!.attr(\"x\", pointer[0])\n          .attr(\"y\", pointer[1])\n          .style(\"opacity\", 1)\n\n        return\n      }\n\n      this.dom.pointer!.style(\"opacity\", 0)\n\n      this.zoom(ev)\n    })\n  }\n}\n\nconst main = async () => {\n  const incomeMetrics = await fetchData()\n\n  const chart = new FishEyeChart({\n    incomeMetrics: incomeMetrics as IncomeMetric[],\n    rootElId: CONTAINER_ID,\n  })\n\n  chart.render()\n}\n\nexport { CONTAINER_ID }\n\nexport default main\n","import React from \"react\"\n\nimport { DemoPageProps } from \"@/common\"\n\nimport Demo from \"@/components/demo\"\n\nimport main, { CONTAINER_ID } from \"@/demos/fish-eye/fish-eye\"\n\nconst FishEye = ({ pageContext }: DemoPageProps) => (\n  <Demo main={main} pageContext={pageContext}>\n    <div id={CONTAINER_ID} />\n  </Demo>\n)\n\nexport default FishEye\n","module.exports = require(\"regenerator-runtime\");\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}"],"names":["createFishEyeScale","initialDistortion","initialFocus","scale","distortion","focus","fishEyeScale","xValue","x","isLeft","range","extent","min","max","focusDiff","diff","Math","abs","newDistortion","newFocus","copy","domain","domainResult","rangeResult","nice","ticks","tickFormat","createScale","axis","CONTAINER_ID","fetchData","json","ROOT_PATH","humanizeNumber","initialN","numStr","toString","numStrFormatted","replace","margin","height","FishEyeChart","incomeMetrics","rootElId","this","setupRootEl","setVars","setDom","render","setChartTitle","setBackground","setPointer","setFilter","setAxis","setLabels","setDots","setTitles","bindMousemove","bindClick","rootEl","document","getElementById","classList","add","width","getBoundingClientRect","dom","svg","select","append","attr","text","style","colorScale","scaleOrdinal","schemePastel2","radiusScale","scaleSqrt","xScale","d3Fisheye","scaleLog","yScale","scaleLinear","vars","focused","xAxis","axisBottom","format","tickSize","yAxis","axisLeft","styles","call","filter","position","dot","incomeMetric","income","lifeExpectancy","population","selectAll","data","enter","region","sort","incomeMetricA","incomeMetricB","name","zoom","ev","mouse","pointerD3","pointer","on","main","pageContext","id","module","exports","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined"],"sourceRoot":""}