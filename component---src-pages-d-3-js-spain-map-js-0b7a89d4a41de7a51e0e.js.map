{"version":3,"sources":["webpack://demos/./src/demos/spain-map/spain-map.js","webpack://demos/./src/pages/d3js/spain-map.js"],"names":["widthCanarias","$","innerWidth","widthPeninsula","height","margin","d3","json","_error","spain","dataRoot","objects","data1","data","topojson","feature","features","_","map","d","i","index","colorsScheme","colorScale","scale","linear","domain","geometries","length","range","colorScaleConversion","colorFn","addDropShadowFilter","id","svg","deviation","slope","filter","append","attr","in","stdDeviation","dx","dy","type","feMerge","select","generateSvg","width","style","String","generateProjection","center","geo","mercator","translate","generatePath","projection","path","mouseover","this","fill","mouseleave","generateAreas","svgComp","filterId","selectAll","enter","stroke","on","svgLeft","svgRight","projectionCanarias","projectionPeninsula","pathCanarias","pathPeninsula","demoInfo","pageContext","main","scripts","className"],"mappings":"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","file":"component---src-pages-d-3-js-spain-map-js-0b7a89d4a41de7a51e0e.js","sourcesContent":["const main = () => {\n  const widthCanarias = $(\"#chart\").innerWidth() / 3.5\n  const widthPeninsula = $(\"#chart\").innerWidth() - widthCanarias - 10\n  const height = 500\n  const margin = {\n    bottom: 20,\n    top: 50,\n  }\n  const strokeWidth = 0.4\n\n  d3.json(\"/data/d3js/spain-map/data.json\", (_error, spain) => {\n    const dataRoot = spain.objects.data1\n    const data = topojson.feature(spain, dataRoot).features\n\n    _.map(data, (d, i) => {\n      d.index = i\n    })\n\n    const colorsScheme = [\"#323247\", \"#7C7CC9\", \"#72B66C\", \"#429742\"]\n    const colorScale = d3.scale\n      .linear()\n      .domain([0, dataRoot.geometries.length])\n      .range([0, 1])\n    const colorScaleConversion = d3.scale\n      .linear()\n      .domain(d3.range(0, 1, 1.0 / colorsScheme.length))\n      .range(colorsScheme)\n\n    const colorFn = function (d) {\n      return colorScaleConversion(colorScale(d.index))\n    }\n\n    const addDropShadowFilter = function (id, svg, deviation, slope) {\n      const defs = svg.append(\"defs\")\n      const filter = defs.append(\"filter\").attr(\"id\", `drop-shadow-${id}`)\n\n      filter.append(\"feGaussianBlur\").attr({\n        in: \"SourceAlpha\",\n        stdDeviation: deviation,\n      })\n      filter.append(\"feOffset\").attr({\n        dx: 1,\n        dy: 1,\n      })\n      filter.append(\"feComponentTransfer\").append(\"feFuncA\").attr({\n        slope,\n        type: \"linear\",\n      })\n\n      const feMerge = filter.append(\"feMerge\")\n\n      feMerge.append(\"feMergeNode\")\n\n      return feMerge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\")\n    }\n\n    const svg = d3.select(\"#chart\")\n\n    const generateSvg = function (width) {\n      return svg\n        .append(\"div\")\n        .style(\"display\", \"inline-block\")\n        .style(\"height\", `${height + margin.top + margin.bottom}px`)\n        .style(\"width\", `${width}px`)\n        .append(\"svg:svg\")\n        .attr(\"width\", width)\n        .attr(\"height\", height + margin.top + margin.bottom)\n        .append(\"svg:g\")\n        .attr(\n          \"transform\",\n          `translate(${width / 2},${String(height / 2 + margin.top)})`\n        )\n    }\n\n    const generateProjection = function (center) {\n      return d3.geo\n        .mercator()\n        .center(center)\n        .scale(2650)\n        .translate([widthPeninsula / 2, height / 2])\n    }\n\n    const generatePath = function (projection) {\n      return d3.geo.path().projection(projection)\n    }\n\n    const mouseover = function () {\n      return d3.select(this).style({\n        fill: \"#FFB61A\",\n        \"stroke-width\": \"1px\",\n      })\n    }\n\n    const mouseleave = function () {\n      return d3.select(this).style({\n        fill: colorFn,\n        \"stroke-width\": strokeWidth,\n      })\n    }\n\n    const generateAreas = function (svgComp, path, filterId) {\n      return svgComp\n        .selectAll(\".area\")\n        .data(data)\n        .enter()\n        .append(\"path\")\n        .attr({\n          d: path,\n        })\n        .style({\n          fill: colorFn,\n          stroke: \"#FFF\",\n          \"stroke-width\": strokeWidth,\n        })\n        .style(\"filter\", () => `url(#drop-shadow-${filterId})`)\n        .on(\"mouseover\", mouseover)\n        .on(\"mouseleave\", mouseleave)\n    }\n\n    const svgLeft = generateSvg(widthCanarias)\n    const svgRight = generateSvg(widthPeninsula)\n\n    addDropShadowFilter(1, svgLeft, 2, 0.3)\n    addDropShadowFilter(2, svgRight, 2, 0.3)\n\n    const projectionCanarias = generateProjection([-7, 23])\n    const projectionPeninsula = generateProjection([6, 35.5])\n\n    const pathCanarias = generatePath(projectionCanarias)\n    const pathPeninsula = generatePath(projectionPeninsula)\n\n    generateAreas(svgLeft, pathCanarias, 1)\n    generateAreas(svgRight, pathPeninsula, 2)\n  })\n}\n\nexport default main\n","import React from \"react\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/spain-map/spain-map\"\n\nconst SpainMap = ({ pageContext: { demoInfo } }) => (\n  <Demo\n    demoInfo={demoInfo}\n    main={main}\n    scripts={[\"/vendors/d3/d3.min.js\", \"/vendors/topojson/topojson.js\"]}\n  >\n    <div className=\"spain-map-chart\" id=\"chart\" />\n  </Demo>\n)\n\nexport default SpainMap\n"],"sourceRoot":""}