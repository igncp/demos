
  <!DOCTYPE html>
  <html>
    <head>
      <title>page-data.json</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">public/page-data/d3js/population-circles/page-data.json</td><td class="">100.00%</td><td class="">95%</td><td class="">0</td><td class="">0</td><td class="">0</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">{&quot;componentChunkName&quot;:&quot;component---src-pages-d-3-js-population-circles-tsx&quot;,&quot;path&quot;:&quot;/d3js/population-circles/&quot;,&quot;result&quot;:{&quot;pageContext&quot;:{&quot;demoInfo&quot;:{&quot;dataFiles&quot;:[&quot;data.json&quot;],&quot;docs&quot;:[[&quot;d3-scale API reference&quot;,&quot;https://github.com/d3/d3-scale#api-reference&quot;],[&quot;d3-scale Types&quot;,&quot;https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/d3-scale/index.d.ts&quot;],[&quot;d3-hierarchy API reference&quot;,&quot;https://github.com/d3/d3-hierarchy#api-reference&quot;],[&quot;d3-hierarchy Types&quot;,&quot;https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/d3-hierarchy/index.d.ts&quot;],[&quot;d3-selection API reference&quot;,&quot;https://github.com/d3/d3-selection#api-reference&quot;],[&quot;d3-selection Types&quot;,&quot;https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/d3-selection/index.d.ts&quot;],[&quot;d3-scale-chromatic API reference&quot;,&quot;https://github.com/d3/d3-scale-chromatic#api-reference&quot;],[&quot;d3-scale-chromatic Types&quot;,&quot;https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/d3-scale-chromatic/index.d.ts&quot;],[&quot;d3-transition API reference&quot;,&quot;https://github.com/d3/d3-transition#api-reference&quot;],[&quot;d3-transition Types&quot;,&quot;https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/d3-transition/index.d.ts&quot;],[&quot;d3-zoom API reference&quot;,&quot;https://github.com/d3/d3-zoom#api-reference&quot;],[&quot;d3-zoom Types&quot;,&quot;https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/d3-zoom/index.d.ts&quot;],[&quot;animejs API reference&quot;,&quot;https://animejs.com/documentation/&quot;],[&quot;animejs Types&quot;,&quot;https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/animejs/index.d.ts&quot;],[&quot;viewBox SVG attribute&quot;,&quot;https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/viewBox&quot;]],&quot;isCompleted&quot;:true,&quot;name&quot;:&quot;Population Circles&quot;,&quot;notes&quot;:[&quot;It has transitions for nested elements: by using enter/exist/transition approach plus (new) `.data(d =&gt; d)`&quot;,&quot;Click a circle while pressing the Control key to open a search window for a municipality&quot;,&quot;The population JSON data has been parsed and saved in the file to rename properties and remove unused&quot;,&quot;You can use the mouse to zoom&quot;,&quot;TODO: Fix zooming function&quot;,&quot;TODO: Review checklist&quot;],&quot;sources&quot;:[&quot;https://observablehq.com/@d3/bubble-chart?collection=@d3/d3-hierarchy&quot;,&quot;https://datos.gob.es/en/catalogo/ea0010587-malaga-poblacion-por-municipios-y-sexo-anual-cifras-oficiales-de-poblacion-de-los-municipios-espanoles-revision-del-padron-municipal-identificador-api-2882&quot;],&quot;summary&quot;:[],&quot;category&quot;:&quot;d3js&quot;,&quot;files&quot;:{&quot;cssModule&quot;:&quot;.radio {\n  cursor: pointer;\n  display: inline-block;\n\n  input {\n    margin-right: 5px;\n  }\n\n  input,\n  label {\n    cursor: pointer;\n  }\n}\n\n.slider {\n  margin-bottom: 20px;\n\n  div {\n    background-color: lightblue;\n  }\n}\n\n.circle {\n  fill-opacity: 0.8;\n  stroke-width: 0;\n}\n\n.header {\n  font-size: 20px;\n}\n&quot;,&quot;demo&quot;:[{&quot;content&quot;:&quot;import { select } from \&quot;d3\&quot;\nimport hotkeys from \&quot;hotkeys-js\&quot;\n\nimport { renderChart } from \&quot;./population-circles-chart\&quot;\nimport {\n  Municipality,\n  createChartConfig,\n  createState,\n  fetchData,\n} from \&quot;./population-circles-chart-data\&quot;\n\nconst main = async () =&gt; {\n  hotkeys(\&quot;control\&quot;, () =&gt; {})\n\n  const municipalities = await fetchData()\n\n  const state = createState()\n  const chartConfig = createChartConfig({ municipalities, state })\n\n  const { updateChart } = renderChart&lt;Municipality&gt;(chartConfig)\n\n  select(\&quot;form\&quot;).on(\&quot;change\&quot;, (changeEvent) =&gt; {\n    state.populationType = changeEvent.target.value\n    updateChart()\n  })\n\n  $(\&quot;.population-slider\&quot;).slider({\n    change: (...[, { values: populationValues }]) =&gt; {\n      const newValues = (populationValues as [number, number]).map(\n        (v) =&gt; v / 100\n      ) as [number, number]\n\n      state.populationRange = newValues\n      updateChart()\n    },\n    range: true,\n    values: [0, 100], // eslint-disable-line id-denylist\n  })\n\n  const max = municipalities[0].metrics.total.length - 1\n\n  $(\&quot;.time-slider\&quot;).slider({\n    change: (...[, { value: timeRangeIndex }]) =&gt; {\n      state.timeRangeIndex = timeRangeIndex as number\n      updateChart()\n    },\n    max,\n    min: 0,\n    value: 0, // eslint-disable-line id-denylist\n  })\n}\n\nexport default main\n&quot;,&quot;fileName&quot;:&quot;population-circles&quot;},{&quot;content&quot;:&quot;import { json } from \&quot;d3\&quot;\nimport hotkeys from \&quot;hotkeys-js\&quot;\nimport qs from \&quot;query-string\&quot;\n\nimport { ChartConfig } from \&quot;./population-circles-chart\&quot;\n\ntype PopulationRecord = {\n  count: number\n  date: string\n}\n\nexport type Municipality = {\n  metrics: {\n    females: PopulationRecord[]\n    males: PopulationRecord[]\n    total: PopulationRecord[]\n  }\n  name: string\n}\n\ntype PopulationType = keyof Municipality[\&quot;metrics\&quot;]\n\ntype State = {\n  populationRange: [number, number]\n  populationType: PopulationType\n  timeRangeIndex: number\n}\n\nexport const createState = (): State =&gt; ({\n  populationRange: [0, 1],\n  populationType: \&quot;total\&quot;,\n  timeRangeIndex: 0,\n})\n\nexport const fetchData = async () =&gt; {\n  type OriginalMunicipality = {\n    [key in keyof Omit&lt;Municipality, \&quot;metrics\&quot;&gt;]: Municipality[key]\n  } &amp; {\n    values: Municipality[\&quot;metrics\&quot;] // eslint-disable-line id-denylist\n  }\n\n  const originalMunicipalities = (await (json(\n    `${ROOT_PATH}data/d3js/population-circles/data.json`\n  ) as unknown)) as OriginalMunicipality[]\n\n  /* eslint-disable id-denylist */\n  return originalMunicipalities.map(({ values, ...otherProps }) =&gt; ({\n    ...otherProps,\n    metrics: values,\n  }))\n  /* eslint-enable id-denylist */\n}\n\nconst formatPopulation = (populationNum: number) =&gt;\n  Number(populationNum.toFixed(0)).toLocaleString(undefined, {\n    maximumFractionDigits: 0,\n    minimumFractionDigits: 0,\n  })\n\nconst typeNouns: Record&lt;string, string&gt; = {\n  females: \&quot;females\&quot;,\n  males: \&quot;males\&quot;,\n  total: \&quot;people\&quot;,\n}\n\nconst getYearStr = (dateStr: string) =&gt; new Date(dateStr).getFullYear()\n\nexport const createChartConfig = ({\n  municipalities,\n  state,\n}: {\n  municipalities: Municipality[]\n  state: State\n}): ChartConfig&lt;Municipality&gt; =&gt; {\n  type Config = ChartConfig&lt;Municipality&gt;\n\n  const colorDomain = municipalities.map((municipality) =&gt; municipality.name)\n  const getStringForColor = (municipality: Municipality) =&gt; municipality.name\n\n  const getEmptyItem = (): Municipality =&gt; ({\n    metrics: {\n      females: [],\n      males: [],\n      total: [],\n    },\n    name: \&quot;\&quot;,\n  })\n\n  const getItemMetric: Config[\&quot;getItemMetric\&quot;] = (\n    municipality: Municipality\n  ) =&gt; {\n    if (!(municipality.metrics as unknown)) {\n      return 1\n    }\n\n    const {\n      metrics: {\n        [state.populationType]: { [state.timeRangeIndex]: valueItem },\n      },\n    } = municipality\n\n    return !(valueItem as unknown) ? 0 : valueItem.count\n  }\n\n  const getChartItems: Config[\&quot;getChartItems\&quot;] = () =&gt; {\n    const { populationRange, populationType, timeRangeIndex } = state\n    const itemsWithCount = municipalities.filter((municipality) =&gt; {\n      const {\n        metrics: {\n          [populationType]: { [timeRangeIndex]: valueItem },\n        },\n      } = municipality\n\n      return !!(valueItem as unknown)\n    })\n\n    const dataValues = itemsWithCount.map((municipality) =&gt; {\n      const {\n        metrics: {\n          [populationType]: { [timeRangeIndex]: dataItem },\n        },\n      } = municipality\n\n      return dataItem.count\n    })\n\n    const valueToIdx = dataValues.reduce((...[acc, valueItem, valueIndex]) =&gt; {\n      acc[valueItem] = acc[valueIndex] ?? []\n      acc[valueItem]!.push(valueIndex)\n\n      return acc\n    }, {} as Record&lt;string, number[] | undefined&gt;)\n\n    const sortedDataValues = dataValues.sort(\n      (...[municipalityAValue, municipalityBValue]) =&gt;\n        municipalityAValue - municipalityBValue\n    )\n\n    const percentiles = sortedDataValues.reduce(\n      (...[percentilesAcc, valueItem, valueIndex]) =&gt; {\n        const percentile = valueIndex / sortedDataValues.length\n        const { [valueItem]: unsortedIndexes } = valueToIdx\n\n        unsortedIndexes!.forEach((unsortedValueIndex: number) =&gt; {\n          percentilesAcc[unsortedValueIndex] = percentile\n        })\n\n        return percentilesAcc\n      },\n      [] as number[]\n    )\n\n    return itemsWithCount.filter((...[, percentileIndex]) =&gt; {\n      const { [percentileIndex]: percentile } = percentiles\n\n      return (\n        typeof percentile === \&quot;number\&quot; &amp;&amp;\n        percentile &gt;= populationRange[0] &amp;&amp;\n        percentile &lt;= populationRange[1]\n      )\n    })\n  }\n\n  const getHeaderText: Config[\&quot;getHeaderText\&quot;] = ({ chartItems }) =&gt; {\n    const {\n      metrics: {\n        [state.populationType]: {\n          [state.timeRangeIndex]: { date },\n        },\n      },\n    } = chartItems[0]\n\n    const year = getYearStr(date)\n\n    const populationTotal = chartItems.reduce(\n      (...[acc, circleData]) =&gt;\n        acc +\n        circleData.metrics[state.populationType][state.timeRangeIndex].count,\n      0\n    )\n\n    const populationText = `${formatPopulation(populationTotal)} ${\n      typeNouns[state.populationType]\n    }`\n\n    const { length: totalNum } = chartItems.filter(\n      (chartItem) =&gt;\n        chartItem.metrics[state.populationType].length &gt;=\n        state.timeRangeIndex + 1\n    )\n\n    return `Population in Malaga: ${year} - ${populationText}${\n      state.populationRange[0] === 0 &amp;&amp; state.populationRange[1] === 1\n        ? \&quot;\&quot;\n        : ` - From ${(state.populationRange[0] * 100).toFixed(\n            0\n          )} percentile to ${(state.populationRange[1] * 100).toFixed(\n            0\n          )} percentile`\n    } - ${totalNum} municipalities`\n  }\n\n  const getItemId: Config[\&quot;getItemId\&quot;] = (municipality) =&gt; municipality.name\n\n  const getItemTitle: Config[\&quot;getItemTitle\&quot;] = ({ circleData }) =&gt; {\n    const {\n      metrics: {\n        [state.populationType]: { [state.timeRangeIndex]: valueItem },\n      },\n    } = circleData\n\n    if (!valueItem as unknown) {\n      return \&quot;\&quot;\n    }\n\n    const { [state.populationType]: itemsName } = typeNouns\n\n    return `${circleData.name} - ${formatPopulation(\n      valueItem.count\n    )} ${itemsName} - ${getYearStr(valueItem.date)}`\n  }\n\n  const getItemLabel: Config[\&quot;getItemLabel\&quot;] = (municipality) =&gt;\n    municipality.name[0]!\n\n  const getIsSmall = () =&gt; state.populationType !== \&quot;total\&quot;\n\n  const onClick: Config[\&quot;onClick\&quot;] = (municipality) =&gt; {\n    if (!hotkeys.isPressed(\&quot;control\&quot;)) {\n      return\n    }\n\n    window.open(\n      `https://www.google.com/search?${qs.stringify({\n        q: `Malaga ${municipality.name}`,\n      })}`\n    )\n  }\n\n  return {\n    colorDomain,\n    getChartItems,\n    getEmptyItem,\n    getHeaderText,\n    getIsSmall,\n    getItemId,\n    getItemLabel,\n    getItemMetric,\n    getItemTitle,\n    getStringForColor,\n    onClick,\n    rootElId: \&quot;chart\&quot;,\n  }\n}\n&quot;,&quot;fileName&quot;:&quot;population-circles-chart-data&quot;},{&quot;content&quot;:&quot;import anime from \&quot;animejs\&quot;\nimport chroma from \&quot;chroma-js\&quot;\nimport {\n  BaseType,\n  D3ZoomEvent,\n  HierarchyCircularNode,\n  Selection,\n  Transition,\n  easeCircleInOut,\n  easeSinInOut,\n  hierarchy,\n  pack,\n  scaleOrdinal,\n  schemeSet3,\n  select,\n  zoom,\n} from \&quot;d3\&quot;\n\nimport * as styles from \&quot;./population-circles.module.css\&quot;\n\nconst dropShadowBaseId = \&quot;dropShadowBase\&quot;\n\nconst margin = {\n  bottom: 0,\n  left: 0,\n  right: 0,\n  top: 70,\n}\nconst height = 400\n\nexport type ChartConfig&lt;CircleData&gt; = {\n  colorDomain: string[]\n  getChartItems: () =&gt; CircleData[]\n  getEmptyItem: () =&gt; CircleData\n  getHeaderText: (o: { chartItems: CircleData[] }) =&gt; string\n  getIsSmall: () =&gt; boolean\n  getItemId: (circleData: CircleData) =&gt; string\n  getItemLabel: (circleData: CircleData) =&gt; string\n  getItemMetric: (circleData: CircleData) =&gt; number\n  getItemTitle: (o: { circleData: CircleData }) =&gt; string\n  getStringForColor: (circleData: CircleData) =&gt; string\n  onClick: (m: CircleData) =&gt; void\n  rootElId: string\n}\n\ntype RenderChartReturn = {\n  updateChart: () =&gt; void\n}\n\ntype AddDropShadow = (o: {\n  deviation: number\n  name: string\n  slope: number\n  svg: Selection&lt;SVGSVGElement, unknown, HTMLElement, unknown&gt;\n}) =&gt; void\n\nconst addDropShadow: AddDropShadow = ({ deviation, name, slope, svg }) =&gt; {\n  svg.append(\&quot;filter\&quot;).html(`\n&lt;filter id=\&quot;${name}\&quot; height=\&quot;130%\&quot;&gt;\n  &lt;feGaussianBlur in=\&quot;SourceAlpha\&quot; stdDeviation=\&quot;${deviation}\&quot;/&gt;\n  &lt;feOffset dx=\&quot;2\&quot; dy=\&quot;2\&quot; result=\&quot;offsetblur\&quot;/&gt;\n  &lt;feComponentTransfer&gt;\n    &lt;feFuncA type=\&quot;linear\&quot; slope=\&quot;${slope}\&quot;/&gt;\n  &lt;/feComponentTransfer&gt;\n  &lt;feMerge&gt;\n    &lt;feMergeNode/&gt;\n    &lt;feMergeNode in=\&quot;SourceGraphic\&quot;/&gt;\n  &lt;/feMerge&gt;\n&lt;/filter&gt;\n`)\n}\n\nexport const renderChart = &lt;CircleData&gt;(\n  chartConfig: ChartConfig&lt;CircleData&gt;\n): RenderChartReturn =&gt; {\n  type ChartNode = HierarchyCircularNode&lt;CircleData&gt;\n\n  const chartEl = document.getElementById(chartConfig.rootElId) as HTMLElement\n  const { width } = chartEl.getBoundingClientRect()\n\n  const lastPosition = { k: 1, x: 0, y: 0 }\n\n  // this zoom function is not working well in all directions\n  // eslint-disable-next-line max-params\n  const zoomed = function (\n    this: SVGSVGElement,\n    zoomEvent: D3ZoomEvent&lt;SVGSVGElement, unknown&gt;\n  ) {\n    const transition = select(this).transition().duration(150)\n    let {\n      transform: { x, y },\n    } = zoomEvent\n    const {\n      transform: { k },\n    } = zoomEvent\n\n    if (k !== lastPosition.k) {\n      x = lastPosition.x\n      y = lastPosition.y\n    }\n\n    transition.attr(\&quot;transform\&quot;, `translate(${x}, ${y}) scale(${k})`)\n\n    lastPosition.k = k\n    lastPosition.x = x\n    lastPosition.y = y\n  }\n\n  const color = scaleOrdinal&lt;string, string&gt;()\n    .domain(chartConfig.colorDomain)\n    .range(schemeSet3)\n\n  const zoomBehavior = zoom&lt;SVGSVGElement, unknown&gt;()\n    .extent([\n      [0, 0],\n      [width / 2, height / 2],\n    ])\n    .on(\&quot;end\&quot;, zoomed)\n\n  const svg = select(`#${chartConfig.rootElId}`)\n    .append(\&quot;svg\&quot;)\n    .attr(\&quot;viewBox\&quot;, [0, 0, width, height + margin.top].join(\&quot;, \&quot;))\n    .attr(\&quot;font-size\&quot;, 10)\n    .attr(\&quot;font-family\&quot;, \&quot;sans-serif\&quot;)\n    .attr(\&quot;text-anchor\&quot;, \&quot;middle\&quot;)\n    .call(zoomBehavior)\n\n  addDropShadow({ deviation: 2, name: dropShadowBaseId, slope: 0.5, svg })\n\n  const header = svg\n    .append(\&quot;text\&quot;)\n    .attr(\&quot;class\&quot;, styles.header)\n    .text(\&quot;\&quot;)\n    .attr(\&quot;transform\&quot;, `translate(${width / 2}, 50)`)\n\n  const svgContent = svg\n    .append(\&quot;g\&quot;)\n    .attr(\&quot;transform\&quot;, `translate(${margin.left}, ${margin.top})`)\n\n  const transitionChart = () =&gt; {\n    const filteredData = chartConfig.getChartItems()\n    const hoverAnimations: { [k: string]: anime.AnimeInstance | null } = {}\n\n    const structure = hierarchy({\n      ...chartConfig.getEmptyItem(),\n      children: filteredData,\n    }).sum(chartConfig.getItemMetric)\n\n    const isSmall = chartConfig.getIsSmall()\n\n    const root = pack&lt;CircleData&gt;()\n      .size(isSmall ? [width / 2, height / 2] : [width, height])\n      .padding(3)(structure)\n\n    const leaves = root.leaves()\n\n    header.text(\n      chartConfig.getHeaderText({\n        chartItems: filteredData,\n      })\n    )\n\n    const getDataKey = (node: unknown) =&gt;\n      chartConfig.getItemId((node as HierarchyCircularNode&lt;CircleData&gt;).data)\n\n    const leaf = svgContent.selectAll(\&quot;.leaf\&quot;).data(leaves, getDataKey)\n\n    leaf.exit().remove()\n\n    const getTitle = (node: HierarchyCircularNode&lt;CircleData&gt;) =&gt;\n      chartConfig.getItemTitle({\n        circleData: node.data,\n      })\n\n    leaf\n      .attr(\&quot;title\&quot;, getTitle)\n      .transition()\n      .duration(1000)\n      .ease(easeCircleInOut)\n      .attr(\&quot;transform\&quot;, (chartNode) =&gt; {\n        if (isSmall) {\n          return `translate(${chartNode.x + width / 4},${\n            chartNode.y + height / 4\n          })`\n        }\n\n        return `translate(${chartNode.x + 1},${chartNode.y + 1})`\n      })\n\n    const enter = leaf\n      .enter()\n      .append(\&quot;g\&quot;)\n      .attr(\&quot;class\&quot;, \&quot;leaf\&quot;)\n      .attr(\&quot;title\&quot;, getTitle)\n      .attr(\&quot;transform\&quot;, (node) =&gt; `translate(${node.x + 1},${node.y + 1})`)\n      .on(\&quot;mouseenter\&quot;, function (...[, node]) {\n        const selection = select(this).select(`.${styles.circle}`)\n\n        select(this)\n          .select(\&quot;.letter\&quot;)\n          .attr(\&quot;filter\&quot;, `url(#${dropShadowBaseId})`)\n\n        const id = chartConfig.getItemId(node.data)\n\n        const hoverAnimation = anime({\n          complete: () =&gt; {\n            hoverAnimations[id] = null\n          },\n          strokeWidth: \&quot;5px\&quot;,\n          targets: [selection.node()],\n        })\n\n        hoverAnimations[id] = hoverAnimation\n      })\n      .on(\&quot;mouseleave\&quot;, function (...[, node]) {\n        const selection = select(this).select(`.${styles.circle}`)\n\n        select(this).select(\&quot;.letter\&quot;).attr(\&quot;filter\&quot;, null)\n\n        const id = chartConfig.getItemId(node.data)\n        const { [id]: hoverAnimation } = hoverAnimations\n\n        if (hoverAnimation) {\n          hoverAnimation.seek(0)\n          anime.remove(selection.node())\n          hoverAnimations[id] = null\n        }\n\n        anime({\n          strokeWidth: \&quot;0px\&quot;,\n          targets: [selection.node()],\n        })\n      })\n      .on(\&quot;click\&quot;, (...[, node]) =&gt; {\n        chartConfig.onClick(node.data)\n      })\n\n    const generateColor = (node: HierarchyCircularNode&lt;CircleData&gt;) =&gt;\n      color(chartConfig.getStringForColor(node.data))\n\n    const generateDarkerColor = (node: ChartNode) =&gt; {\n      const baseColor = generateColor(node)\n\n      return chroma(baseColor).darken(1.5).hex()\n    }\n\n    type ChartTransition = Transition&lt;BaseType, ChartNode, BaseType, ChartNode&gt;\n\n    const setupLetter = (\n      letter:\n        | ChartTransition\n        | Selection&lt;SVGTextElement, ChartNode, SVGGElement, unknown&gt;\n    ) =&gt; {\n      const letterSelection = letter.text((node) =&gt;\n        chartConfig.getItemLabel(node.data)\n      ) as ChartTransition\n\n      letterSelection\n        .style(\&quot;font-size\&quot;, (node) =&gt; `${node.r.toFixed(0)}px`)\n        .attr(\&quot;dy\&quot;, (node) =&gt; node.r / 3)\n        .attr(\&quot;fill\&quot;, generateDarkerColor)\n    }\n\n    const setupCircle = (\n      circle:\n        | ChartTransition\n        | Selection&lt;SVGCircleElement, ChartNode, SVGGElement, unknown&gt;\n    ) =&gt; {\n      const elem = circle.attr(\&quot;r\&quot;, (node) =&gt; node.r!) as ChartTransition\n\n      elem.attr(\&quot;fill\&quot;, generateColor).attr(\&quot;stroke\&quot;, generateDarkerColor)\n    }\n\n    setupCircle(enter.append(\&quot;circle\&quot;).attr(\&quot;class\&quot;, styles.circle))\n\n    setupLetter(enter.append(\&quot;text\&quot;).attr(\&quot;class\&quot;, \&quot;letter\&quot;))\n\n    const forwardData = (node: ChartNode) =&gt; node\n\n    const circles = leaf\n      .selectAll(`.${styles.circle}`)\n      .data(forwardData, getDataKey)\n    const texts = leaf.selectAll(\&quot;.letter\&quot;).data(forwardData, getDataKey)\n\n    setupCircle(circles.transition().duration(1000).ease(easeSinInOut))\n\n    setupLetter(texts.transition().duration(1000).ease(easeSinInOut))\n\n    $(\&quot;.leaf\&quot;).tooltip({\n      track: true,\n    })\n  }\n\n  transitionChart()\n\n  return {\n    updateChart: transitionChart,\n  }\n}\n&quot;,&quot;fileName&quot;:&quot;population-circles-chart&quot;}],&quot;page&quot;:{&quot;content&quot;:&quot;import React from \&quot;react\&quot;\n\nimport { DemoPageProps } from \&quot;@/common\&quot;\n\nimport Demo from \&quot;@/components/demo\&quot;\n\nimport main from \&quot;@/demos/population-circles/population-circles\&quot;\nimport * as styles from \&quot;@/demos/population-circles/population-circles.module.css\&quot;\n\nconst PopulationCircles = ({ pageContext }: DemoPageProps) =&gt; (\n  &lt;Demo\n    links={[\&quot;/vendors/jquery-ui/themes/base/jquery-ui.min.css\&quot;]}\n    main={main}\n    pageContext={pageContext}\n    scripts={[\&quot;/vendors/jquery-ui/jquery-ui.min.js\&quot;]}\n  &gt;\n    &lt;form&gt;\n      {[\n        { id: \&quot;total\&quot;, label: \&quot;Total\&quot; },\n        { id: \&quot;males\&quot;, label: \&quot;Males\&quot; },\n        { id: \&quot;females\&quot;, label: \&quot;Females\&quot; },\n      ].map((...[{ id, label }, radioIndex]) =&gt; (\n        &lt;div className={styles.radio} key={id}&gt;\n          &lt;input\n            defaultChecked={radioIndex === 0}\n            id={id}\n            name=\&quot;type\&quot;\n            type=\&quot;radio\&quot;\n            value={id}\n          /&gt;\n          &lt;label htmlFor={id}&gt;{label}&lt;/label&gt;\n        &lt;/div&gt;\n      ))}\n    &lt;/form&gt;\n    &lt;div className={styles.slider}&gt;\n      &lt;p&gt;Time&lt;/p&gt;\n      &lt;div className=\&quot;time-slider\&quot; /&gt;\n    &lt;/div&gt;\n    &lt;div className={styles.slider}&gt;\n      &lt;p&gt;Population Percentile&lt;/p&gt;\n      &lt;div className=\&quot;population-slider\&quot; /&gt;\n    &lt;/div&gt;\n    &lt;div id=\&quot;chart\&quot; /&gt;\n  &lt;/Demo&gt;\n)\n\nexport default PopulationCircles\n&quot;,&quot;type&quot;:&quot;tsx&quot;}},&quot;key&quot;:&quot;population-circles&quot;},&quot;meta&quot;:{&quot;description&quot;:&quot;&quot;}}},&quot;staticQueryHashes&quot;:[]}</textarea><pre id="annotations" style="display:none">[]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Wed, 01 Sep 2021 08:00:00 GMT</p>
    </body>
  </html>
  