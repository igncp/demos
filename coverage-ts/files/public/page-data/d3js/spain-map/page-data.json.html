
  <!DOCTYPE html>
  <html>
    <head>
      <title>page-data.json</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">public/page-data/d3js/spain-map/page-data.json</td><td class="">100.00%</td><td class="">95%</td><td class="">0</td><td class="">0</td><td class="">0</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">{&quot;componentChunkName&quot;:&quot;component---src-pages-d-3-js-spain-map-tsx&quot;,&quot;path&quot;:&quot;/d3js/spain-map/&quot;,&quot;result&quot;:{&quot;pageContext&quot;:{&quot;demoInfo&quot;:{&quot;dataFiles&quot;:[&quot;data.json&quot;],&quot;docs&quot;:[],&quot;isCompleted&quot;:true,&quot;name&quot;:&quot;Spanish Map&quot;,&quot;notes&quot;:[&quot;For this chart I reused the code from the World Map chart and other demos&quot;,&quot;Added drop shadow for 3D effect&quot;],&quot;sources&quot;:[&quot;http://www.diva-gis.org/datadown&quot;],&quot;summary&quot;:[],&quot;category&quot;:&quot;d3js&quot;,&quot;files&quot;:{&quot;cssModule&quot;:&quot;&quot;,&quot;demo&quot;:[{&quot;content&quot;:&quot;import { renderChart } from \&quot;./spain-map-chart\&quot;\nimport {\n  Properties,\n  createChartConfig,\n  fetchAreasData,\n} from \&quot;./spain-map-chart-data\&quot;\n\nconst main = async () =&gt; {\n  const areasData = await fetchAreasData()\n  const chartConfig = createChartConfig(areasData)\n\n  renderChart&lt;Properties&gt;(chartConfig)\n}\n\nexport default main\n&quot;,&quot;fileName&quot;:&quot;spain-map&quot;},{&quot;content&quot;:&quot;import { json } from \&quot;d3\&quot;\n\nimport { AreasData, ChartConfig } from \&quot;./spain-map-chart\&quot;\n\nexport type Properties = {\n  ENGTYPE_3: string // e.g. Comarca\n  HASC_3: string\n  ID_0: number\n  ID_1: number\n  ID_2: number\n  ID_3: number\n  ISO: string // e.g. ESP\n  NAME_0: string // e.g. Spain\n  NAME_1: string // e.g. Castilla y Leon\n  NAME_2: string // e.g. Leon\n  NAME_3: string // Sometimes not defined, with &#x27;n.a.&#x27;\n  NL_NAME_3: string\n  REMARKS_3: string\n  Shape_Area: number // eslint-disable-line camelcase\n  Shape_Leng: number // eslint-disable-line camelcase\n  TYPE_3: string // e.g. Comarca\n  VALIDFR_3: string\n  VALIDTO_3: string\n}\n\ntype Config = ChartConfig&lt;Properties&gt;\n\nconst getTitleText: Config[\&quot;getTitleText\&quot;] = (areaProperties) =&gt;\n  [\n    (areaProperties.NAME_3 || \&quot;\&quot;).includes(\&quot;n.a.\&quot;) ? \&quot;\&quot; : areaProperties.NAME_3,\n    areaProperties.NAME_2,\n    areaProperties.NAME_1,\n  ]\n    .filter((v) =&gt; !!v)\n    .join(\&quot;, \&quot;)\n\nconst getWidths: Config[\&quot;getWidths\&quot;] = (chartWidth) =&gt; {\n  const widthCanarias = chartWidth / 3.5\n  const widthPeninsula = chartWidth - widthCanarias - 10\n\n  return [widthCanarias, widthPeninsula]\n}\n\nconst projectionsCenters: Config[\&quot;projectionsCenters\&quot;] = [\n  [-13, 23],\n  [10, 35.5],\n]\n\nexport const createChartConfig = (areasData: AreasData): Config =&gt; ({\n  areasData,\n  getTitleText,\n  getWidths,\n  projectionsCenters,\n  rootElId: \&quot;chart\&quot;,\n})\n\nexport const fetchAreasData = () =&gt;\n  (json(\n    `${ROOT_PATH}data/d3js/spain-map/data.json`\n  ) as unknown) as Promise&lt;AreasData&gt;\n&quot;,&quot;fileName&quot;:&quot;spain-map-chart-data&quot;},{&quot;content&quot;:&quot;import {\n  BaseType,\n  GeoPath,\n  GeoPermissibleObjects,\n  GeoProjection,\n  Selection,\n  geoMercator,\n  geoPath,\n  range,\n  scaleLinear,\n  select,\n} from \&quot;d3\&quot;\nimport { GeoJsonProperties } from \&quot;geojson\&quot;\nimport { feature } from \&quot;topojson-client\&quot;\nimport { Objects, Topology } from \&quot;topojson-specification\&quot;\nimport { v1 as uuidv1 } from \&quot;uuid\&quot;\n\nconst colorsScheme = [\&quot;#323247\&quot;, \&quot;#7C7CC9\&quot;, \&quot;#72B66C\&quot;, \&quot;#429742\&quot;]\nconst height = 500\nconst margin = {\n  bottom: 20,\n  top: 50,\n}\nconst strokeWidth = 0.4\n\ntype SVG = Selection&lt;BaseType, unknown, HTMLElement, unknown&gt;\n\nconst addDropShadowFilter = ({\n  deviation,\n  id,\n  slope,\n  svg,\n}: {\n  deviation: number\n  id: number\n  slope: number\n  svg: SVG\n}) =&gt; {\n  const defs = svg.append(\&quot;defs\&quot;)\n  const filter = defs.append(\&quot;filter\&quot;).attr(\&quot;id\&quot;, `drop-shadow-${id}`)\n\n  filter\n    .append(\&quot;feGaussianBlur\&quot;)\n    .attr(\&quot;in\&quot;, \&quot;SourceAlpha\&quot;)\n    .attr(\&quot;stdDeviation\&quot;, deviation)\n\n  filter.append(\&quot;feOffset\&quot;).attr(\&quot;dx\&quot;, 1).attr(\&quot;dy\&quot;, 1)\n  filter\n    .append(\&quot;feComponentTransfer\&quot;)\n    .append(\&quot;feFuncA\&quot;)\n    .attr(\&quot;slope\&quot;, slope)\n    .attr(\&quot;type\&quot;, \&quot;linear\&quot;)\n\n  const feMerge = filter.append(\&quot;feMerge\&quot;)\n\n  feMerge.append(\&quot;feMergeNode\&quot;)\n\n  feMerge.append(\&quot;feMergeNode\&quot;).attr(\&quot;in\&quot;, \&quot;SourceGraphic\&quot;)\n}\n\nexport type AreasData = Topology&lt;Objects&lt;GeoJsonProperties&gt;&gt;\n\nexport type ChartConfig&lt;Properties&gt; = {\n  areasData: AreasData\n  getTitleText: (o: Properties) =&gt; string\n  getWidths: (chartWidth: number) =&gt; number[]\n  projectionsCenters: Array&lt;[number, number]&gt;\n  rootElId: string\n}\n\nexport const renderChart = &lt;Properties&gt;(\n  chartConfig: ChartConfig&lt;Properties&gt;\n) =&gt; {\n  const { areasData, rootElId } = chartConfig\n\n  type DataShape = GeoPermissibleObjects &amp; {\n    areaIndex: number\n    properties: Properties\n  }\n\n  const { width: chartWidth } = (document.getElementById(\n    rootElId\n  ) as HTMLElement).getBoundingClientRect()\n\n  const {\n    objects: { data1: dataRoot },\n  } = areasData\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const { features: dataGeo } = feature(areasData, dataRoot) as any\n\n  const dataGeoParsed = dataGeo.map(\n    (...[areaData, areaIndex]: [DataShape, number]) =&gt; ({\n      ...areaData,\n      areaIndex,\n    })\n  )\n\n  const colorScale = scaleLinear()\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    .domain([0, (dataRoot as any).geometries.length])\n    .range([0, 1])\n  const colorScaleConversion = scaleLinear&lt;string&gt;()\n    .domain(range(0, 1, 1.0 / colorsScheme.length))\n    .range(colorsScheme)\n\n  const colorFn = function (areaData: DataShape) {\n    return colorScaleConversion(colorScale(areaData.areaIndex))\n  }\n\n  const svg = select(`#${rootElId}`)\n\n  const generateSvg = function (width: number) {\n    return svg\n      .append(\&quot;div\&quot;)\n      .style(\&quot;display\&quot;, \&quot;inline-block\&quot;)\n      .style(\&quot;height\&quot;, `${height + margin.top + margin.bottom}px`)\n      .style(\&quot;width\&quot;, `${width}px`)\n      .append(\&quot;svg:svg\&quot;)\n      .attr(\&quot;width\&quot;, width)\n      .attr(\&quot;height\&quot;, height + margin.top + margin.bottom)\n      .append(\&quot;svg:g\&quot;)\n      .attr(\&quot;transform\&quot;, `translate(${width / 2},${height / 2 + margin.top})`)\n  }\n\n  const generatePath = function (projection: GeoProjection) {\n    return geoPath().projection(projection)\n  }\n\n  const regionClass = `region-${uuidv1().slice(0, 6)}`\n\n  const generateAreas = ({\n    filterId,\n    path,\n    svgComp,\n  }: {\n    filterId: number\n    path: GeoPath&lt;SVGPathElement&gt;\n    svgComp: SVG\n  }) =&gt; {\n    svgComp\n      .selectAll(\&quot;.area\&quot;)\n      .data&lt;DataShape&gt;(dataGeoParsed)\n      .enter()\n      .append(\&quot;path\&quot;)\n      .attr(\&quot;d\&quot;, path)\n      .style(\&quot;fill\&quot;, colorFn)\n      .style(\&quot;stroke\&quot;, \&quot;#FFF\&quot;)\n      .style(\&quot;stroke-width\&quot;, strokeWidth)\n      .style(\&quot;filter\&quot;, () =&gt; `url(#drop-shadow-${filterId})`)\n      .on(\&quot;mouseover\&quot;, function () {\n        return select(this)\n          .style(\&quot;fill\&quot;, \&quot;#FFB61A\&quot;)\n          .style(\&quot;stroke-width\&quot;, \&quot;1px\&quot;)\n      })\n      .on(\&quot;mouseleave\&quot;, function () {\n        return select&lt;SVGPathElement, DataShape&gt;(this)\n          .style(\&quot;fill\&quot;, colorFn)\n          .style(\&quot;stroke-width\&quot;, strokeWidth)\n      })\n      .attr(\&quot;title\&quot;, (areaData) =&gt;\n        chartConfig.getTitleText(areaData.properties)\n      )\n      .attr(\&quot;class\&quot;, regionClass)\n  }\n\n  const widths = chartConfig.getWidths(chartWidth)\n\n  const generateProjection = (\n    ...[center, centerIndex]: [[number, number], number]\n  ) =&gt;\n    geoMercator()\n      .center(center)\n      .scale(2650)\n      .translate([widths[centerIndex] / 2, height / 2])\n\n  const svgs = widths.map(generateSvg)\n\n  svgs.forEach((...[svgItem, svgItemIndex]) =&gt; {\n    addDropShadowFilter({\n      deviation: 2,\n      id: svgItemIndex + 1,\n      slope: 0.3,\n      svg: svgItem,\n    })\n  })\n\n  const projections = chartConfig.projectionsCenters.map(generateProjection)\n  const paths = projections.map(generatePath)\n\n  svgs.forEach((...[svgItem, svgItemIndex]) =&gt; {\n    generateAreas({\n      filterId: svgItemIndex + 1,\n      path: paths[svgItemIndex],\n      svgComp: svgItem,\n    })\n  })\n\n  $(`.${regionClass}`).tooltip({\n    track: true,\n  })\n}\n&quot;,&quot;fileName&quot;:&quot;spain-map-chart&quot;}],&quot;page&quot;:{&quot;content&quot;:&quot;import React from \&quot;react\&quot;\n\nimport { DemoPageProps } from \&quot;@/common\&quot;\n\nimport Demo from \&quot;@/components/demo\&quot;\n\nimport main from \&quot;@/demos/spain-map/spain-map\&quot;\n\nconst SpainMap = ({ pageContext }: DemoPageProps) =&gt; (\n  &lt;Demo\n    links={[\&quot;/vendors/jquery-ui/themes/base/jquery-ui.min.css\&quot;]}\n    main={main}\n    pageContext={pageContext}\n    scripts={[\&quot;/vendors/jquery-ui/jquery-ui.min.js\&quot;]}\n  &gt;\n    &lt;div id=\&quot;chart\&quot; /&gt;\n  &lt;/Demo&gt;\n)\n\nexport default SpainMap\n&quot;,&quot;type&quot;:&quot;tsx&quot;}},&quot;key&quot;:&quot;spain-map&quot;},&quot;meta&quot;:{&quot;description&quot;:&quot;Example of a geographic map using D3.js, where some styles have been added to give it a 3D effect.&quot;}}},&quot;staticQueryHashes&quot;:[]}</textarea><pre id="annotations" style="display:none">[]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Sun, 22 Aug 2021 23:05:07 GMT</p>
    </body>
  </html>
  