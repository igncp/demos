
  <!DOCTYPE html>
  <html>
    <head>
      <title>page-data.json</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">public/page-data/d3js/chord/page-data.json</td><td class="">100.00%</td><td class="">95%</td><td class="">0</td><td class="">0</td><td class="">0</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">{&quot;componentChunkName&quot;:&quot;component---src-pages-d-3-js-chord-tsx&quot;,&quot;path&quot;:&quot;/d3js/chord/&quot;,&quot;result&quot;:{&quot;pageContext&quot;:{&quot;demoInfo&quot;:{&quot;dataFiles&quot;:[&quot;data.csv&quot;],&quot;docs&quot;:[],&quot;isCompleted&quot;:true,&quot;name&quot;:&quot;Chord&quot;,&quot;notes&quot;:[&quot;Added filters with drop shadow and low opacity&quot;,&quot;Changed scheme and match each color with a country&quot;],&quot;sources&quot;:[&quot;http://bl.ocks.org/mbostock/1308257&quot;],&quot;summary&quot;:[],&quot;category&quot;:&quot;d3js&quot;,&quot;files&quot;:{&quot;cssModule&quot;:&quot;.chordChart {\n  path.chord {\n    fill-opacity: 0.75;\n    stroke-width: 0.75;\n  }\n\n  .chartTitle {\n    font-weight: bold;\n  }\n\n  .group text {\n    font: 11px sans-serif;\n    pointer-events: none;\n  }\n\n  .group path {\n    stroke: #000;\n  }\n\n  .headingTitle {\n    font-size: 15px;\n    font-weight: bold;\n  }\n}\n&quot;,&quot;demo&quot;:[{&quot;content&quot;:&quot;import {\n  BaseType,\n  Selection,\n  arc as arcD3,\n  chord,\n  csv,\n  descending,\n  extent,\n  format,\n  range,\n  rgb,\n  ribbon,\n  scaleLinear,\n  select,\n} from \&quot;d3\&quot;\n\nimport * as styles from \&quot;./chord.module.css\&quot;\n\ntype CSVDataItem = {\n  amount: string\n  creditor: string\n  debtor: string\n  risk: string\n}\n\ntype Country = {\n  id: number\n  name: string\n}\n\ntype Creditor = Country\ntype Debtor = Country &amp; { risk: string }\n\ntype CSVParsedItem = {\n  amount: string\n  creditor: Creditor\n  debtor: Debtor\n  risk: string\n}\n\ntype Debits = Array&lt;Array&lt;CSVParsedItem | null&gt;&gt;\ntype Credits = Array&lt;Array&lt;CSVParsedItem | null&gt;&gt;\n\ntype Data = {\n  credits: Credits\n  debits: Debits\n  fullList: Country[]\n}\n\nconst fetchData = async () =&gt; {\n  const list = (await csv(\n    `${ROOT_PATH}data/d3js/chord/data.csv`\n  )) as CSVDataItem[]\n\n  const fullList: Country[] = []\n  const countries: Record&lt;string, Country&gt; = {}\n  const debits: Debits = []\n  const credits: Credits = []\n\n  let id = 0\n\n  const country = function (countryName: string): Country {\n    if (!(countryName in countries)) {\n      countries[countryName] = {\n        id,\n        name: countryName,\n      }\n\n      id += 1\n    }\n\n    return countries[countryName]\n  }\n\n  const parsedList: CSVParsedItem[] = list.map((d) =&gt; ({\n    ...d,\n    creditor: country(d.creditor),\n    debtor: {\n      ...country(d.debtor),\n      risk: d.risk,\n    },\n  }))\n\n  Array.from({ length: id }).forEach((_, idx) =&gt; {\n    debits[idx] = []\n    credits[idx] = []\n\n    Array.from({ length: id }).forEach((_2, idx2) =&gt; {\n      debits[idx][idx2] = null\n      credits[idx][idx2] = null\n    })\n  })\n\n  parsedList.forEach((d) =&gt; {\n    debits[d.creditor.id][d.debtor.id] = d\n    credits[d.debtor.id][d.creditor.id] = d\n    fullList[d.creditor.id] = d.creditor\n    fullList[d.debtor.id] = d.debtor\n  })\n\n  return {\n    credits,\n    debits,\n    fullList,\n  }\n}\n\nconst addDropShadowFilter = function &lt;A&gt;(\n  charts: Selection&lt;BaseType, A, BaseType, unknown&gt;,\n  name: string,\n  deviation: number,\n  slope: number\n) {\n  const defs = charts.append(\&quot;defs\&quot;)\n  const filter = defs.append(\&quot;filter\&quot;).attr(\&quot;id\&quot;, `drop-shadow-${name}`)\n\n  filter\n    .append(\&quot;feOffset\&quot;)\n    .attr(\&quot;dx\&quot;, 0.5)\n    .attr(\&quot;dy\&quot;, 0.5)\n    .attr(\&quot;in\&quot;, \&quot;SourceGraphic\&quot;)\n    .attr(\&quot;result\&quot;, \&quot;offOut\&quot;)\n\n  filter\n    .append(\&quot;feGaussianBlur\&quot;)\n    .attr(\&quot;in\&quot;, \&quot;offOut\&quot;)\n    .attr(\&quot;result\&quot;, \&quot;blurOut\&quot;)\n    .attr(\&quot;stdDeviation\&quot;, deviation)\n\n  filter\n    .append(\&quot;feBlend\&quot;)\n    .attr(\&quot;in\&quot;, \&quot;SourceGraphic\&quot;)\n    .attr(\&quot;in2\&quot;, \&quot;blurOut\&quot;)\n    .attr(\&quot;mode\&quot;, \&quot;normal\&quot;)\n\n  filter\n    .append(\&quot;feComponentTransfer\&quot;)\n    .append(\&quot;feFuncA\&quot;)\n    .attr(\&quot;slope\&quot;, slope)\n    .attr(\&quot;type\&quot;, \&quot;linear\&quot;)\n}\n\nconst colours = [\n  \&quot;#39B347\&quot;,\n  \&quot;#C92E47\&quot;,\n  \&quot;#DB704D\&quot;,\n  \&quot;#FFA22C\&quot;,\n  \&quot;#5E92AA\&quot;,\n  \&quot;#F8EDD3\&quot;,\n]\n\nconst margin = {\n  bottom: 20,\n  top: 50,\n}\nconst height = 500\n\ntype RenderChart = (o: { data: Data; rootElId: string }) =&gt; void\n\nconst renderChart: RenderChart = ({ data, rootElId }) =&gt; {\n  const rootEl = document.getElementById(rootElId) as HTMLElement\n\n  rootEl.classList.add(styles.chordChart)\n\n  const width = rootEl.getBoundingClientRect().width / 2 - 20\n\n  const r1 = Math.min(width, height) / 2 - 4\n  const r0 = r1 - 20\n  const formatCurrency = format(\&quot;,.3r\&quot;)\n\n  const arc = arcD3().innerRadius(r0).outerRadius(r1)\n  const svg = select(`#${rootElId}`)\n\n  const { credits, debits, fullList } = data\n\n  const charts = svg\n    .selectAll(\&quot;div\&quot;)\n    .data([debits, credits])\n    .enter()\n    .append(\&quot;div\&quot;)\n    .style(\&quot;display\&quot;, \&quot;inline-block\&quot;)\n    .style(\&quot;width\&quot;, `${width}px`)\n    .style(\&quot;height\&quot;, `${height + margin.top + margin.bottom}px`)\n    .append(\&quot;svg:svg\&quot;)\n    .attr(\&quot;width\&quot;, width)\n    .attr(\&quot;height\&quot;, height + margin.top + margin.bottom)\n    .append(\&quot;svg:g\&quot;)\n    .attr(\&quot;transform\&quot;, `translate(${width / 2},${height / 2 + margin.top})`)\n\n  const leftChart = charts.filter((_d, i) =&gt; i === 0)\n  const rightChart = charts.filter((_d, i) =&gt; i === 1)\n\n  const setLabel = function (\n    chart: Selection&lt;BaseType, Debits, BaseType, unknown&gt;,\n    label: string\n  ) {\n    return chart\n      .append(\&quot;text\&quot;)\n      .text(label)\n      .attr(\&quot;transform\&quot;, `translate(0,${(-1 * height) / 2 - 10})`)\n      .attr(\&quot;class\&quot;, styles.chartTitle)\n      .attr(\&quot;text-anchor\&quot;, \&quot;middle\&quot;)\n  }\n\n  setLabel(leftChart, \&quot;Debits\&quot;)\n  setLabel(rightChart, \&quot;Credits\&quot;)\n\n  addDropShadowFilter(charts, \&quot;chords\&quot;, 2, 0.4)\n  addDropShadowFilter(charts, \&quot;headings\&quot;, 3, 0.5)\n\n  const colorDomain = scaleLinear()\n    .domain(extent([0, fullList.length - 1]) as [number, number])\n    .range([0, 1])\n\n  const heatmapColour = scaleLinear&lt;string&gt;()\n    .domain(range(0, 1, 1.0 / colours.length))\n    .range(colours)\n\n  const fill = function (d: number) {\n    return heatmapColour(colorDomain(d))\n  }\n\n  charts.each(function (dataMatrix, chartIndex) {\n    const svgComp = select(this)\n    const numberMatrix = dataMatrix.map((row) =&gt;\n      row.map((item) =&gt; (item ? +item.amount : 0))\n    )\n\n    const chordData = chord()\n      .sortGroups(descending)\n      .sortSubgroups(descending)\n      .sortChords(descending)(numberMatrix)\n\n    const ribbonLayout = ribbon().radius(r0)\n\n    svgComp\n      .selectAll(`path.${styles.chord}`)\n      .data(chordData)\n      .enter()\n      .append(\&quot;svg:path\&quot;)\n      .attr(\&quot;class\&quot;, styles.chord)\n      .style(\&quot;fill\&quot;, (d) =&gt; fill(d.target.index))\n      .style(\&quot;filter\&quot;, \&quot;url(#drop-shadow-chords)\&quot;)\n      .style(\&quot;stroke\&quot;, (d) =&gt; {\n        const originalColor = fill(d.target.index)\n        const newColor = rgb(originalColor).darker()\n\n        return newColor.formatHex()\n      })\n      .style(\&quot;stroke-width\&quot;, 2)\n      .attr(\&quot;d\&quot;, ribbonLayout as any)\n      .append(\&quot;svg:title\&quot;)\n      .text((d) =&gt; {\n        const { [d.source.index]: sourceData } = fullList\n        const { [d.target.index]: targetData } = fullList\n\n        return `${sourceData.name} owes ${targetData.name} $${formatCurrency(\n          d.source.value\n        )}B.`\n      })\n\n    const g = svgComp\n      .selectAll(`g.${styles.group}`)\n      .data(chordData.groups)\n      .enter()\n      .append(\&quot;svg:g\&quot;)\n      .attr(\&quot;class\&quot;, styles.group)\n\n    g.append(\&quot;svg:path\&quot;)\n      .style(\&quot;fill\&quot;, (d) =&gt; fill(d.index))\n      .attr(\&quot;id\&quot;, (d) =&gt; `group${d.index}-${chartIndex}`)\n      .attr(\&quot;d\&quot;, arc as any)\n      .style(\&quot;filter\&quot;, () =&gt; \&quot;url(#drop-shadow-headings)\&quot;)\n      .append(\&quot;svg:title\&quot;)\n      .text(\n        (d) =&gt;\n          `${fullList[d.index].name} ${\n            chartIndex ? \&quot;owes\&quot; : \&quot;is owed\&quot;\n          } $${formatCurrency(d.value)}B.`\n      )\n\n    g.append(\&quot;svg:text\&quot;)\n      .attr(\&quot;x\&quot;, 6)\n      .attr(\&quot;dy\&quot;, 15)\n      .filter((d) =&gt; d.value &gt; 150)\n      .append(\&quot;svg:textPath\&quot;)\n      .attr(\&quot;xlink:href\&quot;, (d) =&gt; `#group${d.index}-${chartIndex}`)\n      .text((d) =&gt; fullList[d.index].name)\n      .attr(\&quot;class\&quot;, styles.headingTitle)\n  })\n}\n\nconst main = async () =&gt; {\n  const data = await fetchData()\n\n  renderChart({\n    data,\n    rootElId: \&quot;chart\&quot;,\n  })\n}\n\nexport default main\n&quot;,&quot;fileName&quot;:&quot;chord&quot;}],&quot;page&quot;:{&quot;content&quot;:&quot;import React from \&quot;react\&quot;\n\nimport { DemoPageProps } from \&quot;@/common\&quot;\n\nimport Demo from \&quot;@/components/demo\&quot;\n\nimport main from \&quot;@/demos/chord/chord\&quot;\n\nconst Chord = ({ pageContext }: DemoPageProps) =&gt; (\n  &lt;Demo main={main} pageContext={pageContext}&gt;\n    &lt;div id=\&quot;chart\&quot; /&gt;\n  &lt;/Demo&gt;\n)\n\nexport default Chord\n&quot;,&quot;type&quot;:&quot;tsx&quot;}},&quot;key&quot;:&quot;chord&quot;},&quot;meta&quot;:{&quot;description&quot;:&quot;Chord Chart example using D3.js, which has a different color scheme with a color for each country, and a special drop shadow filter for a 3D effect.&quot;}}},&quot;staticQueryHashes&quot;:[]}</textarea><pre id="annotations" style="display:none">[]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Wed, 25 Aug 2021 23:26:40 GMT</p>
    </body>
  </html>
  