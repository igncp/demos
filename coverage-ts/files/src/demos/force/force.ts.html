
  <!DOCTYPE html>
  <html>
    <head>
      <title>force.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">src/demos/force/force.ts</td><td class="">100.00%</td><td class="">95%</td><td class="">327</td><td class="">327</td><td class="">0</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import {
  drag,
  forceCenter,
  forceLink as forceLinkD3,
  forceManyBody,
  forceSimulation,
  json,
  select,
} from &quot;d3&quot;

import * as styles from &quot;./force.module.css&quot;

const CONTAINER_ID = &quot;chart&quot;

type Node = {
  fx: number | null
  fy: number | null
  index: number // eslint-disable-line id-denylist
  name: string
  x: number
  y: number
}

type Link = {
  id: number
  name: string
  source: Node
  target: Node
}

type ForceData = {
  links: Link[]
  nodes: Node[]
}

type CustomDragEvent = DragEvent &amp; { active: boolean }

const fetchForceData = async (): Promise&lt;ForceData&gt; =&gt; {
  const [nodes, links] = await Promise.all([
    json(`${ROOT_PATH}data/d3js/force/nodes.json`),
    json(`${ROOT_PATH}data/d3js/force/links.json`),
  ])

  return {
    links,
    nodes,
  } as ForceData
}

const settings = {
  circleRadius: 5,
  defaultTextOpacity: 0.5,
  strength: -40,
  textDY: 5,
}

const height = 600

type RenderGraph = (chartConfig: {
  forceData: ForceData
  rootElId: string
}) =&gt; void

const renderGraph: RenderGraph = ({ forceData, rootElId }) =&gt; {
  const { links, nodes } = forceData

  const rootEl = document.getElementById(rootElId) as HTMLElement

  rootEl.classList.add(styles.forceChart)

  const { width } = rootEl.getBoundingClientRect()

  const svg = select(`#${rootElId}`)
    .append(&quot;svg&quot;)
    .attr(&quot;width&quot;, width)
    .attr(&quot;height&quot;, height)

  const ticked = () =&gt; {
    /* eslint-disable @typescript-eslint/no-use-before-define */
    updateLinks()
    updateNodes()
    /* eslint-enable @typescript-eslint/no-use-before-define */
  }

  const simulation = forceSimulation(nodes)
    .force(&quot;charge&quot;, forceManyBody().strength(settings.strength))
    .force(&quot;center&quot;, forceCenter(width / 2, height / 2))
    .force(&quot;link&quot;, forceLinkD3().links(links))
    .on(&quot;tick&quot;, ticked)

  const dragstarted = (...[dragEvent, forceNode]: [CustomDragEvent, Node]) =&gt; {
    if (!dragEvent.active) {
      simulation.alphaTarget(0.3).restart()
    }

    forceNode.fx = forceNode.x
    forceNode.fy = forceNode.y
  }

  const dragged = (...[dragEvent, forceNode]: [CustomDragEvent, Node]) =&gt; {
    forceNode.fx = dragEvent.x
    forceNode.fy = dragEvent.y
  }

  const dragended = (...[dragEvent, forceNode]: [CustomDragEvent, Node]) =&gt; {
    if (!dragEvent.active) {
      simulation.alphaTarget(0)
    }

    forceNode.fx = null
    forceNode.fy = null
  }

  const updateLinks = () =&gt; {
    const linksEls = svg
      .selectAll&lt;SVGPathElement, ForceData[&quot;links&quot;]&gt;(`.${styles.linkCurved}`)
      .data(links)

    linksEls
      .enter()
      .append&lt;SVGPathElement&gt;(&quot;path&quot;)
      .merge(linksEls)
      .attr(&quot;d&quot;, (forceLink) =&gt; {
        const dx = forceLink.target.x - forceLink.source.x
        const dy = forceLink.target.y - forceLink.source.y
        const dr = Math.sqrt(dx * dx + dy * dy) * 1.3

        return `M${forceLink.source.x},${forceLink.source.y}A${dr},${dr} 0 0,1 ${forceLink.target.x},${forceLink.target.y}`
      })
      .attr(&quot;class&quot;, styles.linkCurved)

    linksEls.exit().remove()
  }

  const updateNodes = () =&gt; {
    const nodesEls = svg
      .selectAll&lt;SVGCircleElement, ForceData[&quot;nodes&quot;]&gt;(&quot;circle&quot;)
      .data(nodes)
    const textsEls = svg
      .selectAll&lt;SVGTextElement, ForceData[&quot;nodes&quot;]&gt;(&quot;text&quot;)
      .data(nodes)

    nodesEls
      .enter()
      .append(&quot;circle&quot;)
      .merge(nodesEls)
      .attr(&quot;cx&quot;, (forceNode) =&gt; forceNode.x)
      .attr(&quot;cy&quot;, (forceNode) =&gt; forceNode.y)
      .attr(&quot;r&quot;, () =&gt; settings.circleRadius)
      .attr(&quot;fill&quot;, &quot;black&quot;)
      .each(function () {
        select&lt;SVGCircleElement, ForceData[&quot;nodes&quot;][0]&gt;(this)
          .on(&quot;mouseover&quot;, (...[, forceNode]) =&gt; {
            select(`#node-text-${forceNode.index}`).style(&quot;opacity&quot;, 1)
          })
          .on(&quot;mouseleave&quot;, (...[, forceNode]) =&gt; {
            select(`#node-text-${forceNode.index}`).style(
              &quot;opacity&quot;,
              settings.defaultTextOpacity
            )
          })
      })
      .call(
        drag&lt;SVGCircleElement, ForceData[&quot;nodes&quot;][0]&gt;()
          .on(&quot;start&quot;, dragstarted)
          .on(&quot;drag&quot;, dragged)
          .on(&quot;end&quot;, dragended)
      )

    textsEls
      .enter()
      .append(&quot;text&quot;)
      .merge(textsEls)
      .text((forceNode) =&gt; forceNode.name)
      .attr(&quot;x&quot;, (forceNode) =&gt; forceNode.x)
      .attr(&quot;y&quot;, (forceNode) =&gt; forceNode.y)
      .attr(&quot;dy&quot;, () =&gt; settings.textDY)
      .attr(&quot;id&quot;, (forceNode) =&gt; `node-text-${forceNode.index}`)
      .style(&quot;opacity&quot;, settings.defaultTextOpacity)

    nodesEls.exit().remove()
    textsEls.exit().remove()
  }

  svg
    .selectAll(`.${styles.linkCurved}`)
    .data(links)
    .enter()
    .append(&quot;svg:path&quot;)
    .attr(&quot;class&quot;, styles.linkCurved)
    .attr(&quot;marker-end&quot;, &quot;url(#end)&quot;)
    .attr(&quot;id&quot;, (...[, forceLinkIndex]) =&gt; `link-${forceLinkIndex}`)
}

const main = async () =&gt; {
  const forceData = await fetchForceData()

  renderGraph({
    forceData,
    rootElId: CONTAINER_ID,
  })
}

export { CONTAINER_ID }

export default main
</textarea><pre id="annotations" style="display:none">[]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Sun, 19 Sep 2021 20:12:47 GMT</p>
    </body>
  </html>
  