
  <!DOCTYPE html>
  <html>
    <head>
      <title>lines-chart-drag.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">src/demos/map-distorsions/lines-chart-drag.ts</td><td class="">100.00%</td><td class="">95%</td><td class="">146</td><td class="">146</td><td class="">0</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import { D3DragEvent, Selection, drag as dragD3 } from &quot;d3&quot;

class DragModule&lt;DragDatum&gt; {
  private readonly elements: {
    chart: Selection&lt;SVGGElement, DragDatum, HTMLElement, unknown&gt;
    dragArea: Selection&lt;SVGGElement, DragDatum, HTMLElement, unknown&gt;
    svg: Selection&lt;SVGSVGElement, DragDatum, HTMLElement, unknown&gt;
  }

  private readonly state: {
    dragX: number
    marginLeft: number
    width: number
  } = {
    dragX: 0,
    marginLeft: 0,
    width: 0,
  }

  public constructor({
    chart,
    dragArea,
    svg,
  }: DragModule&lt;DragDatum&gt;[&quot;elements&quot;]) {
    this.elements = {
      chart,
      dragArea,
      svg,
    }
  }

  public setDimensions({
    marginLeft,
    width,
  }: {
    marginLeft: number
    width: number
  }) {
    this.state.width = width
    this.state.marginLeft = marginLeft
  }

  public refresh() {
    const {
      elements: { svg },
    } = this

    const diffWidth = this.getDragDiffWidth()

    svg.style(&quot;cursor&quot;, diffWidth &gt; 0 ? &quot;move&quot; : &quot;default&quot;)
  }

  public reset() {
    this.refresh()

    const {
      elements: { svg },
    } = this

    this.state.dragX = 0

    const handler = (
      dragEvent: D3DragEvent&lt;SVGSVGElement, unknown, unknown&gt;
    ) =&gt; {
      this.state.dragX += dragEvent.dx

      const diffWidth = this.getDragDiffWidth()

      if (diffWidth &gt; 0) {
        this.state.dragX = Math.min(this.state.dragX, 0)
        this.state.dragX = Math.max(this.state.dragX, -diffWidth)
      } else {
        this.state.dragX = 0
      }

      this.updateDrag()
    }

    const dragBehavior = dragD3&lt;SVGSVGElement, DragDatum&gt;().on(&quot;drag&quot;, handler)

    this.updateDrag()

    svg.call(dragBehavior).on(&quot;drag&quot;, handler)
  }

  private updateDrag() {
    this.elements.dragArea.attr(&quot;transform&quot;, `translate(${this.state.dragX},0)`)
  }

  private getDragDiffWidth() {
    const {
      elements: { chart },
      state: { marginLeft, width: currentWidth },
    } = this

    const comparedWidth = currentWidth - marginLeft

    const { width: svgGWidth } = chart.node()!.getClientRects()[0]

    return svgGWidth - comparedWidth
  }
}

export { DragModule }
</textarea><pre id="annotations" style="display:none">[]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Sat, 05 Feb 2022 17:11:36 GMT</p>
    </body>
  </html>
  