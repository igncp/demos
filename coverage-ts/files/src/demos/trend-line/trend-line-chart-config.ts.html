
  <!DOCTYPE html>
  <html>
    <head>
      <title>trend-line-chart-config.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">src/demos/trend-line/trend-line-chart-config.ts</td><td class="">100.00%</td><td class="">95%</td><td class="">161</td><td class="">161</td><td class="">0</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import { timeParse, tsv } from &quot;d3&quot;

import { ChartConfig } from &quot;./trend-line-chart&quot;
import { CONTAINER_ID } from &quot;./ui-constants&quot;

type InitialDataItem = {
  occurred: string
  value: string // eslint-disable-line id-denylist
}

type DataItem = {
  arbitraryValue: number
  occurred: Date
}

const createLinearRegression = (lineData: DataItem[]) =&gt; {
  const linearRegression: {
    intercept?: number
    r2?: number
    slope?: number
  } = {}
  const { length: itemsNum } = lineData

  let sumX = 0
  let sumY = 0
  let sumXY = 0
  let sumXX = 0
  let sumYY = 0

  lineData.forEach((lineItem) =&gt; {
    sumY += lineItem.arbitraryValue
    sumYY += lineItem.arbitraryValue * lineItem.arbitraryValue
    sumXY += lineItem.occurred.getTime() * lineItem.arbitraryValue

    sumX += lineItem.occurred.getTime()
    sumXX += lineItem.occurred.getTime() * lineItem.occurred.getTime()
  })

  linearRegression.slope =
    (itemsNum * sumXY - sumX * sumY) / (itemsNum * sumXX - sumX * sumX)
  linearRegression.intercept = (sumY - linearRegression.slope * sumX) / itemsNum
  linearRegression.r2 = Math.pow(
    (itemsNum * sumXY - sumX * sumY) /
      Math.sqrt(
        (itemsNum * sumXX - sumX * sumX) * (itemsNum * sumYY - sumY * sumY)
      ),
    2
  )

  return linearRegression
}

const fetchData = async (): Promise&lt;DataItem[]&gt; =&gt; {
  const response = (await tsv(
    `${ROOT_PATH}data/d3js/trend-line/data.tsv`
  )) as InitialDataItem[]

  const timeFormat = timeParse(&quot;%Y-%m-%d&quot;)

  return response.map((responseItem) =&gt; ({
    arbitraryValue: +responseItem.value,
    occurred: timeFormat(responseItem.occurred)!,
  }))
}

type Config = ChartConfig&lt;DataItem&gt;

const getFullLineX: Config[&quot;getFullLineX&quot;] = (lineItem) =&gt; lineItem.occurred
const getFullLineY: Config[&quot;getFullLineY&quot;] = (lineItem) =&gt;
  lineItem.arbitraryValue
const getDashedLineX: Config[&quot;getDashedLineX&quot;] = (lineItem) =&gt; lineItem.occurred

const getChartConfig = ({
  initialZoomed,
  lineData,
}: {
  initialZoomed: boolean
  lineData: DataItem[]
}): Config =&gt; {
  const linearRegression = createLinearRegression(lineData)
  const getDashedLineY: Config[&quot;getDashedLineY&quot;] = (lineItem) =&gt;
    linearRegression.intercept! + linearRegression.slope! * +lineItem.occurred
  const chartText = `Slope: ${linearRegression.slope!.toExponential(3)}`

  return {
    chartText,
    getDashedLineX,
    getDashedLineY,
    getFullLineX,
    getFullLineY,
    initialZoomed,
    lineData,
    rootElId: CONTAINER_ID,
  }
}

export { fetchData, getChartConfig }
</textarea><pre id="annotations" style="display:none">[]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Sat, 22 Jan 2022 18:14:55 GMT</p>
    </body>
  </html>
  