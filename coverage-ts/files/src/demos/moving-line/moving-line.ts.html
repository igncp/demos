
  <!DOCTYPE html>
  <html>
    <head>
      <title>moving-line.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">src/demos/moving-line/moving-line.ts</td><td class="">96.76%</td><td class="">95%</td><td class="">247</td><td class="">239</td><td class="">8</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import { RaphaelElement, RaphaelPaper, RaphaelPath } from &quot;raphael&quot;

import Raphael from &quot;@/demos/_utils/browserRaphael&quot;

import * as styles from &quot;./moving-line.module.css&quot;

type GraphData = {
  charts: Array&lt;{
    lower: string
    points: Array&lt;{
      point: RaphaelElement
      value: number // eslint-disable-line id-denylist
    }&gt;
    upper: string
  }&gt;
  current: number
  line: RaphaelPath
  paper: RaphaelPaper
  xDelta: number
  xOffset: number
  yOffset: number
}

const fetchGraphData = async (): Promise&lt;GraphData&gt; =&gt; {
  const response = await fetch(`${ROOT_PATH}data/raphael/moving-line/data.json`)

  return response.json()
}

const height = 300

type RenderChartOpts = { graphData: GraphData; rootElId: string }

const renderChart = ({ graphData, rootElId }: RenderChartOpts) =&gt; {
  const createPathString = () =&gt; {
    const {
      charts: {
        [graphData.current]: { points },
      },
    } = graphData

    let path = `M ${graphData.xOffset} ${graphData.yOffset - points[0].value}`

    points.forEach((...[point, pointIndex]) =&gt; {
      path += &quot; L &quot;
      path += `${graphData.xOffset + pointIndex * graphData.xDelta} `
      path += graphData.yOffset - point.value
    })

    return path
  }

  const drawPoints = function () {
    const radius = 6
    const { points } = graphData.charts[0]

    points.forEach((...[point, pointIndex]) =&gt; {
      const xPos = graphData.xOffset + pointIndex * graphData.xDelta
      const { yOffset: yPos } = graphData

      const circle = graphData.paper.circle(xPos, yPos, radius)

      circle.node.className.baseVal = styles.point
      circle.attr(&quot;title&quot;, `Value: ${0}`)
      point.point = circle
    })
  }

  const animateChart = () =&gt; {
    const {
      charts: { [graphData.current]: newData },
    } = graphData

    const upperLimit = parseInt(newData.upper) || 1
    const lowerLimit = parseInt(newData.lower) || 0
    const scaleFactor = graphData.yOffset / (upperLimit - lowerLimit)
    const { points } = graphData.charts[0]

    let newPath = &quot;&quot;

    points.forEach((...[point, pointIndex]) =&gt; {
      if (pointIndex === 0) {
        newPath += &quot;M &quot;
        newPath += `${graphData.xOffset} `
        newPath += `${
          graphData.yOffset -
          (newData.points[pointIndex].value - lowerLimit) * scaleFactor
        } `
      } else {
        newPath += &quot;L &quot;
        newPath += `${graphData.xOffset + pointIndex * graphData.xDelta} `
        newPath +=
          graphData.yOffset -
          (newData.points[pointIndex].value - lowerLimit) * scaleFactor
      }

      point.point.animate(
        {
          cy:
            graphData.yOffset -
            (newData.points[pointIndex].value - lowerLimit) * scaleFactor,
        },
        800,
        &quot;ease-in-out&quot;
      )
      points[pointIndex].point.node.childNodes[0].remove()
      points[pointIndex].point.attr(
        &quot;title&quot;,
        `Value: ${newData.points[pointIndex].value}`
      )
    })

    graphData.line.animate(
      {
        path: newPath,
      },
      800,
      &quot;ease-in-out&quot;
    )
  }

  const advanceGraph = function () {
    if (graphData.current &lt; graphData.charts.length - 1) {
      graphData.current += 1
    } else {
      graphData.current = 1
    }

    animateChart()
  }

  const initLineGraph = function () {
    const rootEl = document.getElementById(rootElId) as HTMLElement

    rootEl.classList.add(styles.movingLineChart)

    const { width } = rootEl.getBoundingClientRect()
    const paper = Raphael(rootElId, width, height)

    graphData.paper = paper

    const path = createPathString()

    const line = paper.path(path)

    graphData.line = line
    drawPoints()

    setInterval(advanceGraph, 3000)
  }

  initLineGraph()
}

const main = async () =&gt; {
  const graphData = await fetchGraphData()

  renderChart({
    graphData,
    rootElId: &quot;chart&quot;,
  })
}

export default main
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;src/demos/moving-line/moving-line.ts&quot;,&quot;line&quot;:2,&quot;character&quot;:7,&quot;text&quot;:&quot;Raphael&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/demos/moving-line/moving-line.ts&quot;,&quot;line&quot;:62,&quot;character&quot;:18,&quot;text&quot;:&quot;className&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/demos/moving-line/moving-line.ts&quot;,&quot;line&quot;:62,&quot;character&quot;:28,&quot;text&quot;:&quot;baseVal&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/demos/moving-line/moving-line.ts&quot;,&quot;line&quot;:137,&quot;character&quot;:10,&quot;text&quot;:&quot;paper&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/demos/moving-line/moving-line.ts&quot;,&quot;line&quot;:137,&quot;character&quot;:18,&quot;text&quot;:&quot;Raphael&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/demos/moving-line/moving-line.ts&quot;,&quot;line&quot;:143,&quot;character&quot;:10,&quot;text&quot;:&quot;line&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/demos/moving-line/moving-line.ts&quot;,&quot;line&quot;:143,&quot;character&quot;:17,&quot;text&quot;:&quot;paper&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/demos/moving-line/moving-line.ts&quot;,&quot;line&quot;:143,&quot;character&quot;:23,&quot;text&quot;:&quot;path&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Wed, 01 Sep 2021 22:07:31 GMT</p>
    </body>
  </html>
  