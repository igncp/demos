{"version":3,"sources":["webpack://demos/./src/demos/partition/partition.js","webpack://demos/./src/pages/d3js/partition.js"],"names":["stash","d","x0","x","dx0","dx","arcTween","a","i","d3","interpolate","t","b","arc","addTitles","selectors","forEach","selector","append","text","name","value","width","$","innerWidth","radius","Math","min","colorScale","scale","category20c","color","children","parent","svg","select","attr","partition","layout","sort","size","PI","startAngle","endAngle","innerRadius","sqrt","y","outerRadius","dy","json","ROOT_PATH","_error","root","arcs","datum","selectAll","data","nodes","enter","path","depth","_d","style","each","texts","centroid","set","on","index","this","transition","duration","attrTween","demoInfo","pageContext","main","scripts","type","defaultChecked","className","id"],"mappings":"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","file":"component---src-pages-d-3-js-partition-js-baab61ee03b6a0846317.js","sourcesContent":["const main = () => {\n  const stash = function (d) {\n    d.x0 = d.x\n    d.dx0 = d.dx\n  }\n\n  const arcTween = function (a) {\n    const i = d3.interpolate(\n      {\n        dx: a.dx0,\n        x: a.x0,\n      },\n      a\n    )\n\n    return function (t) {\n      const b = i(t)\n\n      a.x0 = b.x\n      a.dx0 = b.dx\n\n      return arc(b)\n    }\n  }\n\n  const addTitles = (selectors) => {\n    selectors.forEach((selector) =>\n      selector.append(\"title\").text((d) => `${d.name}\\n${d.value}`)\n    )\n  }\n\n  const width = $(\"#chart\").innerWidth()\n  const height = 700\n  const radius = Math.min(width, height) / 2\n  const colorScale = d3.scale.category20c()\n\n  const color = function (d) {\n    if (d.children) {\n      return colorScale(d.name)\n    }\n\n    return colorScale(d.parent.name)\n  }\n\n  const svg = d3\n    .select(\"#chart\")\n    .append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height)\n    .append(\"g\")\n    .attr(\"transform\", `translate(${width / 2},${height * 0.52})`)\n\n  const partition = d3.layout\n    .partition()\n    .sort(null)\n    .size([2 * Math.PI, radius * radius])\n    .value(() => 1)\n\n  const arc = d3.svg\n    .arc()\n    .startAngle((d) => d.x)\n    .endAngle((d) => d.x + d.dx)\n    .innerRadius((d) => Math.sqrt(d.y))\n    .outerRadius((d) => Math.sqrt(d.y + d.dy))\n\n  d3.json(`${ROOT_PATH}data/d3js/partition/flare.json`, (_error, root) => {\n    const arcs = svg.datum(root).selectAll(\"path\").data(partition.nodes).enter()\n    const path = arcs\n      .append(\"path\")\n      .attr(\"display\", (d) => {\n        if (d.depth) {\n          return null\n        }\n\n        return \"none\"\n      })\n      .attr(\"d\", arc)\n      .attr(\"data-index\", (_d, i) => i)\n      .style(\"fill\", (d) => color(d))\n      .style(\"fill-rule\", \"evenodd\")\n      .style(\"stroke\", \"#fff\")\n      .each(stash)\n\n    const texts = arcs\n      .append(\"text\")\n      .text((d) => {\n        if (d.depth < 2 && d.dx > 0.1 && d.parent) {\n          return d.name\n        }\n\n        return \"\"\n      })\n      .attr(\"data-index\", (_d, i) => i)\n      .attr(\"x\", (d) => arc.centroid(d)[0] - 30)\n      .attr(\"y\", (d) => arc.centroid(d)[1])\n      .style(\"cursor\", \"default\")\n\n    ;[path, texts].forEach((set) =>\n      set.on(\"mouseover\", function () {\n        const index = d3.select(this).attr(\"data-index\")\n\n        d3.select(`path[data-index=\"${index}\"]`).style(\"fill\", \"#CCC\")\n\n        return d3.select(`text[data-index=\"${index}\"]`).style(\"fill\", \"#fff\")\n      })\n    )\n    ;[path, texts].forEach((set) =>\n      set.on(\"mouseout\", function () {\n        const index = d3.select(this).attr(\"data-index\")\n\n        d3.select(`path[data-index=\"${index}\"]`).style(\"fill\", color)\n\n        return d3.select(`text[data-index=\"${index}\"]`).style(\"fill\", \"#000\")\n      })\n    )\n    addTitles([path, texts])\n\n    d3.selectAll(\"input\").on(\"change\", function () {\n      const value =\n        this.value === \"count\"\n          ? function () {\n              return 1\n            }\n          : function (d) {\n              return d.size\n            }\n\n      path\n        .data(partition.value(value).nodes)\n        .transition()\n        .duration(1500)\n        .attrTween(\"d\", arcTween)\n      addTitles([path, texts])\n\n      return texts\n        .data(partition.value(value).nodes)\n        .transition()\n        .duration(1500)\n        .attr(\"x\", (d) => arc.centroid(d)[0] - 10)\n        .attr(\"y\", (d) => arc.centroid(d)[1])\n    })\n  })\n}\n\nexport default main\n","import React from \"react\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/partition/partition\"\n\nconst Partition = ({ pageContext: { demoInfo } }) => (\n  <Demo demoInfo={demoInfo} main={main} scripts={[\"/vendors/d3/d3.min.js\"]}>\n    <form>\n      <label>\n        <input name=\"mode\" type=\"radio\" value=\"size\" /> Size\n      </label>\n      <label>\n        <input defaultChecked name=\"mode\" type=\"radio\" value=\"count\" /> Count\n      </label>\n    </form>\n    <div className=\"partition-chart\" id=\"chart\" />\n  </Demo>\n)\n\nexport default Partition\n"],"sourceRoot":""}