<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta content="ie=edge" http-equiv="x-ua-compatible"/><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/><script src="/vendors/jquery/dist/jquery.min.js" type="text/javascript"></script><script src="/vendors/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script><script src="/vendors/angular/angular.min.js" type="text/javascript"></script><script src="/vendors/lodash/dist/lodash.min.js" type="text/javascript"></script><script src="/vendors/async/lib/async.js" type="text/javascript"></script><link href="/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/><link href="/vendors/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css"/><link href="/vendors/highlightjs/styles/default.css" rel="stylesheet" type="text/css"/><link href="/images/favicon.png" rel="shortcut icon" type="image/png"/><link href="http://fonts.googleapis.com/css?family=Lobster" rel="stylesheet" type="text/css"/><script src="/vendors/highlightjs/highlight.pack.js" type="text/javascript"></script><style data-href="/styles.2d6159d62e1edf771fb8.css" id="gatsby-global-css">body{color:red}::selection{background-color:transparent;color:#ccc}a:focus,a:hover{text-decoration:none}body{color:#6d6d77}body .tooltip.top{margin-left:20px;opacity:.9;z-index:10}body .tooltip.top .tooltip-inner{background-color:#fff;border:1px solid #ccc;box-shadow:0 0 5px .5px #ddd;color:#000}body .tooltip.top .tooltip-arrow{display:none}form{text-align:center}form input[type=radio]{margin-left:20px}ul{list-style-type:circle}.bullet{font-size:30px;text-shadow:.5px .5px 1px #444}.bullet.d3js{color:#9ac99d}.bullet.raphael{color:#7fa2be}.home-demo-name-link{color:#67777a}.home-demo-number{font-weight:700}.page-header{font-family:Lobster,cursive}.page-header a{color:#324297}.page-header h1{font-size:4em;text-shadow:1px 1px 1px #ddd}.page-header small{color:#9bb9a8;font-size:.5em}.row{margin:0}.source-number{color:#b91515;font-weight:700}#chart{border-radius:10px;box-shadow:0 0 20px .1px #ddd;margin-bottom:20px;overflow:hidden}#code pre{border:1px solid #3a9e4a;box-shadow:inset 0 0 8px .1px #ddd}#data-list,#sources-list{margin-bottom:30px}#demos-legend{text-align:center}#demos-legend ul{display:inline-block;list-style-type:none;margin-top:10px;padding:10px 20px 10px 30px;text-align:left}#demos-legend li{display:inline-block;position:relative}#demos-legend li:first-child{margin-right:30px}#demos-legend .bullet{left:-15px;position:absolute;top:-10px}#demos-lists{font-size:1.1em;letter-spacing:1px;margin-top:15px}#demos-lists a{background-color:rgba(145,145,145,.08);padding-left:20px;transition:all .5s linear}#demos-lists a:hover{background-color:rgba(145,172,196,.3);padding-left:25px}#demos-lists a .bullet{left:-30px;position:absolute;top:0}#demo-title{margin-bottom:20px}#main-source{color:#bbb}#notes{margin-bottom:30px}#notes,#sources-list{margin-top:30px}.bs-callout{border:1px solid #eee;border-left-width:5px;border-radius:3px;margin:20px 0;padding:20px}.bs-callout h4{margin-top:0}.bs-callout p:last-child{margin-bottom:0}.bs-callout .highlight,.bs-callout code{background-color:#fff}.bs-callout-success{border-color:#93b193}.bs-callout-warning{border-color:#f1e7bc}.bs-callout-info{border-color:#d0e3f0}.bs-callout-primary{border-color:#768ca0}pre{margin-bottom:30px}.hljs,pre{background:#fff}.hljs .hljs-string{color:#4d97f5}.hljs .hljs-keyword{color:#2cbd72}.hljs .hljs-title{color:#dd2323}.hljs .hljs-number{color:#db1fb6;font-weight:700}.hljs .vbscript{color:#228b37}.hljs .hljs-value,.hljs .hljs-value .hljs-number{color:#50b43d}.hljs .hljs-hexcolor{color:#4762ce}.hljs .hljs-class,.hljs .hljs-id,.hljs .hljs-tag{color:#c59c44}.hljs .hljs-attribute{color:#cf3d48}body,html{height:100%}#container{margin-bottom:-60px;min-height:100%}#container:after{content:"";display:block}#container:after,footer{height:60px}footer p{margin-top:20px;text-align:center;text-shadow:1px 1px 1px #ccc}.area-chart path.line{fill:none;stroke:#25a6fc;stroke-width:3.5px}.area-chart path.area{fill:#6e6ea7;opacity:.5}.area-chart text{text-shadow:1px 1px 1px #ddd}.area-chart .axis{shape-rendering:crispEdges;fill:#333}.area-chart .chart-title{font-weight:700}.area-chart .x.axis .minor{fill:#000}.area-chart .axis line,.area-chart .axis path{fill:none;stroke:#ccc;shape-rendering:crispEdges}.area-chart .x.axis line,.area-chart .x.axis path,.area-chart .y.axis line,.area-chart .y.axis path{fill:none;stroke:#ccc}.area-chart .voronoi{stroke-width:.1;opacity:0}.area-chart .point{fill:#69d895;display:none}.bars-chart rect{stroke:#fff}.bars-chart .axis path{fill:none;stroke:#777;stroke-width:1px}.bars-chart .axis .tick line{stroke:#777}.bubbles-chart .nvd3 .nv-axis.nv-x path.domain{stroke-opacity:.75}.bubbles-chart .nvd3 .nv-axis line{stroke-opacity:.4}.chord-chart path.chord{stroke-width:.75;fill-opacity:.75}.chord-chart .chart-title{font-weight:700}.chord-chart .group text{font:11px sans-serif;pointer-events:none}.chord-chart .group path{stroke:#000}.chord-chart .heading-title{font-size:15px;font-weight:700}.collapsible-tree-chart .node{cursor:pointer}.collapsible-tree-chart .node circle{fill:#fff;stroke:#4682b4;stroke-width:1.5px}.collapsible-tree-chart .node text{font:10px sans-serif}.collapsible-tree-chart .link{fill:none;stroke:#ccc;stroke-width:1.5px}.fish-eye-chart text{font:10px sans-serif;text-shadow:1px 1px 1px #ccc}.fish-eye-chart .axis line,.fish-eye-chart .axis path{fill:none;stroke:#eee;shape-rendering:crispEdges}.fish-eye-chart .background{fill:none;pointer-events:all}.fish-eye-chart .chart-title{font-size:14px}.fish-eye-chart .pointer{fill:#7aae61;font-size:15px;opacity:0}.force-chart path.link{fill:none;stroke:#666;stroke-width:1.5px}.force-chart circle{fill:#9c9;stroke:#fff;stroke-width:1.5px}.force-chart text{fill:#999;font:10px sans-serif;pointer-events:none}.force-chart .node text{fill:#000;font-size:12px}.icosahedron-chart path{fill:#f88e22;stroke:#fff;stroke-width:2px}.map-distorsions-chart svg{font-family:sans-serif;text-shadow:1px 1px 1px #ddd}.map-distorsions-chart .background path{fill:none;stroke:none;stroke-width:20px;pointer-events:stroke}.map-distorsions-chart .foreground path{fill:none;stroke-width:1.5px}.map-distorsions-chart .axis{font-size:12px}.map-distorsions-chart .axis .title{font-family:Times New Roman;font-size:11px;font-weight:700;text-transform:uppercase}.map-distorsions-chart .axis line,.map-distorsions-chart .axis path{fill:none;stroke:#000;shape-rendering:crispEdges}.map-distorsions-chart .label{-webkit-transition:fill 125ms linear}.map-distorsions-chart .label.inactive{fill:#ccc!important}.map-distorsions-chart .active .label:not(.inactive){font-weight:700}.map-distorsions-chart .foreground path.inactive{stroke:#ccc!important;stroke-opacity:.5;stroke-width:1px}.mareys-schedule-chart svg{font:10px sans-serif}.mareys-schedule-chart .axis path{display:none}.mareys-schedule-chart .axis line{stroke:#000;shape-rendering:crispEdges}.mareys-schedule-chart .chart-title{font-size:15px}.mareys-schedule-chart .station line{stroke:#ddd;stroke-dasharray:1,1;shape-rendering:crispEdges}.mareys-schedule-chart .station text{text-anchor:end}.mareys-schedule-chart .train path{fill:none;stroke-width:2.5px}.mareys-schedule-chart .train circle{stroke:#fff}.mareys-schedule-chart .train .N path{stroke:#222}.mareys-schedule-chart .train .N circle{fill:#222}.mareys-schedule-chart .train .L path{stroke:#b77409}.mareys-schedule-chart .train .L circle{fill:#b77409}.mareys-schedule-chart .train .B path{stroke:#c03e1d}.mareys-schedule-chart .train .B circle{fill:#c03e1d}.multiline-voronoi-chart .axis line,.multiline-voronoi-chart .axis path{fill:none;stroke:#000;shape-rendering:crispEdges}.multiline-voronoi-chart .cities{fill:none;stroke:#aaa;stroke-linejoin:round;stroke-linecap:round;stroke-width:1.5px}.multiline-voronoi-chart .city--hover{stroke:#000}.multiline-voronoi-chart .focus text{text-anchor:middle;text-shadow:0 1px 0 #fff,1px 0 0 #fff,0 -1px 0 #fff,-1px 0 0 #fff}.multiline-voronoi-chart .voronoi path{fill:none;pointer-events:all}.multiline-voronoi-chart .voronoi--show path{stroke:red;stroke-opacity:.2}.multiline-voronoi-chart #form{position:absolute;right:30px;top:20px}.timeline-chart text{text-shadow:.5px .5px .5px #ccc}.timeline-chart .axis{fill:grey;font-family:sans-serif;font-size:10px}.timeline-chart .axis line,.timeline-chart .axis path{stroke-width:1;stroke:grey;shape-rendering:crispEdges}.timeline-chart .band{fill:#fff}.timeline-chart .bandLabel{fill:#f0f0f0;font:10px sans-serif;font-weight:700}.timeline-chart .bandMinMaxLabel{fill:#11aa6a;font:10px sans-serif;font-weight:700}.timeline-chart .bandMidLabel{fill:#bc79c5;cursor:default;font:10px sans-serif;font-style:italic;font-weight:700}.timeline-chart .brush .extent{stroke:grey;fill:#71d7e5;fill-opacity:.1}.timeline-chart .chart{fill:#eee}.timeline-chart .interval{fill:#ecf7f7;cursor:default;pointer-events:true}.timeline-chart .interval rect{stroke-width:.5px;stroke:#000}.timeline-chart .instant{fill:#afcae7;cursor:default}.timeline-chart .instantLabel{fill:#7e7e7e;shape-rendering:crispEdges;font:10px sans-serif}.timeline-chart .intervalLabel{fill:#000;shape-rendering:crispEdges;font:10px sans-serif}.timeline-chart .item{cursor:default;pointer-events:auto}.trend-line-chart .axis{font:10px sans-serif}.trend-line-chart .axis path,.trend-line-chart line{fill:none;stroke:#000;shape-rendering:crispEdges}.trend-line-chart .line{fill:none;stroke:#4682b4;stroke-width:1.5px}.trend-line-chart .rline{fill:none;stroke:red;stroke-dasharray:5,5;stroke-width:1.5px}.vectors-chart svg{background-color:#fff;cursor:default;-webkit-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none}.vectors-chart svg:not(.active):not(.ctrl){cursor:crosshair}.vectors-chart path.link{fill:none;stroke:#888;stroke-width:3px;cursor:default}.vectors-chart svg:not(.active):not(.ctrl) path.link{cursor:pointer}.vectors-chart path.link.selected{stroke-dasharray:10,2}.vectors-chart path.link.dragline{pointer-events:none}.vectors-chart path.link.hidden{stroke-width:0}.vectors-chart circle.node{stroke-width:0px;fill:#fff;cursor:pointer}.vectors-chart text{font:14px sans-serif;pointer-events:none}.vectors-chart text.id{text-anchor:middle;font-weight:700}.weekly-heatmap-chart rect.bordered{stroke:#e6e6e6;stroke-width:2px}.weekly-heatmap-chart text.mono{fill:#aaa;font-family:Consolas,courier;font-size:9pt}.weekly-heatmap-chart text.axis-worktime,.weekly-heatmap-chart text.axis-workweek{fill:#000}.bars-3dimensional-chart{padding:50px}.circular-arcs-chart{color:#fff}.circular-arcs-chart svg{margin-left:30px}.moving-line-chart path{stroke:#000;fill:none}.moving-line-chart .point{fill:#87b189}</style><meta name="generator" content="Gatsby 3.6.2"/><title data-react-helmet="true">Vectors | demos igncp</title><script data-react-helmet="true" src="/vendors/d3/d3.min.js" type="text/javascript"></script><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link as="script" rel="preload" href="/webpack-runtime-fd734e0d633a3a313eaa.js"/><link as="script" rel="preload" href="/framework-1f78429ab6fb93434b07.js"/><link as="script" rel="preload" href="/app-7b6c34a05a0c32a8aa85.js"/><link as="script" rel="preload" href="/40253593f9913a7f13fa78c8c713ea552ed82d8a-15df81c7b4b9163d4ddf.js"/><link as="script" rel="preload" href="/component---src-pages-d-3-js-vectors-js-6c7056f96fe1807bf6da.js"/><link as="fetch" rel="preload" href="/page-data/d3js/vectors/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="row" id="container"><div class="col-lg-offset-1 col-lg-10"><div class="page-header"><h1 class="row"><span class="col-lg-8"><a href="/">Demos</a> <small>interactive data visualization examples</small></span><span class="col-lg-4"><iframe allowtransparency="true" frameBorder="0" height="20" scrolling="0" src="http://ghbtns.com/github-btn.html?user=igncp&amp;repo=demos&amp;type=watch" width="62"></iframe><iframe allowtransparency="true" frameBorder="0" height="20" scrolling="0" src="http://ghbtns.com/github-btn.html?user=igncp&amp;repo=demos&amp;type=follow" width="119"></iframe><iframe allowtransparency="true" frameBorder="0" height="20" scrolling="0" src="http://ghbtns.com/github-btn.html?user=igncp&amp;repo=demos&amp;type=fork" width="62"></iframe></span></h1></div><h2 class="row" id="demo-title"><span class="col-lg-10">Vectors<!-- --> Chart<!-- --> <small id="main-source">main source: <a href="http://codepen.io/zarazum/pen/fjoqF">···</a></small></span><span class="col-lg-2 back-home"><a class="btn btn-default" href="/"><span class="glyphicon glyphicon-home"></span> Home</a></span></h2><div class="vectors-chart" id="chart"></div><div><div class="bs-callout bs-callout-info" id="notes"><p><strong>Notes:</strong></p><ul><li>Use the &lt;strong&gt;Ctrl&lt;/strong&gt; key to move nodes instead of creating vectors</li></ul></div><div class="bs-callout bs-callout-primary" id="sources-list"><p><strong>Sources:</strong></p><ul><li><span class="source-number">[<!-- -->1<!-- -->]</span>:<!-- --> <a href="http://codepen.io/zarazum/pen/fjoqF">http://codepen.io/zarazum/pen/fjoqF</a></li></ul></div><div class="bs-callout bs-callout-success" id="code"><p><strong>Code:</strong></p><ul><li><p>vectors.js</p><pre><code class="javascript">const main = () =&gt; {
  const width = $(&quot;#chart&quot;).innerWidth()
  const height = 500

  const colors = () =&gt; &quot;#FFF&quot;

  const svg = d3
    .select(&quot;#chart&quot;)
    .append(&quot;svg&quot;)
    .attr(&quot;width&quot;, width)
    .attr(&quot;height&quot;, height)

  const nodes = [
    {
      id: &quot;A&quot;,
      reflexive: false,
    },
    {
      id: &quot;B&quot;,
      reflexive: false,
    },
    {
      id: &quot;C&quot;,
      reflexive: false,
    },
  ]

  let lastNodeId = &quot;C&quot;.charCodeAt(0)

  const links = [
    {
      left: false,
      right: true,
      source: nodes[0],
      target: nodes[1],
    },
    {
      left: false,
      right: true,
      source: nodes[1],
      target: nodes[2],
    },
  ]

  const tick = () =&gt; {
    path.attr(&quot;d&quot;, (d) =&gt; {
      const deltaX = d.target.x - d.source.x
      const deltaY = d.target.y - d.source.y
      const dist = Math.sqrt(deltaX * deltaX + deltaY * deltaY)
      const normX = deltaX / dist
      const normY = deltaY / dist
      const sourcePadding = d.left ? 17 : 12
      const targetPadding = d.right ? 17 : 12
      const sourceX = d.source.x + sourcePadding * normX
      const sourceY = d.source.y + sourcePadding * normY
      const targetX = d.target.x - targetPadding * normX
      const targetY = d.target.y - targetPadding * normY

      return `M${sourceX},${sourceY}L${targetX},${targetY}`
    })

    return circle.attr(&quot;transform&quot;, (d) =&gt; `translate(${d.x},${d.y})`)
  }

  svg
    .append(&quot;svg:defs&quot;)
    .append(&quot;svg:marker&quot;)
    .attr(&quot;id&quot;, &quot;end-arrow&quot;)
    .attr(&quot;viewBox&quot;, &quot;0 -5 10 10&quot;)
    .attr(&quot;refX&quot;, 6)
    .attr(&quot;markerWidth&quot;, 3)
    .attr(&quot;markerHeight&quot;, 3)
    .attr(&quot;orient&quot;, &quot;auto&quot;)
    .append(&quot;svg:path&quot;)
    .attr(&quot;d&quot;, &quot;M0,-5L10,0L0,5&quot;)
    .attr(&quot;fill&quot;, &quot;#000&quot;)

  svg
    .append(&quot;svg:defs&quot;)
    .append(&quot;svg:marker&quot;)
    .attr(&quot;id&quot;, &quot;start-arrow&quot;)
    .attr(&quot;viewBox&quot;, &quot;0 -5 10 10&quot;)
    .attr(&quot;refX&quot;, 4)
    .attr(&quot;markerWidth&quot;, 3)
    .attr(&quot;markerHeight&quot;, 3)
    .attr(&quot;orient&quot;, &quot;auto&quot;)
    .append(&quot;svg:path&quot;)
    .attr(&quot;d&quot;, &quot;M10,-5L0,0L10,5&quot;)
    .attr(&quot;fill&quot;, &quot;#000&quot;)

  const dragLine = svg
    .append(&quot;svg:path&quot;)
    .attr(&quot;class&quot;, &quot;link dragline hidden&quot;)
    .attr(&quot;d&quot;, &quot;M0,0L0,0&quot;)

  let path = svg.append(&quot;svg:g&quot;).selectAll(&quot;path&quot;)

  let circle = svg.append(&quot;svg:g&quot;).selectAll(&quot;g&quot;)

  const force = d3.layout
    .force()
    .nodes(nodes)
    .links(links)
    .size([width, height])
    .linkDistance(150)
    .charge(-500)
    .on(&quot;tick&quot;, tick)

  let selectedNode = null
  let selectedLink = null
  let mousedownLink = null
  let mousedownNode = null

  let mouseupNode = null

  const resetMouseVars = () =&gt; {
    mousedownNode = null
    mouseupNode = null
    mousedownLink = null
  }

  const restart = function () {
    path = path.data(links)
    path
      .classed(&quot;selected&quot;, (d) =&gt; d === selectedLink)
      .style(&quot;marker-start&quot;, (d) =&gt; {
        if (d.left) {
          return &quot;url(#start-arrow)&quot;
        }

        return &quot;&quot;
      })
      .style(&quot;marker-end&quot;, (d) =&gt; {
        if (d.right) {
          return &quot;url(#end-arrow)&quot;
        }

        return &quot;&quot;
      })
    path
      .enter()
      .append(&quot;svg:path&quot;)
      .attr(&quot;class&quot;, &quot;link&quot;)
      .classed(&quot;selected&quot;, (d) =&gt; d === selectedLink)
      .style(&quot;marker-start&quot;, (d) =&gt; {
        if (d.left) {
          return &quot;url(#start-arrow)&quot;
        }

        return &quot;&quot;
      })
      .style(&quot;marker-end&quot;, (d) =&gt; {
        if (d.right) {
          return &quot;url(#end-arrow)&quot;
        }

        return &quot;&quot;
      })
      .on(&quot;mousedown&quot;, (d) =&gt; {
        if (d3.event.ctrlKey) {
          return
        }

        mousedownLink = d

        if (mousedownLink === selectedLink) {
          selectedLink = null
        } else {
          selectedLink = mousedownLink
        }

        selectedNode = null

        restart()
      })
    path.exit().remove()
    circle = circle.data(nodes, (d) =&gt; d.id)
    circle
      .selectAll(&quot;circle&quot;)
      .style(&quot;fill&quot;, (d) =&gt; {
        if (d === selectedNode) {
          return d3.rgb(colors(d.id)).darker().toString()
        }

        return colors(d.id)
      })
      .classed(&quot;reflexive&quot;, (d) =&gt; d.reflexive)

    const g = circle.enter().append(&quot;svg:g&quot;)

    g.append(&quot;svg:circle&quot;)
      .attr(&quot;class&quot;, &quot;node&quot;)
      .attr(&quot;r&quot;, 12)
      .style(&quot;fill&quot;, (d) =&gt; {
        if (d === selectedNode) {
          return d3.rgb(colors(d.id)).brighter().toString()
        }

        return colors(d.id)
      })
      .style(&quot;stroke&quot;, (d) =&gt; d3.rgb(colors(d.id)).darker().toString())
      .classed(&quot;reflexive&quot;, (d) =&gt; d.reflexive)
      .on(&quot;mouseover&quot;, function (d) {
        if (!mousedownNode || d === mousedownNode) {
          return
        }

        d3.select(this).attr(&quot;transform&quot;, &quot;scale(1.1)&quot;)
      })
      .on(&quot;mouseout&quot;, function (d) {
        if (!mousedownNode || d === mousedownNode) {
          return
        }

        d3.select(this).attr(&quot;transform&quot;, &quot;&quot;)
      })
      .on(&quot;mousedown&quot;, (d) =&gt; {
        if (d3.event.ctrlKey) {
          return
        }

        mousedownNode = d

        if (mousedownNode === selectedNode) {
          selectedNode = null
        } else {
          selectedNode = mousedownNode
        }

        selectedLink = null
        dragLine
          .style(&quot;marker-end&quot;, &quot;url(#end-arrow)&quot;)
          .classed(&quot;hidden&quot;, false)
          .attr(
            &quot;d&quot;,
            `M${mousedownNode.x},${mousedownNode.y}L${mousedownNode.x},${mousedownNode.y}`
          )

        restart()
      })
      .on(&quot;mouseup&quot;, function (d) {
        let direction = null
        let source = null
        let target = null

        if (!mousedownNode) {
          return
        }

        dragLine.classed(&quot;hidden&quot;, true).style(&quot;marker-end&quot;, &quot;&quot;)
        mouseupNode = d

        if (mouseupNode === mousedownNode) {
          resetMouseVars()

          return
        }

        d3.select(this).attr(&quot;transform&quot;, &quot;&quot;)

        if (mousedownNode.id &lt; mouseupNode.id) {
          source = mousedownNode
          target = mouseupNode
          direction = &quot;right&quot;
        } else {
          source = mouseupNode
          target = mousedownNode
          direction = &quot;left&quot;
        }

        let link = links.filter(
          (l) =&gt; l.source === source &amp;&amp; l.target === target
        )[0]

        if (link) {
          link[direction] = true
        } else {
          link = {
            left: false,
            right: false,
            source,
            target,
          }
          link[direction] = true
          links.push(link)
        }

        selectedLink = link
        selectedNode = null

        restart()
      })
    g.append(&quot;svg:text&quot;)
      .attr(&quot;x&quot;, 0)
      .attr(&quot;y&quot;, 4)
      .attr(&quot;class&quot;, &quot;id&quot;)
      .text((d) =&gt; d.id)
    circle.exit().remove()

    return force.start()
  }

  const mousedown = function () {
    svg.classed(&quot;active&quot;, true)

    if (d3.event.ctrlKey || mousedownNode || mousedownLink) {
      return
    }

    const point = d3.mouse(this)
    const node = {
      id: String.fromCharCode(++lastNodeId),
      reflexive: false,
    }

    node.x = point[0]
    node.y = point[1]
    nodes.push(node)

    restart()
  }

  const mousemove = function () {
    if (!mousedownNode) {
      return
    }

    dragLine.attr(
      &quot;d&quot;,
      `M${mousedownNode.x},${mousedownNode.y}L${d3.mouse(this)[0]},${
        d3.mouse(this)[1]
      }`
    )

    restart()
  }

  const mouseup = function () {
    if (mousedownNode) {
      dragLine.classed(&quot;hidden&quot;, true).style(&quot;marker-end&quot;, &quot;&quot;)
    }

    svg.classed(&quot;active&quot;, false)

    return resetMouseVars()
  }

  const spliceLinksForNode = (node) =&gt; {
    const toSplice = links.filter((l) =&gt; l.source === node || l.target === node)

    return toSplice.map((l) =&gt; links.splice(links.indexOf(l), 1))
  }

  let lastKeyDown = -1

  const keydown = function () {
    d3.event.preventDefault()

    if (lastKeyDown !== -1) {
      return
    }

    lastKeyDown = d3.event.keyCode

    if (d3.event.keyCode === 17) {
      circle.call(force.drag)
      svg.classed(&quot;ctrl&quot;, true)
    }

    if (!selectedNode &amp;&amp; !selectedLink) {
      return
    }

    switch (d3.event.keyCode) {
      case 46:
        if (selectedNode) {
          nodes.splice(nodes.indexOf(selectedNode), 1)
          spliceLinksForNode(selectedNode)
        } else if (selectedLink) {
          links.splice(links.indexOf(selectedLink), 1)
        }

        selectedLink = null
        selectedNode = null

        restart()

        return
      case 66:
        if (selectedLink) {
          selectedLink.left = true
          selectedLink.right = true
        }

        restart()

        return
      case 76:
        if (selectedLink) {
          selectedLink.left = true
          selectedLink.right = false
        }

        restart()

        return
      case 82:
        if (selectedNode) {
          selectedNode.reflexive = !selectedNode.reflexive
        } else if (selectedLink) {
          selectedLink.left = false
          selectedLink.right = true
        }

        restart()

        return
    }
  }

  const keyup = function () {
    lastKeyDown = -1

    if (d3.event.keyCode === 17) {
      circle.on(&quot;mousedown.drag&quot;, null).on(&quot;touchstart.drag&quot;, null)

      svg.classed(&quot;ctrl&quot;, false)
    }
  }

  svg
    .on(&quot;mousedown&quot;, mousedown)
    .on(&quot;mousemove&quot;, mousemove)
    .on(&quot;mouseup&quot;, mouseup)

  d3.select(window).on(&quot;keydown&quot;, keydown).on(&quot;keyup&quot;, keyup)

  restart()
}

export default main
</code></pre></li><li><p>pages/d3js/vectors.js</p><pre><code class="javascript">import React from &quot;react&quot;

import Demo from &quot;@/components/demo&quot;

import main from &quot;@/demos/vectors/vectors&quot;

import &quot;@/demos/vectors/vectors.styl&quot;

const Vectors = ({ pageContext: { demoInfo } }) =&gt; (
  &lt;Demo demoInfo={demoInfo} main={main} scripts={[&quot;/vendors/d3/d3.min.js&quot;]}&gt;
    &lt;div className=&quot;vectors-chart&quot; id=&quot;chart&quot; /&gt;
  &lt;/Demo&gt;
)

export default Vectors
</code></pre></li><li><p>vectors.styl</p><pre><code>.vectors-chart
    svg 
      background-color: #FFF;
      cursor: default;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      -o-user-select: none;
      user-select: none;
    

    svg:not(.active):not(.ctrl) 
      cursor: crosshair;
    

    path.link 
      fill: none;
      stroke: #888;
      stroke-width: 3px;
      cursor: default;
    

    svg:not(.active):not(.ctrl) path.link 
      cursor: pointer;
    

    path.link.selected 
        stroke-dasharray: 10,2;
    

    path.link.dragline 
      pointer-events: none;
    

    path.link.hidden 
      stroke-width: 0;
    

    circle.node 
      stroke-width: 0px;
      cursor: pointer;
      fill:#fff;
    

    /*circle.node.reflexive 
      stroke: #000 !important;
      stroke-width: 2.5px;
    */

    text 
      font: 14px sans-serif;
      pointer-events: none;
    

    text.id 
      text-anchor: middle;
      font-weight: bold;</code></pre></li></ul></div></div></div></div><footer class="row"><p>2021</p></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/d3js/vectors/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-dfb1072a7bf3bc69d7fe.js"],"app":["/app-7b6c34a05a0c32a8aa85.js"],"component---src-pages-404-js":["/component---src-pages-404-js-270adbbd899e574208d7.js"],"component---src-pages-d-3-js-area-js":["/component---src-pages-d-3-js-area-js-ada13cc69c5fe8416352.js"],"component---src-pages-d-3-js-bars-js":["/component---src-pages-d-3-js-bars-js-bffeef8bddd641a76c52.js"],"component---src-pages-d-3-js-bubbles-js":["/component---src-pages-d-3-js-bubbles-js-08e6f0fdabb9e1c611ec.js"],"component---src-pages-d-3-js-chord-js":["/component---src-pages-d-3-js-chord-js-0d050d1bbc4fb794c5bd.js"],"component---src-pages-d-3-js-collapsible-tree-js":["/component---src-pages-d-3-js-collapsible-tree-js-1b6de9c231452feae105.js"],"component---src-pages-d-3-js-concentric-circles-js":["/component---src-pages-d-3-js-concentric-circles-js-536bc659f1149c23c17d.js"],"component---src-pages-d-3-js-fish-eye-js":["/component---src-pages-d-3-js-fish-eye-js-0a50ad5b148eae4d6e7f.js"],"component---src-pages-d-3-js-force-js":["/component---src-pages-d-3-js-force-js-2869b10b81e33d0c5c23.js"],"component---src-pages-d-3-js-icosahedron-js":["/component---src-pages-d-3-js-icosahedron-js-c4849abfe2b45ceeaebb.js"],"component---src-pages-d-3-js-map-distorsions-js":["/component---src-pages-d-3-js-map-distorsions-js-40df5ef09bb0132cc96a.js"],"component---src-pages-d-3-js-mareys-schedule-js":["/component---src-pages-d-3-js-mareys-schedule-js-e11371ef444708a66ff4.js"],"component---src-pages-d-3-js-multiline-voronoi-js":["/component---src-pages-d-3-js-multiline-voronoi-js-ad90f7118a6194978375.js"],"component---src-pages-d-3-js-partition-js":["/component---src-pages-d-3-js-partition-js-a37be41c73fdd05a4b50.js"],"component---src-pages-d-3-js-pie-js":["/component---src-pages-d-3-js-pie-js-9fd34e210cfdd31ea283.js"],"component---src-pages-d-3-js-spain-map-js":["/component---src-pages-d-3-js-spain-map-js-0b7a89d4a41de7a51e0e.js"],"component---src-pages-d-3-js-timeline-js":["/component---src-pages-d-3-js-timeline-js-66cde10f82eb0414f0d0.js"],"component---src-pages-d-3-js-trend-line-js":["/component---src-pages-d-3-js-trend-line-js-eb61fe14d877750151e1.js"],"component---src-pages-d-3-js-vectors-js":["/component---src-pages-d-3-js-vectors-js-6c7056f96fe1807bf6da.js"],"component---src-pages-d-3-js-weekly-heatmap-js":["/component---src-pages-d-3-js-weekly-heatmap-js-1797a8527d5c29e97a3c.js"],"component---src-pages-d-3-js-world-map-js":["/component---src-pages-d-3-js-world-map-js-a680dbc198da73d5fe88.js"],"component---src-pages-index-js":["/component---src-pages-index-js-339a97b4c97b945456a4.js"],"component---src-pages-raphael-bars-3-dimensional-js":["/component---src-pages-raphael-bars-3-dimensional-js-dc2ef3694486e6f411ef.js"],"component---src-pages-raphael-circular-arcs-js":["/component---src-pages-raphael-circular-arcs-js-324356f75f4c7449d05f.js"],"component---src-pages-raphael-moving-line-js":["/component---src-pages-raphael-moving-line-js-9909da2d787dbb88a487.js"],"component---src-pages-testing-js":["/component---src-pages-testing-js-bdb3a091f3fec81ac0d6.js"]};/*]]>*/</script><script src="/polyfill-dfb1072a7bf3bc69d7fe.js" nomodule=""></script><script src="/component---src-pages-d-3-js-vectors-js-6c7056f96fe1807bf6da.js" async=""></script><script src="/40253593f9913a7f13fa78c8c713ea552ed82d8a-15df81c7b4b9163d4ddf.js" async=""></script><script src="/app-7b6c34a05a0c32a8aa85.js" async=""></script><script src="/framework-1f78429ab6fb93434b07.js" async=""></script><script src="/webpack-runtime-fd734e0d633a3a313eaa.js" async=""></script></body></html>