(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[449],{8760:function(t,a,e){"use strict";e.r(a),e.d(a,{default:function(){return c}});var r=e(7294),n=e(7538),i=e(7440),l=function(){d3.csv("/data/d3js/timeline/data.csv",(function(t){return function(){var t={bottom:0,left:20,right:20,top:60},a=document.getElementById("chart").getBoundingClientRect().width,e=a-t.left-t.right,r=700-t.top-t.bottom,n=0,l=0,c={},s={},d=[],u={},o=i.Z.svg("#chart",a,700,t);i.Z.middleTitle(o,a,"Philosophers through History",-20),i.Z.filterBlackOpacity("intervals",o,1,.2),o.append("clipPath").attr("id","chart-area").append("rect").attr("width",e).attr("height",r),o.on("mouseup",(function(){return d3.selectAll(".interval rect").style("filter","url(#drop-shadow-intervals)")}));var f=o.append("g").attr("class","chart").attr("clip-path","url(#chart-area)"),h=function(t){var a=d3.time.format("%Y-%m-%d").parse(t);if(null!==a)return a;var e=null;return(e=isNaN(t)?-t.replace(/[^0-9]/g,""):+t)<0||e>99?a=new Date(e,6,1):0===e?a=new Date(-1,6,1):(a=new Date(e,6,1)).setUTCFullYear(("0000"+e).slice(-4)),a},p=function(t,a){a=a||" BC";var e=t.getUTCFullYear();return e>0?e.toString():"-"===a[0]?a+-e:-e+a};return c.data=function(t){var a=new Date,e=[];s.items=t;var r,n,i=function(t,a){var e=t.start-a.start;return e<0?-1:e>0?1:(e=a.end-t.end)<0?-1:e>0?1:0},l=function(t,a){var e=t.start-a.start;return e<0?1:e>0?-1:(e=a.end-t.end)<0?1:e>0?-1:0};return s.items.forEach((function(t){t.start=h(t.start),""===t.end?(t.end=new Date(t.start.getTime()+316224e7),t.instant=!0):(t.end=h(t.end),t.instant=!1),t.end>a&&(t.end=a)})),r=s.items,n=(n="backward")||"backward","ascending"===("descending"||"descending")?s.items.sort(i):s.items.sort(l),"forward"===n?r.forEach((function(t){for(var a=0,r=0,n=0,i=e.length;(0<=i?n<i:n>i)&&!(t.start>e[r]);r=0<=i?++n:--n)a++;t.track=a,e[a]=t.end})):r.forEach((function(t){for(var a=0,r=0,n=0,i=e.length;(0<=i?n<i:n>i)&&!(t.end<e[r]);r=0<=i?++n:--n)a++;t.track=a,e[a]=t.start})),s.nTracks=e.length,s.minDate=d3.min(s.items,(function(t){return t.start})),s.maxDate=d3.max(s.items,(function(t){return t.end})),c},c.tooltip={create:function(){return i.Z.tooltip(".part.instant, .part.interval",{followMouse:!0,leftOffst:80}),c}},c.band=function(t,a){var i={};i.id="band"+l,i.x=0,i.y=n,i.w=e,i.h=r*(a||1),i.trackOffset=0,i.trackHeight=Math.min((i.h-i.trackOffset)/s.nTracks,20),i.itemHeight=.7*i.trackHeight,i.parts=[],i.instantWidth=100,i.xScale=d3.time.scale().domain([s.minDate,s.maxDate]).range([0,i.w]),i.yScale=function(t){return i.trackOffset+t*i.trackHeight},i.yearsScale=s.maxDate.getUTCFullYear()-s.minDate.getUTCFullYear(),i.g=f.append("g").attr("id",i.id).attr("transform","translate(0,"+i.y+")"),i.g.append("rect").attr("class","band").attr("width",i.w).attr("height",i.h);var o=i.g.selectAll("g").data(s.items).enter().append("svg").attr("y",(function(t){return i.yScale(t.track)})).attr("height",i.itemHeight).attr("data-title",(function(t){return t.instant?t.label+": "+p(t.start):t.label+": "+p(t.start)+" - "+p(t.end)})).attr("class",(function(t){return t.instant?"part instant":"part interval"})),h=d3.select("#band"+l).selectAll(".interval");h.append("rect").attr("height","80%").attr("width","80%").attr("x","1px").attr("y",".5px").style("filter","url(#drop-shadow-intervals)"),h.append("text").attr("class","intervalLabel").attr("x",3).attr("y",9.5);var m=d3.select("#band"+l).selectAll(".instant");return m.append("circle").attr("cx",i.itemHeight/2).attr("cy",i.itemHeight/2).attr("r",5),m.append("text").attr("class","instantLabel").attr("x",15).attr("y",10),i.addActions=function(t){return t.forEach((function(t){return o.on(t[0],t[1])}))},i.redraw=function(){return o.attr("x",(function(t){return i.xScale(t.start)})).attr("width",(function(t){return i.xScale(t.end)-i.xScale(t.start)})).select("text").text((function(t){var a=(i.xScale(t.end)-i.xScale(t.start))/9;return t.label.length>a?t.label.substr(0,a-1)+"..":t.label})),i.parts.forEach((function(t){return t.redraw()}))},u[t]=i,d.push(i),n+=i.h+25,l+=1,c},c.labels=function(t){var a=u[t],e=a.y+a.h-10,r=[["start","bandMinMaxLabel",0,4,function(t){return p(t)},"Start of the selected interval",a.x+30,e],["end","bandMinMaxLabel",a.w-46,a.w-4,function(t,a){return p(a)},"End of the selected interval",a.x+a.w-152,e],["middle","bandMidLabel",(a.w-46)/2,a.w/2,function(t,a){return a.getUTCFullYear()-t.getUTCFullYear()},"Length of the selected interval",a.x+a.w/2-75,e]],n=f.append("g").attr("id",t+"Labels").attr("transform","translate(0,"+(a.y+a.h+1)+")").selectAll("#"+t+"Labels").data(r).enter().append("g");n.append("rect").attr("class","bandLabel").attr("x",(function(t){return t[2]})).attr("width",46).attr("height",20).style("opacity",1);var i=n.append("text").attr("class",(function(t){return t[1]})).attr("id",(function(t){return t[0]})).attr("x",(function(t){return t[3]})).attr("y",15).attr("text-anchor",(function(t){return t[0]}));return i.redraw=function(){var t=a.xScale.domain()[0],e=a.xScale.domain()[1];return i.text((function(a){return a[4](t,e)}))},a.parts.push(i),d.push(i),c},c.xAxis=function(t,a){var e=u[t],r=d3.svg.axis().scale(e.xScale).orient(a||"bottom").tickSize(6,0).tickFormat((function(t){return p(t)})),n=f.append("g").attr("class","axis").attr("transform","translate(0,"+(e.y+e.h)+")");return n.redraw=function(){return n.call(r)},e.parts.push(n),d.push(n),c},c.brush=function(t,a){var e=u[t],r=d3.svg.brush().x(e.xScale.range([0,e.w]));return r.on("brush",(function(){var t=r.empty()?e.xScale.domain():r.extent();d3.selectAll(".interval rect").style("filter","none"),a.forEach((function(a){u[a].xScale.domain(t),u[a].redraw()}))})),e.g.append("svg").attr("class","x brush").call(r).selectAll("rect").attr("y",1).attr("height",e.h-1),c},c.redraw=function(){return d.forEach((function(t){return t.redraw()}))},c}().data(t).band("mainBand",.82).band("naviBand",.08).xAxis("mainBand").xAxis("naviBand").labels("mainBand").labels("naviBand").brush("naviBand",["mainBand"]).tooltip.create().redraw()}))},c=function(t){var a=t.pageContext.demoInfo;return r.createElement(n.Z,{demoInfo:a,main:l,scripts:["/vendors/d3/d3.min.js","/js/d3js-utils.js"]},r.createElement("div",{className:"timeline-chart",id:"chart"}))}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-timeline-js-4a45fcdaa07c1e718003.js.map