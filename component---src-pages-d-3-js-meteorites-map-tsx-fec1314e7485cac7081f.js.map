{"version":3,"sources":["webpack://demos/./node_modules/uuid/dist/esm-browser/rng.js","webpack://demos/./node_modules/uuid/dist/esm-browser/regex.js","webpack://demos/./node_modules/uuid/dist/esm-browser/stringify.js","webpack://demos/./node_modules/uuid/dist/esm-browser/validate.js","webpack://demos/./node_modules/uuid/dist/esm-browser/v1.js","webpack://demos/./src/demos/meteorites-map/meteorites-map.module.css","webpack://demos/./src/demos/meteorites-map/meteorites-map.ts","webpack://demos/./src/pages/d3js/meteorites-map.tsx"],"names":["getRandomValues","rnds8","Uint8Array","rng","crypto","bind","msCrypto","Error","uuid","byteToHex","i","push","toString","substr","_nodeId","_clockseq","arr","offset","arguments","length","undefined","toLowerCase","TypeError","_lastMSecs","_lastNSecs","options","buf","b","Array","node","clockseq","seedBytes","random","msecs","Date","now","nsecs","dt","tl","tmh","n","fetchData","Promise","all","json","ROOT_PATH","countries","meteorites","margin","height","removeSelection","meteoritesEls","modal","state","isDuringAnimation","selectedMeteorite","attr","styles","anime","targets","translateX","translateY","complete","text","texts","meteoriteClickHandler","clickedMeteorite","meteoritesGeo","projectionFn","rootElId","id","year","timeFormat","mass","Intl","NumberFormat","format","html","name","qs","q","recclass","nametype","trim","allMeteorites","targetMeteorite","targetProj","geometry","coordinates","nearMeteorites","slice","filter","otherMeteorite","map","otherMeteoriteCoordinates","proj","vector","vectorLength","Math","sqrt","pow","vectorNormalized","nearMeteoritesSet","Set","a","vectorsMap","reduce","acc","nearMeteorite","getNearMeteoritessWithVectors","meteorite","has","getTranslateFn","coordIdx","_el","idx","animatedMeteorite","getShouldSet0","top","document","getElementById","getBoundingClientRect","modalHiddenTop","window","scrollY","zoomed","e","select","this","transition","duration","transform","renderChart","width","geoMercator","translate","path","geoPath","projection","removeSelectionFn","geolocation","type","append","style","svg","on","call","zoom","extent","svgMap","dialogId","uuidv1","group","dialog","body","$","autoOpen","resizable","addInfo","countryClass","selectAll","data","features","enter","country","properties","d","clickEvent","stopPropagation","tooltip","track","tooltipClass","pageContext","links","main","scripts"],"mappings":"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","file":"component---src-pages-d-3-js-meteorites-map-tsx-fec1314e7485cac7081f.js","sourcesContent":["// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0; // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import rng from './rng.js';\nimport stringify from './stringify.js'; // **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\n\nvar _clockseq; // Previous uuid creation time\n\n\nvar _lastMSecs = 0;\nvar _lastNSecs = 0; // See https://github.com/uuidjs/uuid for API details\n\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || new Array(16);\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq; // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n\n  if (node == null || clockseq == null) {\n    var seedBytes = options.random || (options.rng || rng)();\n\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [seedBytes[0] | 0x01, seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]];\n    }\n\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  } // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n\n\n  var msecs = options.msecs !== undefined ? options.msecs : Date.now(); // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1; // Time since last uuid creation (in msecs)\n\n  var dt = msecs - _lastMSecs + (nsecs - _lastNSecs) / 10000; // Per 4.2.1.2, Bump clockseq on clock regression\n\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  } // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n\n\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  } // Per 4.2.1.2 Throw error if too many uuids are requested\n\n\n  if (nsecs >= 10000) {\n    throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq; // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n\n  msecs += 12219292800000; // `time_low`\n\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff; // `time_mid`\n\n  var tmh = msecs / 0x100000000 * 10000 & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff; // `time_high_and_version`\n\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n\n  b[i++] = tmh >>> 16 & 0xff; // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n\n  b[i++] = clockseq >>> 8 | 0x80; // `clock_seq_low`\n\n  b[i++] = clockseq & 0xff; // `node`\n\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf || stringify(b);\n}\n\nexport default v1;","// extracted by mini-css-extract-plugin\nexport var countryTooltip = \"meteorites-map-module--countryTooltip--2egLQ\";\nexport var infoTrigger = \"meteorites-map-module--infoTrigger--2tb0J\";\nexport var meteorite = \"meteorites-map-module--meteorite--1d0Jo\";\nexport var active = \"meteorites-map-module--active--3vr62\";\nexport var moved = \"meteorites-map-module--moved--1Atuq\";\nexport var modal = \"meteorites-map-module--modal--2rmkA\";","import {\n  GeoProjection,\n  Selection,\n  geoMercator,\n  geoPath,\n  json,\n  select,\n  timeFormat,\n  zoom,\n} from \"d3\"\nimport anime from \"animejs\"\nimport qs from \"query-string\"\nimport { v1 as uuidv1 } from \"uuid\"\n\nimport * as styles from \"./meteorites-map.module.css\"\n\n// @TODO:\n// - review the checklist for the rest of refactors\n\ntype Point = [number, number]\n\ntype Meteorite = {\n  fall: string\n  geolocation: { coordinates: Point; type: \"Point\" }\n  id: string\n  mass: string\n  name: string\n  nametype: string\n  recclass: string\n  reclat: string\n  reclong: string\n  year: string\n}\ntype MeteoriteGeo = Meteorite & {\n  geometry: Meteorite[\"geolocation\"]\n  type: \"Feature\"\n}\ntype Countries = {\n  features: Array<{\n    geometry: { coordinates: Point[]; type: \"Polygon\" }\n    id: string\n    properties: { name: string }\n    type: \"Feature\"\n  }>\n  type: \"FeatureCollection\"\n}\ntype State = {\n  isDuringAnimation: boolean\n  selectedMeteorite: string | null\n}\n\nconst fetchData = async () => {\n  const [countries, meteorites] = (await (Promise.all([\n    json(`${ROOT_PATH}data/d3js/meteorites-map/world_countries.json`),\n    json(`${ROOT_PATH}data/d3js/meteorites-map/meteorites.json`),\n  ]) as unknown)) as unknown[]\n\n  return ({\n    countries,\n    meteorites,\n  } as unknown) as { countries: Countries; meteorites: Meteorite[] }\n}\n\nconst margin = {\n  bottom: 0,\n  left: 0,\n  right: 0,\n  top: 0,\n}\n\nconst svgCutBottom = 250 // to remove the south pole which doesn't have any in the data\nconst height = 1000 - margin.top - margin.bottom\nconst modalHiddenTop = 250\nconst clickedMeteoriteDistortion = 20\n\nconst removeSelection = ({\n  meteoritesEls,\n  modal,\n  state,\n}: {\n  meteoritesEls: Selection<SVGPathElement, MeteoriteGeo, SVGGElement, unknown>\n  modal: Selection<HTMLDivElement, unknown, HTMLElement, unknown>\n  state: State\n}) => {\n  if (state.isDuringAnimation) {\n    return\n  }\n\n  state.selectedMeteorite = null\n\n  meteoritesEls.attr(\"class\", styles.meteorite)\n\n  anime({\n    targets: `.${styles.meteorite}`,\n    translateX: 0,\n    translateY: 0,\n  })\n\n  state.isDuringAnimation = true\n\n  anime({\n    complete: () => {\n      state.isDuringAnimation = false\n      modal.text(\"\")\n    },\n    targets: `.${styles.modal}`,\n    translateY: 0,\n  })\n}\n\nconst getNearMeteoritessWithVectors = ({\n  allMeteorites,\n  projectionFn,\n  targetMeteorite,\n}: {\n  allMeteorites: MeteoriteGeo[]\n  projectionFn: GeoProjection\n  targetMeteorite: MeteoriteGeo\n}) => {\n  const targetProj = projectionFn(targetMeteorite.geometry.coordinates) as [\n    number,\n    number\n  ]\n\n  const nearMeteorites = allMeteorites\n    .slice(0)\n    .filter((otherMeteorite) => !!(otherMeteorite.geometry as unknown))\n    .map((otherMeteorite) => {\n      const {\n        geometry: { coordinates: otherMeteoriteCoordinates },\n      } = otherMeteorite\n      const proj = projectionFn(otherMeteoriteCoordinates) as [number, number]\n      const vector = [proj[0] - targetProj[0], proj[1] - targetProj[1]]\n      const vectorLength = Math.sqrt(\n        Math.pow(vector[0], 2) + Math.pow(vector[1], 2)\n      )\n\n      return {\n        ...otherMeteorite,\n        vector,\n        vectorLength,\n      }\n    })\n    .filter(\n      (otherMeteorite) =>\n        otherMeteorite.vectorLength < 20 && otherMeteorite.vectorLength !== 0\n    )\n    .map((otherMeteorite) => ({\n      ...otherMeteorite,\n      vectorNormalized: [\n        otherMeteorite.vector[0] / otherMeteorite.vectorLength,\n        otherMeteorite.vector[1] / otherMeteorite.vectorLength,\n      ] as [number, number],\n    }))\n\n  const nearMeteoritesSet = new Set(nearMeteorites.map((a) => a.id))\n\n  const vectorsMap = nearMeteorites.reduce((acc, nearMeteorite) => {\n    acc[nearMeteorite.id] = nearMeteorite.vectorNormalized\n\n    return acc\n  }, {} as Record<string, [number, number]>)\n\n  return {\n    nearMeteorites,\n    nearMeteoritesSet,\n    vectorsMap,\n  }\n}\n\nconst texts = {\n  title: \"Meteorite landings in Earth\",\n}\n\nconst meteoriteClickHandler = ({\n  clickedMeteorite,\n  meteoritesEls,\n  meteoritesGeo,\n  modal,\n  projectionFn,\n  rootElId,\n  state,\n}: {\n  clickedMeteorite: MeteoriteGeo\n  meteoritesEls: Selection<SVGPathElement, MeteoriteGeo, SVGGElement, unknown>\n  meteoritesGeo: MeteoriteGeo[]\n  modal: Selection<HTMLDivElement, unknown, HTMLElement, unknown>\n  projectionFn: GeoProjection\n  rootElId: string\n  state: State\n}) => {\n  if (state.isDuringAnimation) {\n    return\n  }\n\n  if (state.selectedMeteorite === clickedMeteorite.id) {\n    removeSelection({\n      meteoritesEls,\n      modal,\n      state,\n    })\n\n    return\n  }\n\n  state.selectedMeteorite = clickedMeteorite.id\n\n  const year = timeFormat(\"%Y\")(new Date(clickedMeteorite.year))\n  const mass = new Intl.NumberFormat().format(+clickedMeteorite.mass)\n\n  modal.html(\n    `\n<h1>${clickedMeteorite.name}</h1>\n<p>Year: ${year}, Class: <a href=\"https://www.google.com/search?${qs.stringify({\n      q: `${clickedMeteorite.recclass} Meteorite Class`,\n    })}\" target=\"_blank\">${clickedMeteorite.recclass}</a></p>\n<p>${mass ? `Mass: ${mass}g, ` : \"\"}Name: ${clickedMeteorite.nametype}</p>\n<p><a href=\"https://www.google.com/search?${qs.stringify({\n      q: `${clickedMeteorite.name} Meteorite ${year}`,\n    })}\" target=\"_blank\">Click here to search</a></p>\n`.trim()\n  )\n\n  const { nearMeteoritesSet, vectorsMap } = getNearMeteoritessWithVectors({\n    allMeteorites: meteoritesGeo,\n    projectionFn,\n    targetMeteorite: clickedMeteorite,\n  })\n\n  const getShouldSet0 = (idx: number) => {\n    const { [idx]: animatedMeteorite } = meteoritesGeo\n\n    return (\n      animatedMeteorite.id === clickedMeteorite.id ||\n      !nearMeteoritesSet.has(animatedMeteorite.id)\n    )\n  }\n\n  meteoritesEls.attr(\"class\", (meteorite) => {\n    if (nearMeteoritesSet.has(meteorite.id)) {\n      return `${styles.moved} ${styles.meteorite}`\n    }\n\n    return meteorite.id === clickedMeteorite.id\n      ? `${styles.active} ${styles.meteorite}`\n      : styles.meteorite\n  })\n\n  const getTranslateFn = (coordIdx: number) => (_el: unknown, idx: number) => {\n    if (getShouldSet0(idx)) {\n      return 0\n    }\n\n    const { [idx]: animatedMeteorite } = meteoritesGeo\n    const { [animatedMeteorite.id]: vectorNormalized } = vectorsMap\n\n    return vectorNormalized[coordIdx] * clickedMeteoriteDistortion\n  }\n\n  anime({\n    targets: `.${styles.meteorite}`,\n    translateX: getTranslateFn(0),\n    translateY: getTranslateFn(1),\n  })\n\n  const rootEl = document.getElementById(rootElId) as HTMLElement\n  const { top } = rootEl.getBoundingClientRect()\n\n  anime({\n    targets: `.${styles.modal}`,\n    translateY: modalHiddenTop + 50 + top + window.scrollY,\n  })\n}\n\nconst addInfo = ({\n  svg,\n  width,\n}: {\n  svg: Selection<SVGSVGElement, unknown, HTMLElement, unknown>\n  width: number\n}) => {\n  const dialogId = `dialog-${uuidv1().slice(0, 6)}`\n\n  const group = svg\n    .append(\"g\")\n    .attr(\"transform\", `translate(${width - 50},50)`)\n    .attr(\"class\", styles.infoTrigger)\n\n  svg.append(\"g\").html(`\n<filter id=\"pulse\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">\n  <feTurbulence result=\"cloud\" baseFrequency=\".01\" seed=\"1\"  type=\"fractalNoise\" numOctaves=\"2\">\n  <animate attributeName=\"baseFrequency\" calcMode=\"paced\" begin=\"0s\" dur=\"12s\" values=\".01;.13;.01;\" repeatCount=\"indefinite\"/>\n  </feTurbulence>\n  <feComposite operator=\"in\" in=\"cloud\" in2=\"SourceGraphic\"/>\n</filter>\n    `)\n\n  const dialog = select(document.body).append(\"div\").attr(\"id\", dialogId).html(\n    `\n<p>The green circles refer to meteorites which were moved in the map to allow seeing the selected meteorite, which is in red.</p>\n<p>You can find the <a href=\"http://www.meteoritemarket.com/type.htm\">meteorites classification here</a></p>\n`.trim()\n  )\n\n  $(`#${dialogId}`).dialog({\n    autoOpen: false,\n    modal: true,\n    resizable: false,\n  })\n\n  group.append(\"circle\").attr(\"r\", \"20\").attr(\"filter\", \"url(#pulse)\")\n\n  group.append(\"text\").text(\"?\")\n\n  group.on(\"click\", () => {\n    $(`#${dialogId}`).dialog(\"open\")\n  })\n\n  return {\n    remove: () => {\n      dialog.remove()\n    },\n  }\n}\n\nconst zoomed = function (this: SVGSVGElement, e: any) {\n  select(this).transition().duration(500).attr(\"transform\", e.transform)\n}\n\ntype RenderChart = (o: {\n  countries: Countries\n  meteorites: Meteorite[]\n  rootElId: string\n}) => void\n\nconst renderChart: RenderChart = ({ countries, meteorites, rootElId }) => {\n  const rootEl = document.getElementById(rootElId) as HTMLElement\n  const width =\n    rootEl.getBoundingClientRect().width - margin.left - margin.right\n  const projectionFn = geoMercator().translate([width / 2, height / 2])\n  const path = geoPath().projection(projectionFn)\n\n  const state: State = {\n    isDuringAnimation: false,\n    selectedMeteorite: null,\n  }\n\n  const removeSelectionFn = () => {\n    removeSelection({\n      meteoritesEls,\n      modal,\n      state,\n    })\n  }\n\n  const meteoritessClickHandlerFn = (\n    clickEvent: MouseEvent,\n    clickedMeteorite: MeteoriteGeo\n  ) => {\n    clickEvent.stopPropagation()\n    meteoriteClickHandler({\n      clickedMeteorite,\n      meteoritesEls,\n      meteoritesGeo,\n      modal,\n      projectionFn,\n      rootElId,\n      state,\n    })\n  }\n\n  const meteoritesGeo: MeteoriteGeo[] = meteorites.map((a) => ({\n    ...a,\n    geometry: a.geolocation,\n    type: \"Feature\",\n  }))\n\n  const modal = select(`#${rootElId}`)\n    .append(\"div\")\n    .attr(\"class\", styles.modal)\n    .style(\"top\", `${-modalHiddenTop}px`)\n\n  const svg = select(`#${rootElId}`)\n    .append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height - svgCutBottom)\n    .style(\"cursor\", \"pointer\")\n    .on(\"click\", removeSelectionFn)\n    .style(\"transform-origin\", \"top left\")\n    .call(\n      zoom<SVGSVGElement, unknown>()\n        .extent([\n          [0, 0],\n          [width, height],\n        ])\n        .on(\"end\", zoomed)\n    )\n\n  const svgMap = svg.append(\"g\")\n\n  svg\n    .append(\"text\")\n    .text(texts.title)\n    .attr(\"text-anchor\", \"middle\")\n    .style(\"font-size\", \"20px\")\n    .attr(\"transform\", `translate(${width / 2},40)`)\n    .style(\"font-weight\", \"bold\")\n\n  addInfo({\n    svg,\n    width,\n  })\n\n  const countryClass = `country-${uuidv1().slice(0, 6)}`\n\n  svgMap\n    .append(\"g\")\n    .attr(\"class\", countryClass)\n    .selectAll(\"path\")\n    .data(countries.features)\n    .enter()\n    .append(\"path\")\n    .attr(\"d\", path as any)\n    .attr(\"fill\", \"#ccc\")\n    .style(\"stroke\", \"white\")\n    .style(\"stroke-width\", 1.5)\n    .style(\"opacity\", 0.8)\n    .style(\"stroke\", \"white\")\n    .style(\"stroke-width\", 0.3)\n    .on(\"click\", removeSelectionFn)\n    .attr(\"title\", (country) => country.properties.name)\n\n  const meteoritessWrapper = svgMap.append(\"g\").on(\"click\", removeSelectionFn)\n\n  const meteoritesEls = meteoritessWrapper\n    .selectAll(\"path\")\n    .data(meteoritesGeo)\n    .enter()\n    .append(\"path\")\n    .attr(\"d\", path as any)\n    .attr(\"class\", styles.meteorite)\n    .style(\"stroke\", \"white\")\n    .style(\"cursor\", \"pointer\")\n    .style(\"stroke-width\", 1.5)\n    .style(\"opacity\", 0.8)\n    .attr(\"title\", (d) => d.name)\n    .on(\"click\", meteoritessClickHandlerFn)\n\n  $(`.${styles.meteorite}`).tooltip({\n    track: true,\n  })\n\n  $(`.${countryClass}`).tooltip({\n    tooltipClass: styles.countryTooltip,\n    track: true,\n  })\n}\n\nconst main = async () => {\n  const { countries, meteorites } = await fetchData()\n\n  renderChart({\n    countries,\n    meteorites,\n    rootElId: \"chart\",\n  })\n}\n\nexport default main\n","import React from \"react\"\n\nimport { DemoPageProps } from \"@/common\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/meteorites-map/meteorites-map\"\n\nconst Area = ({ pageContext }: DemoPageProps) => (\n  <Demo\n    links={[\"/vendors/jquery-ui/themes/base/jquery-ui.min.css\"]}\n    main={main}\n    pageContext={pageContext}\n    scripts={[\"/vendors/jquery-ui/jquery-ui.min.js\"]}\n  >\n    <div id=\"chart\" />\n  </Demo>\n)\n\nexport default Area\n"],"sourceRoot":""}