{"version":3,"sources":["webpack://demos/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://demos/./src/demos/mareys-schedule/mareys-schedule.ts","webpack://demos/./src/pages/d3js/mareys-schedule.tsx","webpack://demos/./node_modules/lodash/_arrayEach.js","webpack://demos/./node_modules/lodash/_baseEach.js","webpack://demos/./node_modules/lodash/_baseFor.js","webpack://demos/./node_modules/lodash/_baseForOwn.js","webpack://demos/./node_modules/lodash/_castFunction.js","webpack://demos/./node_modules/lodash/_createBaseEach.js","webpack://demos/./node_modules/lodash/_createBaseFor.js","webpack://demos/./node_modules/lodash/each.js","webpack://demos/./node_modules/lodash/forEach.js","webpack://demos/./node_modules/lodash/identity.js","webpack://demos/./node_modules/lodash/last.js"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","fetchData","d3","ROOT_PATH","data","stations","trains","map","train","trainIndex","test","stopFragments","split","push","distance","name","zone","direction","index","number","stops","station","time","parseTime","filter","type","getTrainTitle","trainData","last","getFormatTime","timeStr","timeDate","formatTime","getHours","setDate","getDate","margin","height","renderChart","rootElId","rootEl","document","getElementById","classList","add","width","getBoundingClientRect","redraw","timeRange","x","domain","range","y","xAxisTop","ticks","tickFormat","xAxisBottom","svg","text","append","attr","style","filterBlackOpacity","selectAll","enter","d","call","on","_e","select","line","date","hours","ampm","minutes","getMinutes","toString","formatAMPM","refresh","limits","times","each","limit","wholeMinutes","fragment","Math","floor","minutesStr","String","finalTime","refreshOnHourChange","id","deviation","slope","feMerge","slider","$","change","demoInfo","pageContext","links","main","scripts","className","module","exports","array","iteratee","length","baseForOwn","baseEach","createBaseEach","baseFor","createBaseFor","keys","object","identity","isArrayLike","eachFunc","fromRight","collection","iterable","Object","keysFunc","props","arrayEach","castFunction","isArray"],"mappings":"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","file":"component---src-pages-d-3-js-mareys-schedule-tsx-d4b5602e0c1d16fa8857.js","sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import * as d3 from \"d3\"\nimport each from \"lodash/each\"\nimport last from \"lodash/last\"\n\nimport \"./mareys-schedule.styl\"\n\ntype RawDataItem = {\n  direction: string\n  number: string\n  type: string\n  [stop: string]: string\n}\n\ntype Station = {\n  distance: number\n  key: string\n  name: string\n  zone: number\n}\n\ntype Stop = {\n  station: Station\n  time: Date | null\n  trainIndex: number\n}\n\ntype Train = {\n  direction: string\n  index: number\n  number: string\n  stops: Stop[]\n  type: string\n}\n\ntype Data = {\n  stations: Station[]\n  trains: Train[]\n}\n\ntype Limits = [number, number]\ntype LimitsStr = [string, string]\n\ntype Redraw = (range: LimitsStr) => void\n\nconst fetchData = async (): Promise<Data> => {\n  const data = ((await d3.tsv(\n    `${ROOT_PATH}data/d3js/mareys-schedule/data.tsv`\n  )) as unknown) as RawDataItem[]\n\n  const stations: Station[] = []\n\n  const trains: Train[] = data.map((train, trainIndex) => {\n    if (trainIndex === 0) {\n      for (const key in train) {\n        if (/^stop\\|/.test(key)) {\n          const stopFragments = key.split(\"|\")\n\n          stations.push({\n            distance: +stopFragments[2],\n            key,\n            name: stopFragments[1],\n            zone: +stopFragments[3],\n          })\n        }\n      }\n    }\n\n    return {\n      direction: train.direction,\n      index: trainIndex,\n      number: train.number,\n      stops: stations\n        .map((station) => ({\n          station,\n          time: parseTime(train[station.key]),\n          trainIndex,\n        }))\n        .filter((station) => station.time !== null),\n      type: train.type,\n    }\n  })\n\n  return {\n    stations,\n    trains,\n  }\n}\n\nconst getTrainTitle = (trainData: Train) => {\n  if (trainData.direction === \"S\") {\n    return `${trainData.stops[0].station.name} -> ${\n      last(trainData.stops)!.station.name\n    }`\n  }\n\n  return `${last(trainData.stops)!.station.name} -> ${\n    trainData.stops[0].station.name\n  }`\n}\n\nconst refreshOnHourChange = ({\n  limits,\n  redraw,\n}: {\n  limits: Limits\n  redraw: Redraw\n}) => {\n  const times: string[] = []\n\n  each(limits, (limit) => {\n    const wholeMinutes = (limit / 100) * 1200\n\n    let fragment = \"AM\"\n    let hours = Math.floor(wholeMinutes / 60)\n    let minutes = Math.floor(wholeMinutes % 60)\n\n    if (minutes > 30) {\n      minutes = minutes - 30\n      hours = hours + 1\n    } else {\n      minutes = minutes + 30\n    }\n\n    hours = hours + 4\n\n    if (hours > 23) {\n      if (hours === 24) {\n        hours = hours - 12\n      } else {\n        hours = hours - 24\n      }\n    } else if (hours > 11) {\n      fragment = \"PM\"\n\n      if (hours !== 12) {\n        hours = hours - 12\n      }\n    }\n\n    const minutesStr = minutes < 10 ? `0${String(minutes)}` : minutes.toString()\n\n    const finalTime = `${String(hours)}:${minutesStr}${fragment}`\n\n    return times.push(finalTime)\n  })\n\n  redraw(times as LimitsStr)\n}\n\nconst getFormatTime = () => d3.timeParse(\"%I:%M%p\")\n\nconst parseTime = (timeStr: string) => {\n  const formatTime = getFormatTime()\n  const timeDate = formatTime(timeStr)\n\n  if (timeDate !== null && timeDate.getHours() < 3) {\n    timeDate.setDate(timeDate.getDate() + 1)\n  }\n\n  return timeDate\n}\n\nconst formatAMPM = function (date: Date) {\n  let hours = date.getHours()\n  const ampm = hours >= 12 ? \"PM\" : \"AM\"\n\n  hours = hours % 12\n  hours = hours ? hours : 12\n\n  const minutes = date.getMinutes()\n  const minutesStr = minutes < 10 ? `0${minutes}` : minutes.toString()\n\n  return `${hours}:${minutesStr} ${ampm}`\n}\n\nconst margin = {\n  bottom: 50,\n  left: 120,\n  right: 50,\n  top: 80,\n}\n\nconst height = 600 - margin.top - margin.bottom\n\nconst renderChart = ({ rootElId, data }: { rootElId: string; data: Data }) => {\n  const { stations, trains } = data\n  const rootEl = document.getElementById(rootElId) as HTMLElement\n\n  rootEl.classList.add(\"mareys-schedule-chart\")\n\n  const width =\n    rootEl.getBoundingClientRect().width - margin.left - margin.right\n\n  const redraw: Redraw = (timeRange) => {\n    const x = d3\n      .scaleTime()\n      .domain([parseTime(timeRange[0])!, parseTime(timeRange[1])!])\n      .range([0, width])\n    const y = d3.scaleLinear().range([0, height])\n    const formatTime = getFormatTime()\n    const xAxisTop = d3\n      .axisTop(x)\n      .ticks(8)\n      .tickFormat(formatTime as any)\n    const xAxisBottom = d3\n      .axisBottom(x)\n      .ticks(8)\n      .tickFormat(formatTime as any)\n\n    const svg = d3\n      .select(`#${rootElId}`)\n      .text(\"\")\n      .append(\"svg\")\n      .attr(\"height\", height + margin.top + margin.bottom)\n      .attr(\"width\", width + margin.left + margin.right)\n      .append(\"g\")\n      .attr(\"transform\", `translate(${margin.left},${margin.top})`)\n\n    svg\n      .append(\"text\")\n      .attr(\"class\", \"chart-title\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"transform\", `translate(${width / 2},-40)`)\n      .text(\"E.J. Marey’s graphical train schedule \" + \" (4:30AM - 1:30AM)\")\n      .style(\"font-weight\", \"bold\")\n\n    filterBlackOpacity(\"trains\", svg, 2, 0.2)\n\n    svg\n      .append(\"defs\")\n      .append(\"clipPath\")\n      .attr(\"id\", \"clip\")\n      .append(\"rect\")\n      .attr(\"y\", -margin.top)\n      .attr(\"width\", width)\n      .attr(\"height\", height + margin.top + margin.bottom)\n\n    y.domain(d3.extent(stations, (station) => station.distance) as Limits)\n\n    const station = svg\n      .append(\"g\")\n      .attr(\"class\", \"station\")\n      .selectAll(\"g\")\n      .data(stations)\n      .enter()\n      .append(\"g\")\n      .attr(\"transform\", (d) => `translate(0,${y(d.distance)})`)\n\n    station\n      .append(\"text\")\n      .attr(\"x\", -6)\n      .attr(\"dy\", \".35em\")\n      .text((d) => d.name)\n    station.append(\"line\").attr(\"x2\", width)\n    svg.append(\"g\").attr(\"class\", \"x top axis\").call(xAxisTop)\n    svg\n      .append(\"g\")\n      .attr(\"class\", \"x bottom axis\")\n      .attr(\"transform\", `translate(0,${height})`)\n      .call(xAxisBottom)\n\n    const mouseover = function (_e: unknown, d: Train) {\n      d3.select(`.train-${d.index}`).select(\"path\").style(\"stroke-width\", \"5px\")\n    }\n\n    const mouseleave = function (_e: unknown, d: Train) {\n      d3.select(`.train-${d.index}`)\n        .select(\"path\")\n        .style(\"stroke-width\", \"2.5px\")\n    }\n\n    const train = svg\n      .append(\"g\")\n      .attr(\"class\", \"train\")\n      .attr(\"clip-path\", \"url(#clip)\")\n      .selectAll(\"g\")\n      .data(trains.filter((d) => /[NLB]/.test(d.type)))\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", (d) => `${d.type} train-${d.index}`)\n      .on(\"mouseover\", mouseover)\n      .on(\"mouseleave\", mouseleave)\n\n    const line = d3\n      .line<Stop>()\n      .x((d) => x(d.time!))\n      .y((d) => y(d.station.distance))\n\n    train\n      .append(\"path\")\n      .attr(\"d\", (d) => line(d.stops))\n      .append(\"title\")\n      .text((d) => getTrainTitle(d))\n\n    train\n      .selectAll(\"circle\")\n      .data((d) => d.stops)\n      .enter()\n      .append(\"circle\")\n      .attr(\n        \"transform\",\n        (d) => `translate(${x(d.time!)},${y(d.station.distance)})`\n      )\n      .style(\"filter\", \"url(#drop-shadow-trains)\")\n      .attr(\"r\", \"5px\")\n      .append(\"title\")\n      .text(\n        (d) =>\n          `${getTrainTitle(trains[d.trainIndex])}\\n${\n            d.station.name\n          } at ${formatAMPM(d.time!)}`\n      )\n  }\n\n  return {\n    refresh: (limits: [number, number]) => {\n      refreshOnHourChange({\n        limits,\n        redraw,\n      })\n    },\n  }\n}\n\nconst main = async () => {\n  const rootElId = \"chart\"\n\n  const data = await fetchData()\n\n  const { refresh } = renderChart({\n    data,\n    rootElId,\n  })\n\n  const slider: any = $(\".slider\")\n\n  slider.slider({\n    change: () => {\n      const limits: Limits = slider.slider(\"values\")\n\n      refresh(limits)\n    },\n    range: true,\n  })\n\n  slider.slider(\"values\", [10, 50])\n}\n\nconst filterBlackOpacity = (\n  id: string,\n  svg: d3.Selection<SVGGElement, unknown, HTMLElement, unknown>,\n  deviation: number,\n  slope: number\n) => {\n  const defs = svg.append(\"defs\")\n  const filter = defs\n    .append(\"filter\")\n    .attr(\"height\", \"500%\")\n    .attr(\"id\", `drop-shadow-${id}`)\n    .attr(\"width\", \"500%\")\n    .attr(\"x\", \"-200%\")\n    .attr(\"y\", \"-200%\")\n\n  filter\n    .append(\"feGaussianBlur\")\n    .attr(\"in\", \"SourceAlpha\")\n    .attr(\"stdDeviation\", deviation)\n\n  filter.append(\"feOffset\").attr(\"dx\", 1).attr(\"dy\", 1)\n  filter\n    .append(\"feComponentTransfer\")\n    .append(\"feFuncA\")\n    .attr(\"slope\", slope)\n    .attr(\"type\", \"linear\")\n\n  const feMerge = filter.append(\"feMerge\")\n\n  feMerge.append(\"feMergeNode\")\n\n  feMerge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\")\n}\n\nexport default main\n","import React from \"react\"\n\nimport { DemoPageProps } from \"@/common\"\n\nimport Demo from \"@/components/demo\"\n\n// @ts-ignore\nimport main from \"@/demos/mareys-schedule/mareys-schedule\"\n\nconst MareysSchedule = ({ pageContext: { demoInfo } }: DemoPageProps) => (\n  <Demo\n    demoInfo={demoInfo}\n    links={[\"/vendors/jquery-ui/themes/base/jquery-ui.min.css\"]}\n    main={main}\n    scripts={[\"/vendors/jquery-ui/jquery-ui.min.js\"]}\n  >\n    <div>\n      <div className=\"slider\" />\n    </div>\n    <div id=\"chart\" />\n  </Demo>\n)\n\nexport default MareysSchedule\n","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nmodule.exports = arrayEach;\n","var baseForOwn = require('./_baseForOwn'),\n    createBaseEach = require('./_createBaseEach');\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nmodule.exports = baseEach;\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","var isArrayLike = require('./isArrayLike');\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nmodule.exports = createBaseEach;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","module.exports = require('./forEach');\n","var arrayEach = require('./_arrayEach'),\n    baseEach = require('./_baseEach'),\n    castFunction = require('./_castFunction'),\n    isArray = require('./isArray');\n\n/**\n * Iterates over elements of `collection` and invokes `iteratee` for each element.\n * The iteratee is invoked with three arguments: (value, index|key, collection).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n * property are iterated like arrays. To avoid this behavior use `_.forIn`\n * or `_.forOwn` for object iteration.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @alias each\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n * @see _.forEachRight\n * @example\n *\n * _.forEach([1, 2], function(value) {\n *   console.log(value);\n * });\n * // => Logs `1` then `2`.\n *\n * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forEach(collection, iteratee) {\n  var func = isArray(collection) ? arrayEach : baseEach;\n  return func(collection, castFunction(iteratee));\n}\n\nmodule.exports = forEach;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","/**\n * Gets the last element of `array`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to query.\n * @returns {*} Returns the last element of `array`.\n * @example\n *\n * _.last([1, 2, 3]);\n * // => 3\n */\nfunction last(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? array[length - 1] : undefined;\n}\n\nmodule.exports = last;\n"],"sourceRoot":""}