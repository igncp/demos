"use strict";(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[189],{9646:function(t,e,n){var r;n.d(e,{Z:function(){return f}});var a=new Uint8Array(16);function o(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(a)}var i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var s=function(t){return"string"==typeof t&&i.test(t)},c=[],l=0;l<256;++l)c.push((l+256).toString(16).substr(1));var u,d,p=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[t[e+0]]+c[t[e+1]]+c[t[e+2]]+c[t[e+3]]+"-"+c[t[e+4]]+c[t[e+5]]+"-"+c[t[e+6]]+c[t[e+7]]+"-"+c[t[e+8]]+c[t[e+9]]+"-"+c[t[e+10]]+c[t[e+11]]+c[t[e+12]]+c[t[e+13]]+c[t[e+14]]+c[t[e+15]]).toLowerCase();if(!s(n))throw TypeError("Stringified UUID is invalid");return n},m=0,h=0;var f=function(t,e,n){var r=e&&n||0,a=e||new Array(16),i=(t=t||{}).node||u,s=void 0!==t.clockseq?t.clockseq:d;if(null==i||null==s){var c=t.random||(t.rng||o)();null==i&&(i=u=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==s&&(s=d=16383&(c[6]<<8|c[7]))}var l=void 0!==t.msecs?t.msecs:Date.now(),f=void 0!==t.nsecs?t.nsecs:h+1,g=l-m+(f-h)/1e4;if(g<0&&void 0===t.clockseq&&(s=s+1&16383),(g<0||l>m)&&void 0===t.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");m=l,h=f,d=s;var v=(1e4*(268435455&(l+=122192928e5))+f)%4294967296;a[r++]=v>>>24&255,a[r++]=v>>>16&255,a[r++]=v>>>8&255,a[r++]=255&v;var y=l/4294967296*1e4&268435455;a[r++]=y>>>8&255,a[r++]=255&y,a[r++]=y>>>24&15|16,a[r++]=y>>>16&255,a[r++]=s>>>8|128,a[r++]=255&s;for(var I=0;I<6;++I)a[r+I]=i[I];return e||p(a)}},6126:function(t,e,n){var r;n.d(e,{H:function(){return a},d:function(){return r}}),function(t){t.STORYBOOK="storybook",t.TESTING="testing"}(r||(r={}));var a={SCRIPT:"/vendors/jquery-ui/jquery-ui.min.js",STYLE:"/vendors/jquery-ui/themes/base/jquery-ui.min.css"}},2682:function(t,e,n){n.r(e),n.d(e,{default:function(){return T}});var r=n(7294),a=n(6126),o=n(4275),i=n(8634),s=n(2656),c=n.n(s),l=n(1354),u=n(2149),d=n(9646),p="area-chart-module--axis--2jpe6",m=1e3,h=function(){function t(t){var e=this;this.hasVoronoi=!1,this.handleWindowResize=function(){e.render()},this.config=t;var n=t.rootElId,r=(0,l.Ys)("#"+n).append("svg"),a=r.append("g").attr("class","area-chart-module--areaChart--Ked6_"),o=a.append("text").attr("class","area-chart-module--chartTitle--3_EHS").attr("text-anchor","middle").style("font-weight","bold"),i=a.append("g"),s=a.append("g"),c=a.append("path"),u=a.append("path"),d=a.append("g"),p=a.append("clipPath").attr("id","clip").append("rect");!function(t){var e=t.deviation,n=t.id,r=t.slope,a=t.svg.append("defs").append("filter").attr("height","500%").attr("id","drop-shadow-"+n).attr("width","500%").attr("x","-200%").attr("y","-200%");a.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",e),a.append("feOffset").attr("dx",1).attr("dy",1),a.append("feComponentTransfer").append("feFuncA").attr("slope",r).attr("type","linear");var o=a.append("feMerge");o.append("feMergeNode"),o.append("feMergeNode").attr("in","SourceGraphic")}({deviation:2,id:"points",slope:.5,svg:a}),this.elements={areaSel:u,chartTitleSel:o,clipRect:p,lineSel:c,svg:r,svgG:a,voronoiGroup:d,xAxisSel:i,yAxisSel:s},this.render(),window.addEventListener("resize",this.handleWindowResize)}t.renderChart=function(e){return new t(e)};var e=t.prototype;return e.toggleVoronoi=function(){this.hasVoronoi=!this.hasVoronoi,this.setVoronoi()},e.refresh=function(){this.render()},e.tearDown=function(){window.removeEventListener("resize",this.handleWindowResize)},e.render=function(){this.setDimensions();var t=this.config,e=t.areaPoints,n="tooltip-item-"+(0,d.Z)().slice(0,6),r="point-"+(0,d.Z)().slice(0,6)+"-",a=this.dimensions,o=a.height,i=a.innerWidth,s=a.isSmallDevice,c=a.margin,h=a.width,f=this.elements,g=f.areaSel,v=f.chartTitleSel,y=f.clipRect,I=f.lineSel,w=f.svg,V=f.svgG,S=f.voronoiGroup,x=f.xAxisSel,b=f.yAxisSel;w.attr("height",o+c.top+c.bottom).attr("width",i+c.left+c.right),V.attr("transform","translate("+c.left+","+c.top+")"),v.attr("transform","translate("+(h/2-c.left)+","+"-15)").text((function(){return s?t.chartTitleShort:t.chartTitle}));var C=(0,l.Fp7)(e,t.getItemXValue),E=(0,l.VV$)(e,t.getItemXValue),k=(0,l.Fp7)(e,t.getItemYValue),A=(0,l.VV$)(e,t.getItemYValue),T=(0,l.BYU)().domain([E,C]).range([0,i]),D=(0,l.BYU)().domain([k+.05,A-.05]).range([0,o]),R=function(e){return T(t.getItemXValue(e))},Y=function(e){return D(t.getItemYValue(e))},L=s?(0,l.aE8)().domain([0,500]).range(Array.from({length:6}).map((function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[1];return r})))(h):null,j=(0,l.LLu)(T).tickFormat((0,l.WUZ)(".0f")).ticks(L),G=(0,l.y4O)(D).tickFormat((0,l.WUZ)(".0%")).tickSize(10);x.attr("class","area-chart-module--x--1LLGJ "+p).attr("transform","translate(0,"+o+")").call(j).selectAll("text").attr("dy","1.25em"),b.attr("class","area-chart-module--y--1GhEy "+p).call(G).selectAll("text").attr("dx","-.25em");var M=(0,l.SOn)().x(R).y0(o).y1(Y),U=(0,l.jvg)().x(R).y(Y);I.datum(e).attr("clip-path","url(#clip)").attr("class","area-chart-module--line--1O1QS").transition().duration(m).attr("d",U),y.attr("height",o).attr("width",i),g.datum(e).attr("class","area-chart-module--area--ul7t6").attr("clip-path","url(#clip)").transition().duration(m).attr("d",M);var B=u.Z.from(e,R,Y).voronoi([-c.left,-c.top,i+c.right,o+c.bottom]),Z=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var o=n[1];(0,l.Ys)("."+r+t.getItemId(o)).style("display","block")},z=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var o=n[1];(0,l.Ys)("."+r+t.getItemId(o)).style("display","none")},N=V.selectAll("circle").data(e);N.enter().append("circle"),N.exit().remove(),V.selectAll("circle").attr("r","5px").style("filter","url(#drop-shadow-points)").attr("transform",(function(t){return"translate("+R(t)+","+Y(t)+")"})).attr("class",(function(e){return"area-chart-module--point--3nljr "+n+" "+r+t.getItemId(e)})).on("mouseenter",Z).on("mouseleave",z).attr("title",t.getItemTitle);var O=S.selectAll("path").data(e,(function(e){return t.getItemId(e)}));O.enter().append("path"),O.exit().remove(),S.attr("class","area-chart-module--voronoi--3QRtu").selectAll("path").on("mouseenter",Z).on("mouseleave",z).attr("class",n).attr("title",t.getItemTitle).transition().duration(m).attr("d",(function(e){return B.renderCell(t.getItemId(e))})),$("."+n).tooltip({track:!0}),this.setVoronoi()},e.setVoronoi=function(){var t=this.elements.voronoiGroup,e=this.hasVoronoi,n="area-chart-module--showVoronoi--3rQXC",r=t.attr("class").replace(n,"").trim(),a=e?r+" "+n:r;t.attr("class",a)},e.setDimensions=function(){var t=this.config.rootElId,e=document.getElementById(t).getBoundingClientRect().width,n=e<500,r={bottom:50,left:n?50:70,right:n?10:50,top:50},a=e-r.left-r.right,o=400-r.top-r.bottom;this.dimensions={height:o,innerWidth:a,isSmallDevice:n,margin:r,width:e}},t}(),f="chart",g=function(t){return t.getYear()},v=function(t){return t.getNormalizedValue()},y=function(t){return t.getId()},I=function(t){return t.getSummary()},w="Share of top decile [aka top 10%] in national income",V=w.replace(" [aka top 10%]",""),S=function(t){return{areaPoints:t,chartTitle:w,chartTitleShort:V,getItemId:y,getItemTitle:I,getItemXValue:g,getItemYValue:v,rootElId:f}},x="toggle-voronoi",b="update-voronoi",C=function(t){var e=t.onToggleVoronoiClick,n=t.onUpdateRandomValue,r=document.getElementById(x),a=document.getElementById(b);r.addEventListener("click",(function(t){t.preventDefault(),e()})),a.addEventListener("click",(function(t){t.preventDefault(),n()}))},E=function(){function t(t){this.incomeItemData=t,this.incomeItemData.percent=Number(this.incomeItemData.percent)}t.fetchAndCreateCollection=function(){var e=(0,i.Z)(c().mark((function e(){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.gyn)("/demos/data/d3js/area/data.csv");case 2:return n=e.sent,r=n.map((function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],a=e[1];return Object.assign({},r,{pointIndex:a})})),e.abrupt("return",r.map((function(e){return new t(e)})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();var e=t.prototype;return e.getYear=function(){return this.incomeItemData.year},e.changePercent=function(t){var e=Math.max(this.incomeItemData.percent+t,0),n=Math.min(100,e);this.incomeItemData.percent=n},e.getNormalizedValue=function(){return this.incomeItemData.percent/100},e.getId=function(){return this.incomeItemData.pointIndex},e.getSummary=function(){var t=this.incomeItemData;return"Year: "+t.year+", Percent: "+t.percent.toFixed(2)+"%"},t}(),k=function(){var t=(0,i.Z)(c().mark((function t(){var e,n,r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.fetchAndCreateCollection();case 2:e=t.sent,n=S(e),r=h.renderChart(n),C({onToggleVoronoiClick:function(){r.toggleVoronoi()},onUpdateRandomValue:function(){Array.from({length:50}).forEach((function(){var t=Math.floor(Math.random()*e.length),n=10*Math.random()*(Math.random()>.5?1:-1);e[t].changePercent(n)})),r.refresh()}});case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),A=k,T=function(t){var e=t.pageContext;return r.createElement(o.Z,{links:[a.H.STYLE],main:A,pageContext:e,scripts:[a.H.SCRIPT]},r.createElement("form",{style:{marginBottom:20}},r.createElement("button",{className:"btn btn-info",id:x,type:"button"},"Toggle Voronoi"),r.createElement("button",{className:"btn btn-success",id:b,style:{marginLeft:20},type:"button"},"Update Random Values")),r.createElement("div",{id:f}))}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-area-tsx-d57a1d9a27026c5845f4.js.map