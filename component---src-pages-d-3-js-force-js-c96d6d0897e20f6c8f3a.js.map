{"version":3,"sources":["webpack://demos/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://demos/./src/demos/force/force.js","webpack://demos/./src/pages/d3js/force.js"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","fetchData","all","d3","json","ROOT_PATH","_error","root","nodes","links","renderGraph","data","rootElId","filter","el","source","target","width","document","getElementById","getBoundingClientRect","force","layout","size","linkDistance","charge","linkStrength","d","strength","on","path","attr","dx","x","dy","y","dr","Math","sqrt","linkLabel","deltaX","deltaY","node","start","svg","select","append","selectAll","enter","String","text","name","call","drag","demoInfo","pageContext","main","scripts","className","id"],"mappings":"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","file":"component---src-pages-d-3-js-force-js-c96d6d0897e20f6c8f3a.js","sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","const fetchData = async () => {\n  const [nodes, links] = await Promise.all([\n    new Promise((resolve) => {\n      d3.json(`${ROOT_PATH}data/d3js/force/nodes.json`, (_error, root) => {\n        resolve(root)\n      })\n    }),\n    new Promise((resolve) => {\n      d3.json(`${ROOT_PATH}data/d3js/force/links.json`, (_error, root) => {\n        resolve(root)\n      })\n    }),\n  ])\n\n  return {\n    links,\n    nodes,\n  }\n}\n\nconst renderGraph = function ({ data, rootElId }) {\n  let links = data.links.filter((el) => el.source !== el.target)\n\n  const { nodes } = data\n  const { width } = document.getElementById(\"chart\").getBoundingClientRect()\n  const height = 600\n\n  const tick = function () {\n    path.attr(\"d\", (d) => {\n      const dx = d.target.x - d.source.x\n      const dy = d.target.y - d.source.y\n      const dr = Math.sqrt(dx * dx + dy * dy)\n\n      return `M${d.source.x},${d.source.y}A${dr},${dr} 0 0,1 ${d.target.x},${d.target.y}`\n    })\n    linkLabel\n      .attr(\"x\", (d) => {\n        const deltaX = d.target.x - d.source.x\n\n        if (d.source.y < d.target.y) {\n          return d.source.x + deltaX * 0.3 + 15\n        }\n\n        return d.source.x + deltaX * 0.3 - 15\n      })\n      .attr(\"y\", (d) => {\n        const deltaY = d.target.y - d.source.y\n\n        return d.source.y + deltaY * 0.3\n      })\n      .attr(\"text-anchor\", (d) => {\n        if (d.source.y < d.target.y) {\n          return \"beginning\"\n        }\n\n        return \"end\"\n      })\n\n    return node.attr(\"transform\", (d) => `translate(${d.x},${d.y})`)\n  }\n\n  const force = d3.layout\n    .force()\n    .nodes(nodes)\n    .links(links)\n    .size([width, height])\n    .linkDistance(60)\n    .charge(-400)\n    .linkStrength((d) => d.strength)\n    .on(\"tick\", tick)\n    .start()\n\n  const svg = d3\n    .select(`#${rootElId}`)\n    .append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height)\n\n  svg\n    .append(\"svg:defs\")\n    .selectAll(\"marker\")\n    .data([\"end\"])\n    .enter()\n    .append(\"svg:marker\")\n    .attr(\"id\", String)\n    .attr(\"viewBox\", \"0 -5 10 10\")\n    .attr(\"refX\", 15)\n    .attr(\"refY\", -1.5)\n    .attr(\"markerWidth\", 6)\n    .attr(\"markerHeight\", 6)\n    .attr(\"orient\", \"auto\")\n    .append(\"svg:path\")\n    .attr(\"d\", \"M0,-5L10,0L0,5\")\n  links = svg\n    .selectAll(\".link\")\n    .data(force.links())\n    .enter()\n    .append(\"g\")\n    .attr(\"class\", \"link\")\n\n  const path = links\n    .append(\"svg:path\")\n    .attr(\"class\", \"link\")\n    .attr(\"marker-end\", \"url(#end)\")\n\n  const linkLabel = links.append(\"text\").text((d) => d.name)\n\n  const node = svg\n    .selectAll(\".node\")\n    .data(force.nodes())\n    .enter()\n    .append(\"g\")\n    .attr(\"class\", \"node\")\n    .call(force.drag)\n\n  node.append(\"circle\").attr(\"r\", 5)\n\n  return node\n    .append(\"text\")\n    .attr(\"x\", 12)\n    .attr(\"dy\", \".35em\")\n    .text((d) => d.name)\n}\n\nconst main = async () => {\n  const data = await fetchData()\n\n  renderGraph({\n    data,\n    rootElId: \"chart\",\n  })\n}\n\nexport default main\n","import React from \"react\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/force/force\"\nimport \"@/demos/force/force.styl\"\n\nconst Force = ({ pageContext: { demoInfo } }) => (\n  <Demo demoInfo={demoInfo} main={main} scripts={[\"/vendors/d3/d3.min.js\"]}>\n    <div className=\"force-chart\" id=\"chart\" />\n  </Demo>\n)\n\nexport default Force\n"],"sourceRoot":""}