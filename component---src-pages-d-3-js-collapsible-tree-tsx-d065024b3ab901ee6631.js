(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[692],{3492:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return L}});var r=e(7294),i=e(4275),o=e(8634),a=e(2656),d=e.n(a),c=e(1354),l=e(1504),u="tree-link",s=function(){function t(t){this.initialOpts=t,this.linkPath=(0,c.h5h)().x((function(t){return t.y})).y((function(t){return t.x})),this.linkG=t.container.append("g").attr("fill","none").attr("stroke",t.linkDefaultColor).attr("stroke-opacity",.4).attr("stroke-width",1.5)}var n=t.prototype;return n.update=function(t){var n,e=this.initialOpts,r=e.getInitialPosition,i=e.getPosition,o=e.openCloseAnimationDuration,a=this.linkG,d=this.linkPath,c=t.getData,s=t.source,f=(n=a.selectAll("path")).data.apply(n,(0,l.Z)(c())),h=f.enter().append("path").attr("class",u).attr("d",(function(){var t=r(s);return d({source:t,target:t})}));f.merge(h).transition().duration(o).attr("d",(function(t){return d(t)})),f.exit().transition().duration(o).remove().attr("d",(function(){var t=i(s);return d({source:t,target:t})}))},n.getSelection=function(){return this.linkG.selectAll(".tree-link")},t}(),f=e(7956),h=function(){function t(t){this.className="small-button-"+Math.random().toFixed(6).split(".")[1],this.initialOpts=t}var n=t.prototype;return n.add=function(t){var n=t.container,e=t.onClick,r=this.initialOpts,i=r.dx,o=r.fontSize,a=r.text,d=n.append("g").style("transform","translate("+i+",-10px)").attr("class",this.className).style("display","none").attr("cursor","pointer");d.append("circle").attr("r",8).attr("cx",5).attr("cy",-7).attr("fill","#ddd").style("font-size",o).text(a);var c=d.append("text").style("font-size",o).text(a);d.on("mouseenter",(function(){c.attr("fill","orange")})).on("mouseleave",(function(){c.attr("fill",null)})).on("click",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0],o=n[1];i.stopPropagation(),e(o)}))},n.hide=function(t){var n=t.container,e=t.filterFn;(0,c.Ys)(n).selectAll("."+this.className).style("display",(function(t){return!e||e(t)?"none":"block"}))},t}(),p="node-circle",v="node-label",g=function(){function t(t){this.hoveredItems=new Set,this.initialOpts=t,this.nodeG=this.initialOpts.container.append("g").attr("pointer-events","all"),this.circleLinkForEffect=this.initialOpts.container.insert("circle",":first-child").attr("r",4).attr("fill","none"),this.plusButton=new h({dx:"0px",fontSize:"20px",text:"+"}),this.minusButton=new h({dx:"-15px",fontSize:"25px",text:"-"})}return t.prototype.update=function(t){var n,e=t.source,r=this.circleLinkForEffect,i=this.hoveredItems,o=this.initialOpts,a=o.displayRemoveButton,d=o.getInitialPosition,u=o.getNodeId,s=o.getPointingLinkForNode,h=o.getPosition,g=o.getText,x=o.hasDescendants,y=o.linkDefaultColor,m=(n=this.nodeG.selectAll("g")).data.apply(n,(0,l.Z)(t.getData())),k=function(t){return x(t)?i.has(u(t))?"blue":"green":"red"},w=m.enter().append("g").attr("transform",(function(){var t=d(e);return"translate("+t.y+","+t.x+")"})).attr("fill-opacity",0).attr("stroke-opacity",0).on("click",(function(){for(var n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];var i=e[1];t.onNodeClick(i)}));w.append("circle").attr("r",10).attr("class",p).attr("stroke-width",10);w.append("text").attr("class",v).attr("dy","5px").style("font-size","20px").text(g).clone(!0).lower().attr("stroke-linejoin","round").attr("stroke-width",3).attr("stroke","white");var I=this.minusButton,N=this.plusButton,A=[N,I],b=function(t){A.forEach((function(n){n.hide({container:t,filterFn:function(t){return n===I&&!a(t)}})}))};w.on("mouseenter",(function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];var o=n[1];i.add(u(o)),(0,c.Ys)(this).select("circle").attr("fill",k),b(this);var a=s(o);if(a.size()){a.style("stroke","orange"),r.attr("fill","orange");var d=f.Z.path(a.node());(0,f.Z)({duration:500,easing:"easeInOutSine",endDelay:1e3,loop:!0,targets:r.node(),translateX:d("x"),translateY:d("y")})}})).on("mouseleave",(function(){for(var t=this,n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];var a=e[1];i.delete(u(a)),(0,c.Ys)(this).select("circle").attr("fill",k),A.forEach((function(n){n.hide({container:t})}));var d=s(a);d.size()&&(r.attr("fill","none"),d.style("stroke",y),f.Z.remove(r.node()))})),m.merge(w).transition().duration(this.initialOpts.openCloseAnimationDuration).attr("transform",(function(t){var n=h(t);return"translate("+n.y+","+n.x+")"})).attr("fill-opacity",1).attr("stroke-opacity",1),[m,w].forEach((function(n){N.add({container:n,onClick:function(n){t.onNodeAdd(n)}}),I.add({container:n,onClick:function(n){t.onNodeRemove(n)}}),n.each((function(t){i.has(u(t))&&b(this)})),n.attr("cursor",(function(t){return x(t)?"pointer":"default"})),n.selectAll(".node-circle").attr("fill",k),n.selectAll(".node-label").attr("dx",(function(t){return x(t)?"-10px":"10px"})).attr("x",(function(t){return x(t)?-6:6})).attr("text-anchor",(function(t){return x(t)?"end":"start"}))}));var C=h(e);m.exit().transition().duration(this.initialOpts.openCloseAnimationDuration).remove().attr("transform","translate("+C.y+","+C.x+")").attr("fill-opacity",0).attr("stroke-opacity",0)},t}(),x="#555",y=function t(n){var e,r=n.getId,i=n.node,o=n.nodeId;return r(i)===o?i:(null!==(e=i.children)&&void 0!==e?e:[]).reduce((function(){for(var n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];var a=e[0],d=e[1];return null!=a?a:t({getId:r,node:d,nodeId:o})}),null)},m=function t(n){var e,r=n.getId,i=n.node,o=n.nodeId;return null!==(e=i.children)&&void 0!==e&&e.length?i.children.some((function(t){return r(t)===o}))?i:i.children.reduce((function(){for(var n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];var a=e[0],d=e[1];return null!=a?a:t({getId:r,node:d,nodeId:o})}),null):null},k=20,w=120,I=120,N=20,A=800-N-k,b=function t(n){var e;return Object.assign({},n,{_children:void 0,children:(null!==(e=n.children)&&void 0!==e?e:[]).map((function(n){return t(n)})),x:0,x0:0,y:0,y0:0})},C=function(t){var n=t.rootData,e=t.rootElId,r=document.getElementById(e);r.classList.add("collapsible-tree-module--collapsibleTreeChart--39sg1");var i=r.getBoundingClientRect().width-I-w,o=b(n),a=(0,c.bT9)(o);a.data.x0=A/2,a.data.y0=0;var d=(0,c.G_s)().nodeSize([40,250]),l=d(a);l.descendants().forEach((function(t){t.data._children=t.children,t.depth&&(t.children=void 0)}));var u=(0,c.Ys)("#"+e).append("svg").attr("width",i+I+w).attr("height",A+N+k).append("g");!function(t){var n=w,e=A/2,r={x:0,y:0},i=(0,c.ohM)().on("drag",(function(i){r.x+=i.dx,r.y+=i.dy,t.attr("transform","translate("+(n+r.x)+","+(e+r.y)+")")}));t.attr("transform","translate("+n+","+e+")"),(0,c.Ys)(t.node().parentNode).style("cursor","move").call(i)}(u);var f={container:u,getInitialPosition:function(t){return{x:t.data.x0,y:t.data.y0}},getPosition:function(t){return{x:t.x,y:t.y}},linkDefaultColor:x,openCloseAnimationDuration:750},h=new s(f),p=new g(Object.assign({},f,{displayRemoveButton:function(n){return t.canBeRemoved(n.data)},getNodeId:function(n){return t.getNodeId(n.data)},getPointingLinkForNode:function(n){return h.getSelection().filter((function(e){return t.getNodeId(e.target.data)===t.getNodeId(n.data)}))},getText:function(n){return t.getNodeLabel(n.data)},hasDescendants:function(t){var n;return!(null===(n=t.data.children)||void 0===n||!n.length)}}));!function n(e){var r=l.descendants().reverse(),i=l.links();d(a),p.update({getData:function(){return[r,function(n){return t.getNodeId(n.data)}]},onNodeAdd:function(e){var r,i,o,a=t.onNodeAdd(e.data),d=b(a),l=(0,c.bT9)(d);l.depth=e.depth+1,l.parent=e,e.children=null!==(r=null!==(i=e.children)&&void 0!==i?i:e.data._children)&&void 0!==r?r:[],e.data._children=e.children,e.children.push(l),e.data.children=null!==(o=e.data.children)&&void 0!==o?o:[],e.data.children.push(l.data),window.requestAnimationFrame((function(){n(e)}))},onNodeClick:function(t){t.children=t.children?void 0:t.data._children,n(t)},onNodeRemove:function(e){var r=t.onNodeRemove(e.data),i=y({getId:function(n){return t.getNodeId(n.data)},node:a,nodeId:t.getNodeId(r)}),o=i.children.findIndex((function(n){return t.getNodeId(n.data)===t.getNodeId(e.data)}));i.children.splice(o,1),n(i)},source:e}),h.update({getData:function(){return[i,function(n){return t.getNodeId(n.target.data)}]},source:e}),l.eachBefore((function(t){t.data.x0=t.x,t.data.y0=t.y}))}(l)},D="chart",O=function t(n){var e,r=n.context,i=n.rawNode,o=r.id;return r.id+=1,Object.assign({},i,{children:(null!==(e=i.children)&&void 0!==e?e:[]).map((function(n){return t({context:r,rawNode:n})})),id:o})},E=function t(n){var e;return(null!==(e=n.children)&&void 0!==e?e:[]).reduce((function(){for(var n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];var i=e[0],o=e[1];return Math.max(t(o),i)}),n.id)},P=function(){var t=(0,o.Z)(d().mark((function t(){var n;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,c.AVB)("/demos/data/d3js/collapsible-tree/data.json");case 2:return n=t.sent,t.abrupt("return",O({context:{id:0},rawNode:n}));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),B=function(t){return t.name},z=function(t){return t.id},R=function(t){return 0!==t.id},Z=function(t){return{canBeRemoved:R,getNodeId:z,getNodeLabel:B,onNodeAdd:function(n){var e,r=E(t),i=y({getId:function(t){return t.id},node:t,nodeId:n.id});if(!i)throw new Error("Node not found");var o=r+1;i.children=null!==(e=i.children)&&void 0!==e?e:[];var a={id:o,name:"New Node id: "+o};return i.children.push(a),a},onNodeRemove:function(n){var e=m({getId:function(t){return t.id},node:t,nodeId:n.id});if(!e)throw new Error("No parent node");var r=e.children.findIndex((function(t){return t.id===n.id}));return e.children.splice(r,1),e},rootData:t,rootElId:D}},F=function(){var t=(0,o.Z)(d().mark((function t(){var n,e;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P();case 2:n=t.sent,e=Z(n),C(e);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),S=F,L=function(t){var n=t.pageContext;return r.createElement(i.Z,{main:S,pageContext:n},r.createElement("div",{id:D}))}},2656:function(t,n,e){t.exports=e(3076)},8634:function(t,n,e){"use strict";function r(t,n,e,r,i,o,a){try{var d=t[o](a),c=d.value}catch(l){return void e(l)}d.done?n(c):Promise.resolve(c).then(r,i)}function i(t){return function(){var n=this,e=arguments;return new Promise((function(i,o){var a=t.apply(n,e);function d(t){r(a,i,o,d,c,"next",t)}function c(t){r(a,i,o,d,c,"throw",t)}d(void 0)}))}}e.d(n,{Z:function(){return i}})}}]);
//# sourceMappingURL=component---src-pages-d-3-js-collapsible-tree-tsx-d065024b3ab901ee6631.js.map