/*! For license information please see component---src-pages-d-3-js-population-circles-tsx-0762f052bab033ead834.js.LICENSE.txt */
(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[147],{581:function(e,t){"use strict";var n="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function r(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on".concat(t),(function(){n(window.event)}))}function a(e,t){for(var n=t.slice(0,t.length-1),r=0;r<n.length;r++)n[r]=e[n[r].toLowerCase()];return n}function o(e){"string"!=typeof e&&(e="");for(var t=(e=e.replace(/\s/g,"")).split(","),n=t.lastIndexOf("");n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}for(var i={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":n?173:189,"=":n?61:187,";":n?59:186,"'":222,"[":219,"]":221,"\\":220},l={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},u={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},c={16:!1,18:!1,17:!1,91:!1},s={},p=1;p<20;p++)i["f".concat(p)]=111+p;var f=[],d="all",m=[],v=function(e){return i[e.toLowerCase()]||l[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)};function y(e){d=e||"all"}function h(){return d||"all"}var g=function(e){var t=e.key,n=e.scope,r=e.method,i=e.splitKey,u=void 0===i?"+":i;o(t).forEach((function(e){var t=e.split(u),o=t.length,i=t[o-1],c="*"===i?"*":v(i);if(s[c]){n||(n=h());var p=o>1?a(l,t):[];s[c]=s[c].map((function(e){return(!r||e.method===r)&&e.scope===n&&function(e,t){for(var n=e.length>=t.length?e:t,r=e.length>=t.length?t:e,a=!0,o=0;o<n.length;o++)-1===r.indexOf(n[o])&&(a=!1);return a}(e.mods,p)?{}:e}))}}))};function w(e,t,n){var r;if(t.scope===n||"all"===t.scope){for(var a in r=t.mods.length>0,c)Object.prototype.hasOwnProperty.call(c,a)&&(!c[a]&&t.mods.indexOf(+a)>-1||c[a]&&-1===t.mods.indexOf(+a))&&(r=!1);(0!==t.mods.length||c[16]||c[18]||c[17]||c[91])&&!r&&"*"!==t.shortcut||!1===t.method(e,t)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function k(e){var t=s["*"],n=e.keyCode||e.which||e.charCode;if(x.filter.call(this,e)){if(93!==n&&224!==n||(n=91),-1===f.indexOf(n)&&229!==n&&f.push(n),["ctrlKey","altKey","shiftKey","metaKey"].forEach((function(t){var n=u[t];e[t]&&-1===f.indexOf(n)?f.push(n):!e[t]&&f.indexOf(n)>-1?f.splice(f.indexOf(n),1):"metaKey"===t&&e[t]&&3===f.length&&(e.ctrlKey||e.shiftKey||e.altKey||(f=f.slice(f.indexOf(n))))})),n in c){for(var r in c[n]=!0,l)l[r]===n&&(x[r]=!0);if(!t)return}for(var a in c)Object.prototype.hasOwnProperty.call(c,a)&&(c[a]=e[u[a]]);e.getModifierState&&(!e.altKey||e.ctrlKey)&&e.getModifierState("AltGraph")&&(-1===f.indexOf(17)&&f.push(17),-1===f.indexOf(18)&&f.push(18),c[17]=!0,c[18]=!0);var o=h();if(t)for(var i=0;i<t.length;i++)t[i].scope===o&&("keydown"===e.type&&t[i].keydown||"keyup"===e.type&&t[i].keyup)&&w(e,t[i],o);if(n in s)for(var p=0;p<s[n].length;p++)if(("keydown"===e.type&&s[n][p].keydown||"keyup"===e.type&&s[n][p].keyup)&&s[n][p].key){for(var d=s[n][p],m=d.splitKey,y=d.key.split(m),g=[],k=0;k<y.length;k++)g.push(v(y[k]));g.sort().join("")===f.sort().join("")&&w(e,d,o)}}}function x(e,t,n){f=[];var i=o(e),u=[],p="all",d=document,y=0,h=!1,g=!0,w="+";for(void 0===n&&"function"==typeof t&&(n=t),"[object Object]"===Object.prototype.toString.call(t)&&(t.scope&&(p=t.scope),t.element&&(d=t.element),t.keyup&&(h=t.keyup),void 0!==t.keydown&&(g=t.keydown),"string"==typeof t.splitKey&&(w=t.splitKey)),"string"==typeof t&&(p=t);y<i.length;y++)u=[],(e=i[y].split(w)).length>1&&(u=a(l,e)),(e="*"===(e=e[e.length-1])?"*":v(e))in s||(s[e]=[]),s[e].push({keyup:h,keydown:g,scope:p,mods:u,shortcut:i[y],method:n,key:i[y],splitKey:w});void 0!==d&&!function(e){return m.indexOf(e)>-1}(d)&&window&&(m.push(d),r(d,"keydown",(function(e){k(e)})),r(window,"focus",(function(){f=[]})),r(d,"keyup",(function(e){k(e),function(e){var t=e.keyCode||e.which||e.charCode,n=f.indexOf(t);if(n>=0&&f.splice(n,1),e.key&&"meta"===e.key.toLowerCase()&&f.splice(0,f.length),93!==t&&224!==t||(t=91),t in c)for(var r in c[t]=!1,l)l[r]===t&&(x[r]=!1)}(e)})))}var b={setScope:y,getScope:h,deleteScope:function(e,t){var n,r;for(var a in e||(e=h()),s)if(Object.prototype.hasOwnProperty.call(s,a))for(n=s[a],r=0;r<n.length;)n[r].scope===e?n.splice(r,1):r++;h()===e&&y(t||"all")},getPressedKeyCodes:function(){return f.slice(0)},isPressed:function(e){return"string"==typeof e&&(e=v(e)),-1!==f.indexOf(e)},filter:function(e){var t=e.target||e.srcElement,n=t.tagName,r=!0;return!t.isContentEditable&&("INPUT"!==n&&"TEXTAREA"!==n&&"SELECT"!==n||t.readOnly)||(r=!1),r},unbind:function(e){if(e){if(Array.isArray(e))e.forEach((function(e){e.key&&g(e)}));else if("object"==typeof e)e.key&&g(e);else if("string"==typeof e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n[0],o=n[1];"function"==typeof a&&(o=a,a=""),g({key:e,scope:a,method:o,splitKey:"+"})}}else Object.keys(s).forEach((function(e){return delete s[e]}))}};for(var E in b)Object.prototype.hasOwnProperty.call(b,E)&&(x[E]=b[E]);if("undefined"!=typeof window){var O=window.hotkeys;x.noConflict=function(e){return e&&window.hotkeys===x&&(window.hotkeys=O),x},window.hotkeys=x}t.Z=x},8502:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var r=n(7294),a=n(4275),o=n(2137),i=n(7757),l=n.n(i),u=n(8061),c=n(7956),s=n(581),p=n(2203),f=0,d=70,m=function(e){var t=document.getElementById("chart").getBoundingClientRect().width,n=400,r=(0,u.Ys)("form"),a={populationRange:[0,100],prop:"total",valueIdx:0},o=e[0].values.total.length-1;$(".time-slider").slider({change:function(e,t){a.valueIdx=t.value,y()},max:o,min:0,value:a.valueIdx}),$(".population-slider").slider({change:function(e,t){a.populationRange=t.values.map((function(e){return e/100})),y()},range:!0,values:[a.populationRange[0],a.populationRange[1]]}),r.on("change",(function(e){a.prop=e.target.value,y()}));var i=(0,u.PKp)(e.map((function(e,t){return t})),u.Cn1),l=(0,u.Ys)("#chart").append("svg").attr("viewBox",[0,0,t,n+d]).attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),m=l.append("text").text("").attr("transform","translate("+t/2+", 50)").style("font-size","20px").style("text-anchor","right"),v=l.append("g").attr("transform","translate("+f+", "+d+")"),y=function(){var r=e.filter((function(e){return!!e.values[a.prop][a.valueIdx]})),o=r.map((function(e){var t=e.values[a.prop][a.valueIdx];return t?t.count:null})),l=o.reduce((function(e,t,n){return null===t||(e[t]=e[t]||[],e[t].push(n)),e}),{}),f=o.sort((function(e,t){return e-t})),d=f.reduce((function(e,t,n){var r=n/f.length;return l[t].forEach((function(t){e[t]=r})),e}),[]),y=r.filter((function(e,t){var n=d[t];return"number"==typeof n&&n>=a.populationRange[0]&&n<=a.populationRange[1]})),h=(0,u.bT9)({children:y}).sum((function(e){if(!e.values)return 1;var t=e.values[a.prop][a.valueIdx];return t?t.count:0})),g=(0,u.P2p)().size("total"===a.prop?[t,n]:[t/2,200]).padding(3)(h).leaves(),w=function(e){return new Date(e).getFullYear()},k=g[0].data.values[a.prop][a.valueIdx].date,x=w(k),b=g.filter((function(e){return e.data.values[a.prop].length>=a.valueIdx+1})).length;m.text("Population in Malaga: "+x+" - "+b+" towns");var E=v.selectAll(".leaf").data(g);E.exit().remove();var O=function(e){var t=e.data.values[a.prop][a.valueIdx];return t?e.data.name+" - "+t.count+" population - "+w(t.date):""};E.transition().duration(1e3).ease(u.sq$).attr("transform",(function(e){return"total"!==a.prop?"translate("+(e.x+t/4)+","+(e.y+100)+")":"translate("+(e.x+1)+","+(e.y+1)+")"})).attr("title",O);var K=E.enter().append("g").attr("class","leaf").attr("title",O).attr("transform",(function(e){return"translate("+(e.x+1)+","+(e.y+1)+")"})).on("mouseenter",(function(e,t){var n=(0,u.Ys)(this).select(".circle"),r=(0,c.Z)({complete:function(){t.anim=null},strokeWidth:"5px",targets:[n.node()]});t.anim=r})).on("mouseleave",(function(e,t){var n=(0,u.Ys)(this).select(".circle");t.anim&&(t.anim.seek(0),t.anim.remove(n.node()),t.anim=null),(0,c.Z)({strokeWidth:"0px",targets:[n.node()]})})).on("click",(function(e,t){s.Z.isPressed("control")&&window.open("https://www.google.com/search?"+p.stringify({q:"Malaga "+t.data.name}))}));K.append("circle").attr("r",(function(e){return e.r})).attr("class","circle").attr("fill-opacity",.7).attr("fill",(function(e,t){return i(t)})).attr("stroke-width","0px").attr("stroke","green");var C=function(e){e.text((function(e){return e.data.name[0]})).style("font-size",(function(e){return e.r.toFixed(0)+"px"})).attr("dy",(function(e){return e.r/3}))};C(K.append("text").attr("class","letter"));var j=E.selectAll(".circle").data((function(e){return e})),_=E.selectAll(".letter").data((function(e){return e}));j.transition().duration(1e3).ease(u.vaZ).attr("r",(function(e){return e.r})),C(_.transition().duration(1e3).ease(u.vaZ)),$(".leaf").tooltip({track:!0})};y()},v=function(){var e=(0,o.Z)(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,s.Z)("control",(function(){})),e.next=3,(0,u.AVB)("/demos/data/d3js/population-circles/data.json");case 3:t=e.sent,(n=t.map((function(e){return{name:e.Nombre,values:e.Data.map((function(e){return{count:e.Valor,date:e.Fecha}}))}})).reduce((function(e,t){var n=t.name.split(".").map((function(e){return e.trim()})),r=n[0],a=n[1];"Total"===a?e.push({name:r,values:{total:t.values}}):e[e.length-1].values["Hombres"===a?"males":"females"]=t.values;return e}),[])).shift(),m(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y="population-circles-module--slider--3hzyU",h=function(e){var t=e.pageContext;return r.createElement(a.Z,{links:["/vendors/jquery-ui/themes/base/jquery-ui.min.css"],main:v,pageContext:t,scripts:["/vendors/jquery-ui/jquery-ui.min.js"]},r.createElement("form",null,[{id:"total",label:"Total"},{id:"males",label:"Males"},{id:"females",label:"Females"}].map((function(e,t){var n=e.id,a=e.label;return r.createElement("div",{className:"population-circles-module--radio--1S8Dr",key:n},r.createElement("input",{defaultChecked:0===t,id:n,name:"type",type:"radio",value:n}),r.createElement("label",{htmlFor:n},a))}))),r.createElement("div",{className:y},r.createElement("p",null,"Time"),r.createElement("div",{className:"time-slider"})),r.createElement("div",{className:y},r.createElement("p",null,"Population Percentile"),r.createElement("div",{className:"population-slider"})),r.createElement("div",{id:"chart"}))}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-population-circles-tsx-0762f052bab033ead834.js.map