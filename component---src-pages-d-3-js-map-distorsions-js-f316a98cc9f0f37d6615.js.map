{"version":3,"sources":["webpack://demos/./src/demos/_utils/d3utils.js","webpack://demos/./src/demos/map-distorsions/map-distorsions.js","webpack://demos/./src/pages/d3js/map-distorsions.js"],"names":["d3utils","colorsScale","colors","extent","c","d3","scale","linear","domain","range","colorScale","length","p","filterBlackOpacity","id","svg","deviation","slope","filter","append","attr","height","width","x","y","in","stdDeviation","dx","dy","type","feMerge","filterColor","extra","result","in2","mode","middleTitle","text","top","class","transform","String","style","selector","margin","select","bottom","left","right","tooltip","customOpts","opts","_","merge","elementSelector","followElement","followMouse","leftOffst","tOpts","container","viewport","topOffst","$","hover","e","css","pageX","pageY","position","innerWidth","dimensions","name","ordinal","rangePoints","Number","sqrt","map","d","line","defined","isNaN","yAxis","axis","orient","dimension","selectAll","data","enter","tsv","ROOT_PATH","sortBy","colorFn","forEach","dimItem","sort","draw","tooltipText","vals","item","toFixed","join","each","this","call","fill","_d","i","moveToFront","parentNode","appendChild","stroke","projection","on","classed","demoInfo","pageContext","main","scripts","className"],"mappings":"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","file":"component---src-pages-d-3-js-map-distorsions-js-f316a98cc9f0f37d6615.js","sourcesContent":["const d3utils = {\n  colorsScale(colors, extent) {\n    const c = d3.scale.linear().domain(extent).range([0, 1])\n    const colorScale = d3.scale\n      .linear()\n      .domain(d3.range(0, 1, 1.0 / colors.length))\n      .range(colors)\n\n    return function (p) {\n      return colorScale(c(p))\n    }\n  },\n  filterBlackOpacity(id, svg, deviation, slope) {\n    const defs = svg.append(\"defs\")\n    const filter = defs.append(\"filter\").attr({\n      height: \"500%\",\n      id: `drop-shadow-${id}`,\n      width: \"500%\",\n      x: \"-200%\",\n      y: \"-200%\",\n    })\n\n    filter.append(\"feGaussianBlur\").attr({\n      in: \"SourceAlpha\",\n      stdDeviation: deviation,\n    })\n    filter.append(\"feOffset\").attr({\n      dx: 1,\n      dy: 1,\n    })\n    filter.append(\"feComponentTransfer\").append(\"feFuncA\").attr({\n      slope,\n      type: \"linear\",\n    })\n\n    const feMerge = filter.append(\"feMerge\")\n\n    feMerge.append(\"feMergeNode\")\n\n    return feMerge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\")\n  },\n  filterColor(id, svg, deviation, slope, extra) {\n    if (extra == null) {\n      extra = false\n    }\n\n    const defs = svg.append(\"defs\")\n    const filter = defs.append(\"filter\").attr({\n      id: `drop-shadow-${id}`,\n    })\n\n    if (extra) {\n      filter.attr({\n        height: \"500%\",\n        width: \"500%\",\n        x: \"-200%\",\n        y: \"-200%\",\n      })\n    }\n\n    filter.append(\"feOffset\").attr({\n      dx: 0.5,\n      dy: 0.5,\n      in: \"SourceGraphic\",\n      result: \"offOut\",\n    })\n    filter.append(\"feGaussianBlur\").attr({\n      in: \"offOut\",\n      result: \"blurOut\",\n      stdDeviation: deviation,\n    })\n    filter.append(\"feBlend\").attr({\n      in: \"SourceGraphic\",\n      in2: \"blurOut\",\n      mode: \"normal\",\n    })\n\n    return filter.append(\"feComponentTransfer\").append(\"feFuncA\").attr({\n      slope,\n      type: \"linear\",\n    })\n  },\n  middleTitle(svg, width, text, top) {\n    if (top == null) {\n      top = -15\n    }\n\n    svg\n      .append(\"text\")\n      .attr({\n        class: \"chart-title\",\n        \"text-anchor\": \"middle\",\n        transform: `translate(${String(width / 2)},${top})`,\n      })\n      .text(text)\n      .style({\n        \"font-weight\": \"bold\",\n      })\n  },\n  svg(selector, width, height, margin) {\n    return d3\n      .select(selector)\n      .text(\"\")\n      .append(\"svg\")\n      .attr({\n        height: height + margin.top + margin.bottom,\n        width: width + margin.left + margin.right,\n      })\n      .append(\"g\")\n      .attr({\n        transform: `translate(${margin.left},${margin.top})`,\n      })\n  },\n  tooltip(selector, customOpts) {\n    if (customOpts == null) {\n      customOpts = {}\n    }\n\n    const defaultOpts = {\n      elementSelector: \"\",\n      followElement: false,\n      followMouse: false,\n      leftOffst: 60,\n      tOpts: {\n        container: \"body\",\n        viewport: {\n          selector: \"#chart svg\",\n        },\n      },\n      topOffst: 40,\n    }\n\n    const opts = _.merge(defaultOpts, customOpts)\n\n    $(selector).tooltip(opts.tOpts)\n\n    if (opts.followMouse) {\n      $(selector).hover((e) =>\n        $(\".tooltip\").css({\n          left: `${String(e.pageX - opts.leftOffst)}px`,\n          top: `${String(e.pageY - opts.topOffst)}px`,\n        })\n      )\n    } else if (opts.followElement) {\n      $(selector).hover(() =>\n        $(\".tooltip\").css({\n          left: `${String(\n            $(opts.elementSelector).position().left - opts.leftOffst\n          )}px`,\n          top: `${String(\n            $(opts.elementSelector).position().top - opts.topOffst\n          )}px`,\n        })\n      )\n    }\n  },\n}\n\nexport default d3utils\n","import d3utils from \"@/demos/_utils/d3utils\"\n\nconst main = () => {\n  const margin = {\n    bottom: 20,\n    left: 200,\n    right: 40,\n    top: 90,\n  }\n  const width = $(\"#chart\").innerWidth() - margin.left - margin.right\n  const height = 750 - margin.top - margin.bottom\n  const colors = [\"#7C7CC9\", \"#429742\", \"#63BD28\", \"#D14141\"]\n  const dimensions = [\n    {\n      name: \"name\",\n      scale: d3.scale.ordinal().rangePoints([0, height]),\n      type: String,\n    },\n    {\n      name: \"Acc. 40ยบ 150%\",\n      scale: d3.scale.linear().range([0, height]),\n      type: Number,\n    },\n    {\n      name: \"Scale\",\n      scale: d3.scale.linear().range([height, 0]),\n      type: Number,\n    },\n    {\n      name: \"Areal\",\n      scale: d3.scale.sqrt().range([height, 0]),\n      type: Number,\n    },\n    {\n      name: \"Angular\",\n      scale: d3.scale.linear().range([height, 0]),\n      type: Number,\n    },\n  ]\n  const svg = d3utils.svg(\"#chart\", width, height, margin)\n  const title =\n    \"Comparison of 41 map projections by four different types of distortion. Lower is better.\"\n\n  d3utils.middleTitle(svg, width, title, -60)\n\n  const x = d3.scale\n    .ordinal()\n    .domain(dimensions.map((d) => d.name))\n    .rangePoints([0, width])\n  const line = d3.svg.line().defined((d) => !isNaN(d[1]))\n  const yAxis = d3.svg.axis().orient(\"left\")\n  const dimension = svg\n    .selectAll(\".dimension\")\n    .data(dimensions)\n    .enter()\n    .append(\"g\")\n    .attr(\"class\", \"dimension\")\n    .attr(\"transform\", (d) => `translate(${x(d.name)})`)\n\n  d3.tsv(`${ROOT_PATH}data/d3js/map-distorsions/data.tsv`, (data) => {\n    d3utils.filterColor(\"lines\", svg, 2, 0.4)\n    data = _.sortBy(data, \"name\")\n\n    const colorFn = d3utils.colorsScale(colors, [0, data.length - 1])\n\n    dimensions.forEach((dimItem) =>\n      dimItem.scale.domain(\n        dimItem.type === Number\n          ? d3.extent(data, (d) => +d[dimItem.name])\n          : data.map((d) => d[dimItem.name]).sort()\n      )\n    )\n\n    const draw = function (d) {\n      return line(\n        dimensions.map((dimItem) => [\n          x(dimItem.name),\n          dimItem.scale(d[dimItem.name]),\n        ])\n      )\n    }\n\n    const tooltipText = function (d) {\n      const vals = _.map(\n        [\"Acc. 40ยบ 150%\", \"Scale\", \"Areal\", \"Angular\"],\n        (item) => String(Number(d[item]).toFixed(2))\n      )\n\n      return `${d.name}:  ${vals.join(\" - \")}`\n    }\n\n    svg\n      .append(\"g\")\n      .attr(\"class\", \"background\")\n      .selectAll(\"path\")\n      .data(data)\n      .enter()\n      .append(\"path\")\n      .attr({\n        d: draw,\n        \"data-title\": tooltipText,\n      })\n    svg\n      .append(\"g\")\n      .attr(\"class\", \"foreground\")\n      .selectAll(\"path\")\n      .data(data)\n      .enter()\n      .append(\"path\")\n      .attr({\n        d: draw,\n        \"data-title\": tooltipText,\n      })\n    dimension\n      .append(\"g\")\n      .attr(\"class\", \"axis\")\n      .each(function (d) {\n        return d3.select(this).call(yAxis.scale(d.scale))\n      })\n      .append(\"text\")\n      .attr(\"class\", \"title\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"y\", -9)\n      .text((d) => d.name)\n    svg\n      .select(\".axis\")\n      .selectAll(\"text:not(.title)\")\n      .attr(\"class\", \"label\")\n      .data(data, (d) => d.name || d)\n      .style({\n        fill(_d, i) {\n          return colorFn(i)\n        },\n      })\n\n    const moveToFront = function () {\n      return this.parentNode.appendChild(this)\n    }\n\n    const mouseover = function (d) {\n      svg.selectAll(\".foreground path\").style({\n        filter: \"none\",\n      })\n      svg.classed(\"active\", true)\n      projection.classed(\"inactive\", (p) => p !== d)\n\n      return projection.filter((p) => p === d).each(moveToFront)\n    }\n\n    const mouseout = function () {\n      svg.selectAll(\".foreground path\").style({\n        filter: \"url(#drop-shadow-lines)\",\n      })\n      svg.classed(\"active\", false)\n      projection.classed(\"inactive\", false)\n    }\n\n    svg.selectAll(\".foreground path\").style({\n      filter: \"url(#drop-shadow-lines)\",\n      stroke(_d, i) {\n        return colorFn(i)\n      },\n    })\n\n    const projection = svg\n      .selectAll(\".axis text,.background path,.foreground path\")\n      .on(\"mouseover\", mouseover)\n      .on(\"mouseout\", mouseout)\n\n    d3utils.tooltip(\".background path, .foreground path\", {\n      followMouse: true,\n      leftOffst: 100,\n      topOffst: 50,\n    })\n  })\n}\n\nexport default main\n","import React from \"react\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/map-distorsions/map-distorsions\"\n\nimport \"@/demos/map-distorsions/map-distorsions.styl\"\n\nconst MapDistorsions = ({ pageContext: { demoInfo } }) => (\n  <Demo\n    demoInfo={demoInfo}\n    main={main}\n    scripts={[\"/vendors/d3/d3.min.js\", \"/js/d3js-utils.js\"]}\n  >\n    <div className=\"map-distorsions-chart\" id=\"chart\" />\n  </Demo>\n)\n\nexport default MapDistorsions\n"],"sourceRoot":""}