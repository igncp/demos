(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[175],{2137:function(t,n,e){"use strict";function r(t,n,e,r,a,i,o){try{var s=t[i](o),u=s.value}catch(c){return void e(c)}s.done?n(u):Promise.resolve(u).then(r,a)}function a(t){return function(){var n=this,e=arguments;return new Promise((function(a,i){var o=t.apply(n,e);function s(t){r(o,a,i,s,u,"next",t)}function u(t){r(o,a,i,s,u,"throw",t)}s(void 0)}))}}e.d(n,{Z:function(){return a}})},6159:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return j}});var r=e(7294),a=e(1335),i=e(2137),o=e(7757),s=e.n(o),u=e(6231),c=e(6073),p=e.n(c),f=e(928),d=e.n(f),l=function(){var t=(0,i.Z)(s().mark((function t(){var n,e,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.pvA("/demos/data/d3js/mareys-schedule/data.tsv");case 2:return n=t.sent,e=[],r=n.map((function(t,n){if(0===n)for(var r in t)if(/^stop\|/.test(r)){var a=r.split("|");e.push({distance:+a[2],key:r,name:a[1],zone:+a[3]})}return{direction:t.direction,index:n,number:t.number,stops:e.map((function(e){return{station:e,time:h(t[e.key]),trainIndex:n}})).filter((function(t){return null!==t.time})),type:t.type}})),t.abrupt("return",{stations:e,trains:r});case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),v=function(t){return"S"===t.direction?t.stops[0].station.name+" -> "+d()(t.stops).station.name:d()(t.stops).station.name+" -> "+t.stops[0].station.name},m=function(){return u.Z1g("%I:%M%p")},h=function(t){var n=m()(t);return null!==n&&n.getHours()<3&&n.setDate(n.getDate()+1),n},x=50,g=120,y=50,w=80,k=600-w-x,M=function(t){var n=t.rootElId,e=t.data,r=e.stations,a=e.trains,i=document.getElementById(n);i.classList.add("mareys-schedule-chart");var o=i.getBoundingClientRect().width-g-y,s=function(t){var e=u.Xf().domain([h(t[0]),h(t[1])]).range([0,o]),i=u.BYU().range([0,k]),s=m(),c=u.F5q(e).ticks(8).tickFormat(s),p=u.LLu(e).ticks(8).tickFormat(s),f=u.Ys("#"+n).text("").append("svg").attr("height",k+w+x).attr("width",o+g+y).append("g").attr("transform","translate("+g+","+w+")");f.append("text").attr("class","chart-title").attr("text-anchor","middle").attr("transform","translate("+o/2+",-40)").text("E.J. Mareyâ€™s graphical train schedule  (4:30AM - 1:30AM)").style("font-weight","bold"),b("trains",f,2,.2),f.append("defs").append("clipPath").attr("id","clip").append("rect").attr("y",-w).attr("width",o).attr("height",k+w+x),i.domain(u.Wem(r,(function(t){return t.distance})));var d=f.append("g").attr("class","station").selectAll("g").data(r).enter().append("g").attr("transform",(function(t){return"translate(0,"+i(t.distance)+")"}));d.append("text").attr("x",-6).attr("dy",".35em").text((function(t){return t.name})),d.append("line").attr("x2",o),f.append("g").attr("class","x top axis").call(c),f.append("g").attr("class","x bottom axis").attr("transform","translate(0,"+k+")").call(p);var l=f.append("g").attr("class","train").attr("clip-path","url(#clip)").selectAll("g").data(a.filter((function(t){return/[NLB]/.test(t.type)}))).enter().append("g").attr("class",(function(t){return t.type+" train-"+t.index})).on("mouseover",(function(t,n){u.Ys(".train-"+n.index).select("path").style("stroke-width","5px")})).on("mouseleave",(function(t,n){u.Ys(".train-"+n.index).select("path").style("stroke-width","2.5px")})),M=u.jvg().x((function(t){return e(t.time)})).y((function(t){return i(t.station.distance)}));l.append("path").attr("d",(function(t){return M(t.stops)})).append("title").text((function(t){return v(t)})),l.selectAll("circle").data((function(t){return t.stops})).enter().append("circle").attr("transform",(function(t){return"translate("+e(t.time)+","+i(t.station.distance)+")"})).style("filter","url(#drop-shadow-trains)").attr("r","5px").append("title").text((function(t){return v(a[t.trainIndex])+"\n"+t.station.name+" at "+function(t){var n=t.getHours(),e=n>=12?"PM":"AM";n=(n%=12)||12;var r=t.getMinutes();return n+":"+(r<10?"0"+r:r.toString())+" "+e}(t.time)}))};return{refresh:function(t){!function(t){var n=t.limits,e=t.redraw,r=[];p()(n,(function(t){var n=t/100*1200,e="AM",a=Math.floor(n/60),i=Math.floor(n%60);i>30?(i-=30,a+=1):i+=30,(a+=4)>23?a-=24===a?12:24:a>11&&(e="PM",12!==a&&(a-=12));var o=i<10?"0"+String(i):i.toString(),s=String(a)+":"+o+e;return r.push(s)})),e(r)}({limits:t,redraw:s})}}},b=function(t,n,e,r){var a=n.append("defs").append("filter").attr("height","500%").attr("id","drop-shadow-"+t).attr("width","500%").attr("x","-200%").attr("y","-200%");a.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",e),a.append("feOffset").attr("dx",1).attr("dy",1),a.append("feComponentTransfer").append("feFuncA").attr("slope",r).attr("type","linear");var i=a.append("feMerge");i.append("feMergeNode"),i.append("feMergeNode").attr("in","SourceGraphic")},A=function(){var t=(0,i.Z)(s().mark((function t(){var n,e,r,a,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="chart",t.next=3,l();case 3:e=t.sent,r=M({data:e,rootElId:n}),a=r.refresh,(i=$(".slider")).slider({change:function(){var t=i.slider("values");a(t)},range:!0}),i.slider("values",[10,50]);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),j=function(t){var n=t.pageContext.demoInfo;return r.createElement(a.Z,{demoInfo:n,links:["/vendors/jquery-ui/themes/base/jquery-ui.min.css"],main:A,scripts:["/vendors/jquery-ui/jquery-ui.min.js"]},r.createElement("div",null,r.createElement("div",{className:"slider"})),r.createElement("div",{id:"chart"}))}},7412:function(t){t.exports=function(t,n){for(var e=-1,r=null==t?0:t.length;++e<r&&!1!==n(t[e],e,t););return t}},9881:function(t,n,e){var r=e(7816),a=e(9291)(r);t.exports=a},8483:function(t,n,e){var r=e(5063)();t.exports=r},7816:function(t,n,e){var r=e(8483),a=e(3674);t.exports=function(t,n){return t&&r(t,n,a)}},4290:function(t,n,e){var r=e(6557);t.exports=function(t){return"function"==typeof t?t:r}},9291:function(t,n,e){var r=e(8612);t.exports=function(t,n){return function(e,a){if(null==e)return e;if(!r(e))return t(e,a);for(var i=e.length,o=n?i:-1,s=Object(e);(n?o--:++o<i)&&!1!==a(s[o],o,s););return e}}},5063:function(t){t.exports=function(t){return function(n,e,r){for(var a=-1,i=Object(n),o=r(n),s=o.length;s--;){var u=o[t?s:++a];if(!1===e(i[u],u,i))break}return n}}},6073:function(t,n,e){t.exports=e(4486)},4486:function(t,n,e){var r=e(7412),a=e(9881),i=e(4290),o=e(1469);t.exports=function(t,n){return(o(t)?r:a)(t,i(n))}},6557:function(t){t.exports=function(t){return t}},928:function(t){t.exports=function(t){var n=null==t?0:t.length;return n?t[n-1]:void 0}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-mareys-schedule-tsx-d4b5602e0c1d16fa8857.js.map