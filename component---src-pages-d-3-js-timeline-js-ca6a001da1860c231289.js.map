{"version":3,"sources":["webpack://demos/./src/demos/_utils/d3utils.js","webpack://demos/./src/demos/timeline/timeline.js","webpack://demos/./src/pages/d3js/timeline.js"],"names":["d3utils","colorsScale","colors","extent","c","d3","scale","linear","domain","range","colorScale","length","p","filterBlackOpacity","id","svg","deviation","slope","filter","append","attr","height","width","x","y","in","stdDeviation","dx","dy","type","feMerge","filterColor","extra","result","in2","mode","middleTitle","text","top","class","transform","String","style","selector","margin","select","bottom","left","right","tooltip","customOpts","opts","_","merge","elementSelector","followElement","followMouse","leftOffst","tOpts","container","viewport","topOffst","$","hover","e","css","pageX","pageY","position","csv","dataset","outerWidth","innerWidth","bandY","bandNum","timeline","data","components","bands","on","selectAll","chart","parseDate","dateString","date","time","format","parse","year","isNaN","replace","Date","setUTCFullYear","slice","toYear","bcString","getUTCFullYear","toString","timelineItems","today","tracks","items","timeOrder","compareAscending","item1","item2","start","end","compareDescending","forEach","item","getTime","instant","sort","track","i","_i","_ref","nTracks","minDate","min","d","maxDate","max","create","band","bandName","sizeFactor","w","h","trackOffset","trackHeight","Math","itemHeight","parts","instantWidth","xScale","yScale","yearsScale","g","enter","label","intervals","instants","addActions","actions","action","redraw","maxLetters","substr","part","push","labels","labelTop","labelDefs","_min","bandLabels","xAxis","orientation","axis","orient","tickSize","tickFormat","call","brush","targetNames","empty","component","createTimeline","demoInfo","pageContext","main","scripts","className"],"mappings":"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","file":"component---src-pages-d-3-js-timeline-js-ca6a001da1860c231289.js","sourcesContent":["const d3utils = {\n  colorsScale(colors, extent) {\n    const c = d3.scale.linear().domain(extent).range([0, 1])\n    const colorScale = d3.scale\n      .linear()\n      .domain(d3.range(0, 1, 1.0 / colors.length))\n      .range(colors)\n\n    return function (p) {\n      return colorScale(c(p))\n    }\n  },\n  filterBlackOpacity(id, svg, deviation, slope) {\n    const defs = svg.append(\"defs\")\n    const filter = defs.append(\"filter\").attr({\n      height: \"500%\",\n      id: `drop-shadow-${id}`,\n      width: \"500%\",\n      x: \"-200%\",\n      y: \"-200%\",\n    })\n\n    filter.append(\"feGaussianBlur\").attr({\n      in: \"SourceAlpha\",\n      stdDeviation: deviation,\n    })\n    filter.append(\"feOffset\").attr({\n      dx: 1,\n      dy: 1,\n    })\n    filter.append(\"feComponentTransfer\").append(\"feFuncA\").attr({\n      slope,\n      type: \"linear\",\n    })\n\n    const feMerge = filter.append(\"feMerge\")\n\n    feMerge.append(\"feMergeNode\")\n\n    return feMerge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\")\n  },\n  filterColor(id, svg, deviation, slope, extra) {\n    if (extra == null) {\n      extra = false\n    }\n\n    const defs = svg.append(\"defs\")\n    const filter = defs.append(\"filter\").attr({\n      id: `drop-shadow-${id}`,\n    })\n\n    if (extra) {\n      filter.attr({\n        height: \"500%\",\n        width: \"500%\",\n        x: \"-200%\",\n        y: \"-200%\",\n      })\n    }\n\n    filter.append(\"feOffset\").attr({\n      dx: 0.5,\n      dy: 0.5,\n      in: \"SourceGraphic\",\n      result: \"offOut\",\n    })\n    filter.append(\"feGaussianBlur\").attr({\n      in: \"offOut\",\n      result: \"blurOut\",\n      stdDeviation: deviation,\n    })\n    filter.append(\"feBlend\").attr({\n      in: \"SourceGraphic\",\n      in2: \"blurOut\",\n      mode: \"normal\",\n    })\n\n    return filter.append(\"feComponentTransfer\").append(\"feFuncA\").attr({\n      slope,\n      type: \"linear\",\n    })\n  },\n  middleTitle(svg, width, text, top) {\n    if (top == null) {\n      top = -15\n    }\n\n    svg\n      .append(\"text\")\n      .attr({\n        class: \"chart-title\",\n        \"text-anchor\": \"middle\",\n        transform: `translate(${String(width / 2)},${top})`,\n      })\n      .text(text)\n      .style({\n        \"font-weight\": \"bold\",\n      })\n  },\n  svg(selector, width, height, margin) {\n    return d3\n      .select(selector)\n      .text(\"\")\n      .append(\"svg\")\n      .attr({\n        height: height + margin.top + margin.bottom,\n        width: width + margin.left + margin.right,\n      })\n      .append(\"g\")\n      .attr({\n        transform: `translate(${margin.left},${margin.top})`,\n      })\n  },\n  tooltip(selector, customOpts) {\n    if (customOpts == null) {\n      customOpts = {}\n    }\n\n    const defaultOpts = {\n      elementSelector: \"\",\n      followElement: false,\n      followMouse: false,\n      leftOffst: 60,\n      tOpts: {\n        container: \"body\",\n        viewport: {\n          selector: \"#chart svg\",\n        },\n      },\n      topOffst: 40,\n    }\n\n    const opts = _.merge(defaultOpts, customOpts)\n\n    $(selector).tooltip(opts.tOpts)\n\n    if (opts.followMouse) {\n      $(selector).hover((e) =>\n        $(\".tooltip\").css({\n          left: `${String(e.pageX - opts.leftOffst)}px`,\n          top: `${String(e.pageY - opts.topOffst)}px`,\n        })\n      )\n    } else if (opts.followElement) {\n      $(selector).hover(() =>\n        $(\".tooltip\").css({\n          left: `${String(\n            $(opts.elementSelector).position().left - opts.leftOffst\n          )}px`,\n          top: `${String(\n            $(opts.elementSelector).position().top - opts.topOffst\n          )}px`,\n        })\n      )\n    }\n  },\n}\n\nexport default d3utils\n","import d3utils from \"@/demos/_utils/d3utils\"\n\nconst main = () => {\n  const createTimeline = function () {\n    const margin = {\n      bottom: 0,\n      left: 20,\n      right: 20,\n      top: 60,\n    }\n\n    const outerWidth = $(\"#chart\").innerWidth()\n    const outerHeight = 700\n    const width = outerWidth - margin.left - margin.right\n    const height = outerHeight - margin.top - margin.bottom\n    const bandGap = 25\n\n    let bandY = 0\n    let bandNum = 0\n\n    const timeline = {}\n    const data = {}\n    const components = []\n\n    const bands = {}\n    const svg = d3utils.svg(\"#chart\", outerWidth, outerHeight, margin)\n\n    d3utils.middleTitle(svg, outerWidth, \"Philosophers through History\", -20)\n    d3utils.filterBlackOpacity(\"intervals\", svg, 1, 0.2)\n\n    svg\n      .append(\"clipPath\")\n      .attr(\"id\", \"chart-area\")\n      .append(\"rect\")\n      .attr(\"width\", width)\n      .attr(\"height\", height)\n\n    svg.on(\"mouseup\", () =>\n      d3.selectAll(\".interval rect\").style({\n        filter: \"url(#drop-shadow-intervals)\",\n      })\n    )\n\n    const chart = svg\n      .append(\"g\")\n      .attr(\"class\", \"chart\")\n      .attr(\"clip-path\", \"url(#chart-area)\")\n\n    const parseDate = function (dateString) {\n      const format = d3.time.format(\"%Y-%m-%d\")\n\n      let date = format.parse(dateString)\n\n      if (date !== null) {\n        return date\n      }\n\n      let year = null\n\n      if (isNaN(dateString)) {\n        year = -dateString.replace(/[^0-9]/g, \"\")\n      } else {\n        year = +dateString\n      }\n\n      if (year < 0 || year > 99) {\n        date = new Date(year, 6, 1)\n      } else if (year === 0) {\n        date = new Date(-1, 6, 1)\n      } else {\n        date = new Date(year, 6, 1)\n        date.setUTCFullYear(`0000${year}`.slice(-4))\n      }\n\n      return date\n    }\n\n    const toYear = function (date, bcString) {\n      bcString = bcString || \" BC\"\n\n      const year = date.getUTCFullYear()\n\n      if (year > 0) {\n        return year.toString()\n      }\n\n      if (bcString[0] === \"-\") {\n        return bcString + -year\n      }\n\n      return -year + bcString\n    }\n\n    timeline.data = function (timelineItems) {\n      const today = new Date()\n\n      const tracks = []\n      const yearMillis = 31622400000\n      const instantOffset = 100 * yearMillis\n\n      data.items = timelineItems\n\n      const compareAscending = function (item1, item2) {\n        let result = item1.start - item2.start\n\n        if (result < 0) {\n          return -1\n        }\n\n        if (result > 0) {\n          return 1\n        }\n\n        result = item2.end - item1.end\n\n        if (result < 0) {\n          return -1\n        }\n\n        if (result > 0) {\n          return 1\n        }\n\n        return 0\n      }\n\n      const compareDescending = function (item1, item2) {\n        let result = item1.start - item2.start\n\n        if (result < 0) {\n          return 1\n        }\n\n        if (result > 0) {\n          return -1\n        }\n\n        result = item2.end - item1.end\n\n        if (result < 0) {\n          return 1\n        }\n\n        if (result > 0) {\n          return -1\n        }\n\n        return 0\n      }\n\n      const calculateTracks = function (items, sortOrder, timeOrder) {\n        sortOrder = sortOrder || \"descending\"\n        timeOrder = timeOrder || \"backward\"\n\n        const sortBackward = function () {\n          return items.forEach((item) => {\n            let track = 0\n\n            for (\n              let i = 0, _i = 0, _ref = tracks.length;\n              0 <= _ref ? _i < _ref : _i > _ref;\n              i = 0 <= _ref ? ++_i : --_i\n            ) {\n              if (item.end < tracks[i]) {\n                break\n              }\n\n              track++\n            }\n\n            item.track = track\n\n            tracks[track] = item.start\n          })\n        }\n\n        const sortForward = function () {\n          return items.forEach((item) => {\n            let track = 0\n\n            for (\n              let i = 0, _i = 0, _ref = tracks.length;\n              0 <= _ref ? _i < _ref : _i > _ref;\n              i = 0 <= _ref ? ++_i : --_i\n            ) {\n              if (item.start > tracks[i]) {\n                break\n              }\n\n              track++\n            }\n\n            item.track = track\n\n            tracks[track] = item.end\n          })\n        }\n\n        if (sortOrder === \"ascending\") {\n          data.items.sort(compareAscending)\n        } else {\n          data.items.sort(compareDescending)\n        }\n\n        if (timeOrder === \"forward\") {\n          return sortForward()\n        }\n\n        return sortBackward()\n      }\n\n      data.items.forEach((item) => {\n        item.start = parseDate(item.start)\n\n        if (item.end === \"\") {\n          item.end = new Date(item.start.getTime() + instantOffset)\n          item.instant = true\n        } else {\n          item.end = parseDate(item.end)\n          item.instant = false\n        }\n\n        if (item.end > today) {\n          item.end = today\n        }\n      })\n      calculateTracks(data.items, \"descending\", \"backward\")\n      data.nTracks = tracks.length\n      data.minDate = d3.min(data.items, (d) => d.start)\n      data.maxDate = d3.max(data.items, (d) => d.end)\n\n      return timeline\n    }\n\n    timeline.tooltip = {\n      create() {\n        d3utils.tooltip(\".part.instant, .part.interval\", {\n          followMouse: true,\n          leftOffst: 80,\n        })\n\n        return timeline\n      },\n    }\n\n    timeline.band = function (bandName, sizeFactor) {\n      const band = {}\n\n      band.id = `band${bandNum}`\n      band.x = 0\n      band.y = bandY\n      band.w = width\n      band.h = height * (sizeFactor || 1)\n      band.trackOffset = 0\n      band.trackHeight = Math.min(\n        (band.h - band.trackOffset) / data.nTracks,\n        20\n      )\n      band.itemHeight = band.trackHeight * 0.7\n      band.parts = []\n      band.instantWidth = 100\n      band.xScale = d3.time\n        .scale()\n        .domain([data.minDate, data.maxDate])\n        .range([0, band.w])\n\n      band.yScale = function (track) {\n        return band.trackOffset + track * band.trackHeight\n      }\n\n      band.yearsScale =\n        data.maxDate.getUTCFullYear() - data.minDate.getUTCFullYear()\n      band.g = chart\n        .append(\"g\")\n        .attr(\"id\", band.id)\n        .attr(\"transform\", `translate(0,${band.y})`)\n      band.g\n        .append(\"rect\")\n        .attr(\"class\", \"band\")\n        .attr(\"width\", band.w)\n        .attr(\"height\", band.h)\n\n      const items = band.g\n        .selectAll(\"g\")\n        .data(data.items)\n        .enter()\n        .append(\"svg\")\n        .attr(\"y\", (d) => band.yScale(d.track))\n        .attr(\"height\", band.itemHeight)\n        .attr(\"data-title\", (d) => {\n          if (d.instant) {\n            return `${d.label}: ${toYear(d.start)}`\n          }\n\n          return `${d.label}: ${toYear(d.start)} - ${toYear(d.end)}`\n        })\n        .attr(\"class\", (d) => {\n          if (d.instant) {\n            return \"part instant\"\n          }\n\n          return \"part interval\"\n        })\n\n      const intervals = d3.select(`#band${bandNum}`).selectAll(\".interval\")\n\n      intervals\n        .append(\"rect\")\n        .attr({\n          height: \"80%\",\n          width: \"80%\",\n          x: \"1px\",\n          y: \".5px\",\n        })\n        .style({\n          filter: \"url(#drop-shadow-intervals)\",\n        })\n      intervals\n        .append(\"text\")\n        .attr(\"class\", \"intervalLabel\")\n        .attr(\"x\", 3)\n        .attr(\"y\", 9.5)\n\n      const instants = d3.select(`#band${bandNum}`).selectAll(\".instant\")\n\n      instants\n        .append(\"circle\")\n        .attr(\"cx\", band.itemHeight / 2)\n        .attr(\"cy\", band.itemHeight / 2)\n        .attr(\"r\", 5)\n      instants\n        .append(\"text\")\n        .attr(\"class\", \"instantLabel\")\n        .attr(\"x\", 15)\n        .attr(\"y\", 10)\n\n      band.addActions = function (actions) {\n        return actions.forEach((action) => items.on(action[0], action[1]))\n      }\n\n      band.redraw = function () {\n        items\n          .attr(\"x\", (d) => band.xScale(d.start))\n          .attr(\"width\", (d) => band.xScale(d.end) - band.xScale(d.start))\n          .select(\"text\")\n          .text((d) => {\n            const scale = band.xScale(d.end) - band.xScale(d.start)\n            const maxLetters = scale / 9\n\n            if (d.label.length > maxLetters) {\n              return `${d.label.substr(0, maxLetters - 1)}..`\n            }\n\n            return d.label\n          })\n\n        return band.parts.forEach((part) => part.redraw())\n      }\n\n      bands[bandName] = band\n      components.push(band)\n      bandY += band.h + bandGap\n      bandNum += 1\n\n      return timeline\n    }\n\n    timeline.labels = function (bandName) {\n      const band = bands[bandName]\n      const labelWidth = 46\n      const labelHeight = 20\n      const labelTop = band.y + band.h - 10\n      const yText = 15\n      const labelDefs = [\n        [\n          \"start\",\n          \"bandMinMaxLabel\",\n          0,\n          4,\n          function (min) {\n            return toYear(min)\n          },\n          \"Start of the selected interval\",\n          band.x + 30,\n          labelTop,\n        ],\n        [\n          \"end\",\n          \"bandMinMaxLabel\",\n          band.w - labelWidth,\n          band.w - 4,\n          function (_min, max) {\n            return toYear(max)\n          },\n          \"End of the selected interval\",\n          band.x + band.w - 152,\n          labelTop,\n        ],\n        [\n          \"middle\",\n          \"bandMidLabel\",\n          (band.w - labelWidth) / 2,\n          band.w / 2,\n          function (min, max) {\n            return max.getUTCFullYear() - min.getUTCFullYear()\n          },\n          \"Length of the selected interval\",\n          band.x + band.w / 2 - 75,\n          labelTop,\n        ],\n      ]\n      const bandLabels = chart\n        .append(\"g\")\n        .attr(\"id\", `${bandName}Labels`)\n        .attr(\"transform\", `translate(0,${band.y + band.h + 1})`)\n        .selectAll(`#${bandName}Labels`)\n        .data(labelDefs)\n        .enter()\n        .append(\"g\")\n\n      bandLabels\n        .append(\"rect\")\n        .attr(\"class\", \"bandLabel\")\n        .attr(\"x\", (d) => d[2])\n        .attr(\"width\", labelWidth)\n        .attr(\"height\", labelHeight)\n        .style(\"opacity\", 1)\n\n      const labels = bandLabels\n        .append(\"text\")\n        .attr(\"class\", (d) => d[1])\n        .attr(\"id\", (d) => d[0])\n        .attr(\"x\", (d) => d[3])\n        .attr(\"y\", yText)\n        .attr(\"text-anchor\", (d) => d[0])\n\n      labels.redraw = function () {\n        const min = band.xScale.domain()[0]\n        const max = band.xScale.domain()[1]\n\n        return labels.text((d) => d[4](min, max))\n      }\n\n      band.parts.push(labels)\n      components.push(labels)\n\n      return timeline\n    }\n\n    timeline.xAxis = function (bandName, orientation) {\n      const band = bands[bandName]\n      const axis = d3.svg\n        .axis()\n        .scale(band.xScale)\n        .orient(orientation || \"bottom\")\n        .tickSize(6, 0)\n        .tickFormat((d) => toYear(d))\n      const xAxis = chart\n        .append(\"g\")\n        .attr(\"class\", \"axis\")\n        .attr(\"transform\", `translate(0,${band.y + band.h})`)\n\n      xAxis.redraw = function () {\n        return xAxis.call(axis)\n      }\n\n      band.parts.push(xAxis)\n      components.push(xAxis)\n\n      return timeline\n    }\n\n    timeline.brush = function (bandName, targetNames) {\n      const band = bands[bandName]\n      const brush = d3.svg.brush().x(band.xScale.range([0, band.w]))\n\n      brush.on(\"brush\", () => {\n        const domain = brush.empty() ? band.xScale.domain() : brush.extent()\n\n        d3.selectAll(\".interval rect\").style({\n          filter: \"none\",\n        })\n\n        targetNames.forEach((d) => {\n          bands[d].xScale.domain(domain)\n\n          bands[d].redraw()\n        })\n      })\n\n      const xBrush = band.g.append(\"svg\").attr(\"class\", \"x brush\").call(brush)\n\n      xBrush\n        .selectAll(\"rect\")\n        .attr(\"y\", 1)\n        .attr(\"height\", band.h - 1)\n\n      return timeline\n    }\n\n    timeline.redraw = function () {\n      return components.forEach((component) => component.redraw())\n    }\n\n    return timeline\n  }\n\n  d3.csv(\"/data/d3js/timeline/data.csv\", (dataset) =>\n    createTimeline()\n      .data(dataset)\n      .band(\"mainBand\", 0.82)\n      .band(\"naviBand\", 0.08)\n      .xAxis(\"mainBand\")\n      .xAxis(\"naviBand\")\n      .labels(\"mainBand\")\n      .labels(\"naviBand\")\n      .brush(\"naviBand\", [\"mainBand\"])\n      .tooltip[\"create\"]()\n      .redraw()\n  )\n}\n\nexport default main\n","import React from \"react\"\n\nimport Demo from \"@/components/demo\"\n\nimport main from \"@/demos/timeline/timeline\"\n\nimport \"@/demos/timeline/timeline.styl\"\n\nconst Timeline = ({ pageContext: { demoInfo } }) => (\n  <Demo\n    demoInfo={demoInfo}\n    main={main}\n    scripts={[\"/vendors/d3/d3.min.js\", \"/js/d3js-utils.js\"]}\n  >\n    <div className=\"timeline-chart\" id=\"chart\" />\n  </Demo>\n)\n\nexport default Timeline\n"],"sourceRoot":""}