(self.webpackChunkdemos=self.webpackChunkdemos||[]).push([[305],{7919:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return N}});var n=r(7294),a=r(1335),o=r(2137),i=r(7757),c=r.n(i),s=r(3241),u=r(2149),p="%Y-%m",l="US Unemployment Rate",d=function(t){return t.cityName.trim()+": "},f=function(t){var e=v[t.date.getMonth()]+" of "+t.date.getFullYear();return" "+(100*t.value).toFixed(2)+"% - "+e},m=function(){var t=(0,o.Z)(c().mark((function t(){var e,r,n,a,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(0,s.i$Z)(p),r=(0,s.Z1g)(p),t.next=4,(0,s.pvA)("/demos/data/d3js/multiline-voronoi/data.tsv");case 4:return n=t.sent,a=Object.keys(n[0]).map((function(t){return r(t)})).filter(Number),o=n.map((function(t){var r=t.name.replace(/(msa|necta div|met necta|met div)$/i,"").trim();return{metrics:a.map((function(n){var a=e(n),o=t[a],i=Number(o)/100;return{cityName:r,date:n,value:i}})),name:r}})),t.abrupt("return",{cities:o,months:a});case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),v=["January","February","March","April","May","June","July","August","September","October","November","December"],h=70,g=80,y=70,x=60,k=function(t){var e=t.rootElId,r=t.cities,n=t.months,a=(0,s.PKp)(s.i4X),o={clickToggle:!1,voronoiGroup:null},i=document.getElementById(e);i.classList.add("multiline-voronoi-chart");var c=i.getBoundingClientRect().width-g-y,p=500-x-h,m=(0,s.Xf)().range([0,c]),v=(0,s.BYU)().range([p,0]),k=function(t){return m(t.date)},b=function(t){return v(t.value)},N={},E=(0,s.Ys)("#"+e).append("svg").attr("width",c+g+y).attr("height",p+x+h).append("g").attr("transform","translate("+g+","+x+")");m.domain((0,s.Wem)(n)),v.domain([0,(0,s.Fp7)(r,(function(t){return(0,s.Fp7)(t.metrics,(function(t){return t.value}))}))]).nice(),E.append("g").attr("class","axis axis--x").attr("transform","translate(0,"+p+")").call((0,s.LLu)(m)),E.append("g").attr("class","axis axis--y").call((0,s.y4O)(v).ticks(10,"%")).append("text").attr("x",20).attr("dy",".32em").style("font-weight","bold").text(l),w(E);var A=(0,s.jvg)().x(k).y(b),C=function(t){var e=E.append("g").attr("transform","translate(-100,-100)").attr("class","focus");e.append("circle").attr("r",3.5),e.append("text").attr("class","text1").attr("y",-30),e.append("text").attr("class","text2").attr("y",-10);var n=t.reduce((function(t,e){return e.metrics.forEach((function(e){t.push(e)})),t}),[]),a=u.Z.from(n,k,b).voronoi([-g,-x,c+y,p+h]);o.voronoiGroup=E.append("g").attr("class","voronoi"),o.voronoiGroup.selectAll("path").data(n).enter().append("path").attr("d",(function(t,e){return a.renderCell(e)})).on("mouseover",(function(t,r){var n=N[r.cityName];(0,s.Ys)(n).classed("city--hover",!0),n.parentNode.appendChild(n),e.attr("transform","translate("+k(r)+","+b(r)+")"),e.select(".text1").text(d(r)),e.select(".text2").text(f(r))})).on("mouseout",(function(t,r){var n=N[r.cityName];return(0,s.Ys)(n).classed("city--hover",!1),e.attr("transform","translate(-100,-100)")})).on("click",(function(t,e){o.clickToggle=!o.clickToggle,(0,s.td_)(".cities").remove(),(0,s.td_)(".voronoi").remove(),(0,s.td_)(".focus").remove();var n=o.clickToggle?[r.find((function(t){return t.name===e.cityName}))]:r;F(n)}))},F=function(t){E.append("g").attr("class","cities").selectAll("path").data(t).enter().append("path").attr("d",(function(t){return N[t.name]=this,A(t.metrics)})).style("stroke",(function(t,e){return a(e.toString())})).style("filter",(function(){return"url(#drop-shadow)"})),C(t)};return F(r),{setVoronoi:function(t){o.voronoiGroup.classed("voronoi--show",t)}}},w=function(t){var e=t.append("defs").append("filter").attr("id","drop-shadow");e.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",1),e.append("feOffset").attr("dx",1).attr("dy",1),e.append("feComponentTransfer").append("feFuncA").attr("slope","1").attr("type","linear");var r=e.append("feMerge");r.append("feMergeNode"),r.append("feMergeNode").attr("in","SourceGraphic")},b=function(){var t=(0,o.Z)(c().mark((function t(){var e,r,n,a,o,i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="chart",t.next=3,m();case 3:r=t.sent,n=r.cities,a=r.months,o=k({cities:n,months:a,rootElId:e}),i=o.setVoronoi,(0,s.Ys)("#show-voronoi").property("disabled",!1).on("change",(function(t){i(t.target.checked||!1)}));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),N=function(t){var e=t.pageContext.demoInfo;return n.createElement(a.Z,{demoInfo:e,main:b},n.createElement("form",null,n.createElement("input",{id:"show-voronoi",type:"checkbox"})," ",n.createElement("label",{htmlFor:"show-voronoi"},"Show Voronoi lines")),n.createElement("div",{id:"chart"}))}}}]);
//# sourceMappingURL=component---src-pages-d-3-js-multiline-voronoi-tsx-00f88ff3e8d5e185d0cb.js.map